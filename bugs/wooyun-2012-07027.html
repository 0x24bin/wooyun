<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		有13个煤矿的煤矿安全监控系统存在问题！！！！  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		有13个煤矿的煤矿安全监控系统存在问题！！！！  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/zeracker">zeracker</a> 
</li><li>提交时间：		2012-05-13 20:30</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2012-05-13：	细节已通知厂商并且等待厂商处理中<br/>
									2012-05-14：	厂商已经确认，细节仅向厂商公开<br/>
									2012-05-17：	细节向第三方安全合作伙伴开放<br/>
									2012-05-24：	细节向核心白帽子及相关领域专家公开<br/>
									2012-06-03：	细节向普通白帽子公开<br/>
									2012-06-23：	细节向实习白帽子公开<br/>
									2012-06-27：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">此系统多达13个煤矿，K煤矿安全监控系统的设计是以《煤矿安全规程》为依据，对煤矿井下实际情况进行考察之后，综合各方面的要求设计<br />
<br />
出来的，监控设备的种类、数量、性能符合《煤矿安全规程》的有关规定，适用各类大中小型煤矿。该系统可采集瓦斯、风速、<br />
<br />
负压、温度、一氧化碳等环境参数，以及设备开停、供电状态等生产参数，可以控制设备的通、断电，是煤矿安全生产的必备设备。<br />
首先对他公司作一下介绍.因为他们公司生产出的产品的确拿过不少大奖，如国家火炬计划项目。公司总注册资金1.1亿元,固定资产1亿多元.<br />
当然此次产生的问题，多多少少的问题与厂商还是有较大的联系的，首先水平有限，不能说他们开发的产品有问题，至少在管理培训方面没做到位。<br />
<br />
多吐槽几句吧，因为这个产品不用于一般产品，只要出错，不仅仅涉及到经济上的问题，人命重于一切。(当然不法商人会花数万，数十万来堵住当事人家属的嘴巴)。一条生命啊。。。。。尼玛，生命不容践踏！<br />
<br />
因为曾经在我身边周围就发生过类似的事情，所以我认为这样的问题很有必要发出来。在底层煤矿工的待遇上希望能够给予提高，毕竟拿命来为你做事，每个月不到3K的收入，真的很悲剧，希望相关的老板花巨资买得起设备，稍微花点钱在工人身上。希望中国的煤老板能够有所良知，而不是花XXXX万去浪费。附带一张底层矿工图，如果你是有良知的白帽子的<br />
<br />
话，希望能够顶贴！<br />
<br />
当一些人的工作都没有生命保障可言，还谈神马安全？数百家幸福的家庭，数百条性命，他<br />
<br />
们家里的孩子还在憧憬，他们的未来！<br />
<br />
希望在整顿期间，矿工们能够拿到这短时间的工资！这个才是王道！不要因为整顿而少了工<br />
<br />
作的机会和相应的报酬，不给工钱是罪无耻的。<br />
<br />
来个精华吧，涉及到生命财产安全的处女贴。现在是北京时间凌晨4点23分啊，我嘞个去。。。你要对得起我。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">KJ70N煤矿安全监控系统的设计是以《煤矿安全规程》为依据，对煤矿井下实际情况进行考察之后，综合各方面的要求设计出来的，监控设备的种类、数量、性能符合《煤矿安全规程》的有关规定，适用各类大中小型煤矿。该系统可采集瓦斯、风速、负压、温度、一氧化碳等环境参数，以及设备开停、供电状态等生产参数，可以控制设备的通、断电，是煤矿安全生产的必备设备。<br />
<br />
<br />
<br />
 <br />
<br />
很意外发现这个服务器存在ftp匿名访问，有读写权限看着文件名太过于敏感，发现了data里面有记录煤矿瓦斯相关情况的一些数据。危害可想而知。（后来才发现这个XXOO，果然藏得够深。感慨万分。）<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/13041211c25edccf709b5ba20db689b74b93fca4.jpg" target="_blank"><img src="../images/13041211c25edccf709b5ba20db689b74b93fca4.jpg" alt="" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
打开XXX.XXX.XXX.XXX 同样发现存在遍历漏洞。<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/13041248e827e51da41f5dc8cb5faac19eced09b.jpg" target="_blank"><img src="../images/13041248e827e51da41f5dc8cb5faac19eced09b.jpg" alt="" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
继续打开，跳转到后台地址。<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/130413250d16905473e435ea120c1028f6ddc098.jpg" target="_blank"><img src="../images/130413250d16905473e435ea120c1028f6ddc098.jpg" alt="" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
尼玛，真的是KJ70N煤矿安全监控系统的后台，用IE打开输入，后台设置的权限，无论你输入任意<br />
<br />
<br />
<br />
<br />
<br />
口令，自动关闭页面。<br />
<br />
<br />
<br />
用chrome打开，出现一个警告窗口，果断阻止。输入口令果断进入。<br />
<br />
<br />
<br />
尼玛，瞧着架势，第一眼就受不了了。鼠标不敢点击了，因为权限比较大，对涉及到生命财产可能被受到侵害的情况下。<br />
<br />
<br />
<br />
<br />
<br />
果断截图几张，便退出。同样已经将问题提交给cncert进行处理。<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/130415393c30e4fc066bbdc4baf963fa3e599452.jpg" target="_blank"><img src="../images/130415393c30e4fc066bbdc4baf963fa3e599452.jpg" alt="" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/130415131a15f8cda8bf3c1ef897ee1bb53a7166.jpg" target="_blank"><img src="../images/130415131a15f8cda8bf3c1ef897ee1bb53a7166.jpg" alt="" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/13041448966b7cb2f8d312f4cd488aa1642e55f6.jpg" target="_blank"><img src="../images/13041448966b7cb2f8d312f4cd488aa1642e55f6.jpg" alt="" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/1304142753144288bf2968f017e90c2a3cb47a53.jpg" target="_blank"><img src="../images/1304142753144288bf2968f017e90c2a3cb47a53.jpg" alt="" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
江苏三恒科技集团有限公司总注册资金1.1亿元,固定资产1亿多元.<br />
<br />
<br />
<br />
该公司研发生产的KJ70N安全生产监控系统被立为江苏省火炬计划项目、国家火炬计划项目、被国家安全生产监督管理局评为安<br />
<br />
<br />
<br />
全产品、质量信得过产品，获得2008年度国家级科技进步二等奖，KT25煤矿无线通信系统及KJ128A矿用人员监测系统与2007年通<br />
<br />
<br />
<br />
过了国家安全生产监督管理总局的部级鉴定，高新技术产品传感器有40多只等诸多信誉证书。专业的人才、先进的设备、科学的<br />
<br />
<br />
<br />
管理保证了三恒集团产品的优秀品质。 　　公司产品已覆盖：KJ70N煤矿安全生产监控系统、KJ115光纤工业电视监控系统、<br />
<br />
<br />
<br />
KJ135瓦斯巡更系统、KT25煤矿无线通信系统、KT109R型矿用无线通信系统、KJ128A矿用人员监测系统、KJ159矿用电力调度系统<br />
<br />
<br />
<br />
、KT162矿用胶带输送机监控系统、KTT103矿用抗噪声扩音装置、KJJ63全矿井综合自动化监控系统、JWB型无极绳绞车运输系统<br />
<br />
<br />
<br />
、隔爆兼本安光纤摄像仪、矿用全系列传感器，及煤矿安全系统联网软件和相关配套软件及上百种传感器。所设计的产品在全国<br />
<br />
<br />
<br />
各地煤矿广泛应用。三恒集团与中兴通信、霍尼韦尔、摩托罗拉等国内、国际著名公司进行技术合作；与东南大学、中国矿业大<br />
<br />
<br />
<br />
学、河海大学等进行“产学研”合作，产品的销售在山西省、山东省、河南省、占有1/3的份额，全国各地90%的矿都使用着三恒<br />
<br />
<br />
<br />
公司的传感器及产品。 <br />
<br />
<br />
<br />
研发中心介绍 　　江苏三恒科技集团有限公司研发中心于2007年3月成立，2009年8月份通过“常州市级技术中心”评定，目前<br />
<br />
<br />
<br />
共划分为：中心管理部、通信部、硬件部、软件部、工艺结构部、矿压研究室六个部门。目前有固定员工52名；办公实验场地<br />
<br />
<br />
<br />
1700多平方米，仪器仪表设备原值 1000万元人民币以上。 　　研发中心组织结构 　　矿压研究室 工艺结构部 中心管理部 通<br />
<br />
<br />
<br />
信部 软件部 硬件部 　　中心管理部是研发中心的管理机构，主要负责研发中心日常事务的管理、研发计划的制定与管理。研<br />
<br />
<br />
<br />
发中心的员工大部分都从国内知名高校招聘，进入中心后，中心将按以师带徒的方式，确保新员工的稳步成长。 　　研发中心<br />
<br />
<br />
<br />
团队比较年轻，平均年龄30岁左右。坚持以“建一流团队，做行业一流产品” 为目标。 　　研中心近三年主要创新成果： 　<br />
<br />
<br />
<br />
　研发近80多个产品，并通过国家安全生产监督总局下属安全标志办公室的检测，取得相应的防爆证及安全标志认证。 　　<br />
<br />
<br />
<br />
2007年与中兴通讯合作开发的KT25煤矿无线通信系统顺利通过国家安全生产监督总局部级鉴定； 　　2008年与东南大学合作开<br />
<br />
<br />
<br />
发的KJ128矿用人员监测系统顺利通过国家安全生产监督总局部级鉴定； 　　公司主导产品KJ70N煤矿安全生产监控系统获得了<br />
<br />
<br />
<br />
2008年度国家科技进步二等奖； 　　2009年与摩托罗拉公司合作开发的KT109R煤矿无线通信系统，顺利通过国家安全生产监督<br />
<br />
<br />
<br />
总局下属安全标志办公室的检测，取得相应的防爆证及安全标志认证。 　　共有发明专利2项，实用新型7项，软件著作权14项<br />
<br />
<br />
<br />
；2008年下半年至今新申请二项发明专利，五项实用新型专利，国家知识产权局已获受理。<br />
<br />
<br />
<br />
<br />
<br />
KJ70N煤矿安全监控系统<br />
<br />
<br />
<br />
<br />
<br />
●系统介绍：<br />
<br />
 <br />
<br />
     KJ70N煤矿安全监控系统的设计是以《煤矿安全规程》为依据，对煤矿井下实际情况进行考察之后，综合各方面的要求设计<br />
<br />
<br />
<br />
出来的，监控设备的种类、数量、性能符合《煤矿安全规程》的有关规定，适用各类大中小型煤矿。该系统可采集瓦斯、风速、<br />
<br />
<br />
<br />
负压、温度、一氧化碳等环境参数，以及设备开停、供电状态等生产参数，可以控制设备的通、断电，是煤矿安全生产的必备设<br />
<br />
<br />
<br />
备。<br />
<br />
<br />
<br />
●系统构成：<br />
<br />
<br />
<br />
KJ70N煤矿安全监控系统由以下四部分组成：<br />
<br />
1．监控计算机、网络及软件；<br />
<br />
2. 传输接口及传输电缆；<br />
<br />
3．供电电源及数据采集分站；<br />
<br />
4.  各种传感器及执行器。<br />
<br />
传感器的作用将瓦斯、风速、开停等物理量转换成电信号（频率信号200Hz~1000Hz或者开关量信号0mA/5mA、无源触点）并将信<br />
<br />
<br />
<br />
号传到分站；电源给分站供电，并通过分站给传感器供电。分站对传感器的信号进行采集，将采集数据传给地面计算机，同时根<br />
<br />
<br />
<br />
据地面计算机的指令和采集数据进行开出控制；传输接口将地面计算机的非安全信号与井下分站的安全信号隔离开来，同时具有<br />
<br />
<br />
<br />
双向驱动功能。计算机通过传输接口与井下分站通讯，发送配置及控制命令，提取数据及工作状态，并将数据进行存储、显示打<br />
<br />
<br />
<br />
印及在网络上共享。<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><p class="detail"><a href="../images/13041801b920fa4f9e872105d10a0d6c1a30a7be.jpg" target="_blank"><img src="../images/13041801b920fa4f9e872105d10a0d6c1a30a7be.jpg" alt="" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/130417052292bf3194324e6dee068911b1890477.jpg" target="_blank"><img src="../images/130417052292bf3194324e6dee068911b1890477.jpg" alt="" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">好好整顿！<br />
<br />
要建立工业控制系统安全测评检查和漏洞发布制度，工业和信息化部要适时对重点领域工业控制系统信息安全进行抽查。同时，要进一步加强工业控制系统信息安全工作的组织领导。加强对工业控制系统信息安全工作的指导和督促检查。加强对重点领域工业控制系统信息安全管理工作的指导监督，结合行业实际制定完善相关规章制度，提出具体要求，并加强督促检查确保落到实处。<br />
<br />
-----------------------------------------------------------<br />
<br />
希望在整顿期间，矿工们能够拿到这短时间的工资！这个才是王道！不要因为整顿而少了工作的机会和相应的报酬，不给工钱是罪无耻的。<br />
<br />
<br />
<br />
QQ2036234,已经提交至cncert, </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/zeracker" title="zeracker">zeracker</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-07027" title="有13个煤矿的煤矿安全监控系统存在问题！！！！">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：17 </p>
													<p class="detail">确认时间：2012-05-14 01:54</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认并复现所述漏洞情况。感谢zeracker同学在周末的辛勤工作。<br />
近两天，来自lee、zeracker以及上海某高校的一位白帽子在工业控制系统以及goole hack方面的一些成果将会对电信、电力、工业生产、税务等相关行业单位的信息安全起到积极的事件驱动作用。<br />
<br />
对漏洞评分如下：<br />
CVSS：(AV:R/AC:L/Au:NR/C:C/A:P/I:P/B:N) score:8.97（最高10分，高危）<br />
即：远程攻击、攻击难度低、不需要用户认证，对机密性造成完全影响，对可用性、完整性造成部分影响(涉及生产系统，暂未进一步测试，仅根据当前测试环境评估)。<br />
<br />
<br />
技术难度系数：1.2（正如z-0ne评论的用心之作）<br />
影响危害系数：1.6（严重，涉及安全生产，责重如之泰山）<br />
CNVD综合评分：8.97*1.2*1.6=17.222</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="7027";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
