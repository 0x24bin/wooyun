<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		大公司诟病系列#1 重置京东任意用户密码  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		大公司诟病系列#1 重置京东任意用户密码  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/猪猪侠">猪猪侠</a> 
</li><li>提交时间：		2013-10-26 19:46</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-10-26：	细节已通知厂商并且等待厂商处理中<br/>
									2013-10-30：	厂商已经确认，细节仅向厂商公开<br/>
									2013-11-09：	细节向核心白帽子及相关领域专家公开<br/>
									2013-11-19：	细节向普通白帽子公开<br/>
									2013-11-29：	细节向实习白帽子公开<br/>
									2013-12-10：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">本系列将介绍一些大公司常有的诟病，随处可见的安全隐患，任意一个小问题都能引发企业安全的崩盘。<br />
<br />
由于大多数应用系统自身的业务特性，会开放许多接口用于处理数据，如果接口或功能未进行严谨的安全控制或判断，将会促进骇客加快攻击应用程序的过程，大大降低了骇客发现威胁的人力成本。<br />
<br />
同时随着模块化的自动化攻击工具包越来越趋向完善，将给应用、业务系统带来最大的威胁。<br />
<br />
本报告内涉及的安全隐患，足矣间接导致京东商城遭受脱裤风险，介于安全测试，未深入研究！</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">#1 描述<br />
<br />
<br />
<br />
2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。<br />
<br />
<br />
<br />
同时，搜索引擎越来越多的收录了企业的相关信息；<br />
<br />
<br />
<br />
#2 风险描述<br />
<br />
通过theharvester工具，和baidu.com、google.com搜索引擎，收集所有关于京东商城的员工信息。<br />
<br />
<br />
<br />
得到如下京东商城员工列表信息：<br />
<br />
<br />
<br />
</p><pre><code>360buy@360buy.com<br />
asd@360buy.com<br />
bailin@360buy.com<br />
bjgaojie@360buy.com<br />
bjgaoyong@360buy.com<br />
bjhaoyanjun@360buy.com<br />
bjliumin@360buy.com<br />
bjliuwei@360buy.com<br />
bjliuyi@360buy.com<br />
bjlizhiming@360buy.com<br />
bjmawei@360buy.com<br />
bjwangwen@360buy.com<br />
bjzhanglei@360buy.com<br />
bjzhangyi@360buy.com<br />
caojingsh@360buy.com<br />
cdhezhou@360buy.com<br />
cdtangxi@360buy.com<br />
changhongqiang@360buy.com<br />
changzhuojie@360buy.com<br />
chendali@360buy.com<br />
chenguo@360buy.com<br />
chenguozhen@360buy.com<br />
chenjingjing@360buy.com<br />
chenlunwen@360buy.com<br />
chenshoujiang@360buy.com<br />
chenweidong@360buy.com<br />
chenyu@360buy.com<br />
chongbo@360buy.com<br />
crab@360buy.com<br />
cuilinwei@360buy.com<br />
cuiwenyi@360buy.com<br />
cwyanghua@360buy.com<br />
daike@360buy.com<br />
dblibin@360buy.com<br />
dengdanruo@360buy.com<br />
diguangmin@360buy.com<br />
dingjie@360buy.com<br />
dingweifeng@360buy.com<br />
duanzhiqiang@360buy.com<br />
fanting@360buy.com<br />
fanyunpeng@360buy.com<br />
feiliqing@360buy.com<br />
fengliangliang@360buy.com<br />
fengzongkui@360buy.com<br />
fuzhongping@360buy.com<br />
gangjian@360buy.com<br />
gaochangzhi@360buy.com<br />
gaoliuxian@360buy.com<br />
gaopaninfo@360buy.com<br />
gaoxia@360buy.com<br />
gaoyong@360buy.com<br />
guohuiinfo@360buy.com<br />
guojunwen@360buy.com<br />
guoxiaobo@360buy.com<br />
guoyongzhi@360buy.com<br />
gxdi@360buy.com<br />
gzbyj@360buy.com<br />
gzdengshijun@360buy.com<br />
gzzcs01@360buy.com<br />
gzzcs@360buy.com<br />
gzzhangbin@360buy.com<br />
gzzhouyishan@360buy.com<br />
hbb321@360buy.com<br />
hecheng@360buy.com<br />
hehujuan@360buy.com<br />
helicun@360buy.com<br />
heping@360buy.com<br />
herosibasta@360buy.com<br />
hezhihao@360buy.com<br />
houkuiyu@360buy.com<br />
huanghaiping@360buy.com<br />
hudalei@360buy.com<br />
hufengyang@360buy.com<br />
hushuyang@360buy.com<br />
huwei@360buy.com<br />
huyingying@360buy.com<br />
huzhiguang@360buy.com<br />
jacky@360buy.com<br />
jiangguofan@360buy.com<br />
jianglijun@360buy.com<br />
jianglongwu@360buy.com<br />
jiaojian@360buy.com<br />
jijunshang@360buy.com<br />
jinjianhong@360buy.com<br />
jinjing@360buy.com<br />
jinshaohua@360buy.com<br />
jishangshang@360buy.com<br />
jisuqing100@360buy.com<br />
kangzhuang@360buy.com<br />
kongyi@360buy.com<br />
leihuiping@360buy.com<br />
liaoxiaoyan@360buy.com<br />
libing@360buy.com<br />
libiying@360buy.com<br />
lidaolin@360buy.com<br />
lidaxue@360buy.com<br />
lidayan@360buy.com<br />
lidong@360buy.com<br />
liguochao@360buy.com<br />
lihongyue@360buy.com<br />
likanglong@360buy.com<br />
likunran@360buy.com<br />
limei@360buy.com<br />
limingxin@360buy.com<br />
lina@360buy.com<br />
linhong@360buy.com<br />
lining@360buy.com<br />
linyan@360buy.com<br />
liqiulin@360buy.com<br />
liu-yi@360buy.com<br />
liucaiping@360buy.com<br />
liudeqin@360buy.com<br />
liudongming@360buy.com<br />
liufang@360buy.com<br />
liuhuanhuan@360buy.com<br />
liuhugang@360buy.com<br />
liujingjing@360buy.com<br />
liuli@360buy.com<br />
liulifeng@360buy.com<br />
liupeixin@360buy.com<br />
liupengfei@360buy.com<br />
liuqianhui@360buy.com<br />
liuquanxin@360buy.com<br />
liushijia@360buy.com<br />
liuwencai@360buy.com<br />
liuxiaoming@360buy.com<br />
liuyinfei@360buy.com<br />
liuying@360buy.com<br />
liuyong@360buy.com<br />
liuyuhui@360buy.com<br />
liuzonggang@360buy.com<br />
liyicheng@360buy.com<br />
lizhenhua@360buy.com<br />
lizifeng@360buy.com<br />
lvhanjiang@360buy.com<br />
lvke@360buy.com<br />
lvyanmeng@360buy.com<br />
mabolong@360buy.com<br />
mack@360buy.com<br />
maisanjun@360buy.com<br />
maoweina@360buy.com<br />
maoyuming@360buy.com<br />
naxin@360buy.com<br />
ouyangbo@360buy.com<br />
ouyangkui@360buy.com<br />
panbaohua@360buy.com<br />
panchaoguo@360buy.com<br />
piaowei@360buy.com<br />
putengfei@360buy.com<br />
qdzhaoning@360buy.com<br />
quhaiting@360buy.com<br />
renbo@360buy.com<br />
service@360buy.com<br />
shangxin@360buy.com<br />
shangyu@360buy.com<br />
shenchaoqun@360buy.com<br />
shhr@360buy.com<br />
shifengquan@360buy.com<br />
shixin@360buy.com<br />
shiyuanyuan@360buy.com<br />
shlijing@360buy.com<br />
shliqiang@360buy.com<br />
shliuwei@360buy.com<br />
shuaichunlei@360buy.com<br />
shzhangjun@360buy.com<br />
songbolong@360buy.com<br />
songdehong@360buy.com<br />
songguangpei@360buy.com<br />
songliupo@360buy.com<br />
songwei@360buy.com<br />
songxiaoliang@360buy.com<br />
sqchenpeng@360buy.com<br />
sqlili@360buy.com<br />
sqzhanghui@360buy.com<br />
sunchao@360buy.com<br />
sunge@360buy.com<br />
sunjiaming@360buy.com<br />
sunwei@360buy.com<br />
tangchao@360buy.com<br />
tangweiwei@360buy.com<br />
tangwulong@360buy.com<br />
tangyekui@360buy.com<br />
tangyong@360buy.com<br />
tongqingchn@360buy.com<br />
traindream@360buy.com<br />
tshanlei@360buy.com<br />
tsliuming@360buy.com<br />
wangchunjie@360buy.com<br />
wangfang@360buy.com<br />
wangfei@360buy.com<br />
wanghongzhi@360buy.com<br />
wanghuatao@360buy.com<br />
wangjicai@360buy.com<br />
wanglian@360buy.com<br />
wanglimei@360buy.com<br />
wanglina@360buy.com<br />
wanglipin@360buy.com<br />
wangmingyang@360buy.com<br />
wangran@360buy.com<br />
wangwanhong@360buy.com<br />
wangweiyue@360buy.com<br />
wangxiaojun@360buy.com<br />
wangxinya@360buy.com<br />
wangyuejiao@360buy.com<br />
wangyufenginfo@360buy.com<br />
wangzhiyan@360buy.com<br />
wangzhiyu@360buy.com<br />
weijun@360buy.com<br />
weiqinmeng@360buy.com<br />
weiwei@360buy.com<br />
whxumin@360buy.com<br />
wu-hao@360buy.com<br />
wulininfo@360buy.com<br />
wuna@360buy.com<br />
wuxi@360buy.com<br />
wuxiaochen@360buy.com<br />
wuxingjiang@360buy.com<br />
wuyouqiang@360buy.com<br />
www.hehujuan@360buy.com<br />
www.xiongqingjie@360buy.com<br />
www.yelei@360buy.com<br />
wxliwei@360buy.com<br />
xiaoaifeng@360buy.com<br />
xiaojun@360buy.com<br />
xiaxiusong@360buy.com<br />
xie-xd@360buy.com<br />
xiecongli@360buy.com<br />
xiongjun@360buy.com<br />
xiongzhuang@360buy.com<br />
xuehaiyan@360buy.com<br />
xuhailong@360buy.com<br />
xulei@360buy.com<br />
xuzhanxi@360buy.com<br />
xxliujian@360buy.com<br />
yaj@360buy.com<br />
yangfeng@360buy.com<br />
yanggang@360buy.com<br />
yanghongfang@360buy.com<br />
yanghonggang@360buy.com<br />
yanglei@360buy.com<br />
yangluying@360buy.com<br />
yangnannan@360buy.com<br />
yangyue@360buy.com<br />
yao@360buy.com<br />
yaojipeng@360buy.com<br />
yaoyanzhong@360buy.com<br />
yekailiang@360buy.com<br />
yfzhangchao@360buy.com<br />
yinbi@360buy.com<br />
yinli@360buy.com<br />
yinyuanyuan@360buy.com<br />
yixiaohua@360buy.com<br />
yq@360buy.com<br />
yuanhuihua@360buy.com<br />
yuanrendu@360buy.com<br />
yuanzhen@360buy.com<br />
yuhaitao@360buy.com<br />
yyzp@360buy.com<br />
zhaimin@360buy.com<br />
zhaiyanxin@360buy.com<br />
zhaiyizhe@360buy.com<br />
zhandekun@360buy.com<br />
zhangbiao@360buy.com<br />
zhangguochen@360buy.com<br />
zhangguofang@360buy.com<br />
zhanghaijiao@360buy.com<br />
zhanghong@360buy.com<br />
zhanghuizhe@360buy.com<br />
zhangjian@360buy.com<br />
zhangjianan@360buy.com<br />
zhangjianping@360buy.com<br />
zhangjie@360buy.com<br />
zhangjunrui@360buy.com<br />
zhangkefang@360buy.com<br />
zhanglianbing@360buy.com<br />
zhangpengyan@360buy.com<br />
zhangqi@360buy.com<br />
zhangruifang@360buy.com<br />
zhangwenzhi@360buy.com<br />
zhangxinjing@360buy.com<br />
zhangying@360buy.com<br />
zhangyuanyuan@360buy.com<br />
zhangzelin@360buy.com<br />
zhanyurong@360buy.com<br />
zhaojiehui@360buy.com<br />
zhaojunwei@360buy.com<br />
zhaopengyi@360buy.com<br />
zhaoxuebin@360buy.com<br />
zhaoxun@360buy.com<br />
zhaoyumei@360buy.com<br />
zhengchuanyu@360buy.com<br />
zhengcongshu@360buy.com<br />
zhenglili@360buy.com<br />
zhengxuegang@360buy.com<br />
zhongxingliang@360buy.com<br />
zhougangan@360buy.com<br />
zhougongbao@360buy.com<br />
zhouhao@360buy.com<br />
zhouxin@360buy.com<br />
zhuangjai@360buy.com<br />
zhuangjia@360buy.com<br />
zhuguangwei@360buy.com<br />
zhujianghong@360buy.com<br />
zhujiangjie@360buy.com<br />
zhujianhua@360buy.com<br />
zhulijie@360buy.com<br />
zhuyb@360buy.com<br />
zhuyun2003944037@360buy.com<br />
zhuzhenxi8511@360buy.com<br />
zhuzhenxi@360buy.com<br />
zjkkk@360buy.com<br />
zldengwei@360buy.com<br />
zlzhangli@360buy.com<br />
zouderu@360buy.com<br />
zouliang@360buy.com<br />
zuotiecheng@360buy.com</code></pre><p class='detail'><br />
<br />
<br />
<br />
#3 找到可用的登陆接口验证口令<br />
<br />
<br />
<br />
https://mail.jd.com/owa/auth/logon.aspx<br />
<br />
京东的邮件服务使用了微软的Microsoft Exchange套件，无验证码限制，直接FUZZ。<br />
<br />
<br />
<br />
#4 FUZZ规则建立<br />
<br />
<br />
<br />
大公司人员的习惯研究，公司做得越来越大的时候，总会出现那么几个安全意识薄弱的人员（俗称猪一样的队友），他们往往会做出一些让人无法理解的事情，比如：直接点击邮件内的 EXE 附件，或者使用和用户名一样的密码，或者用户名+当前年份的密码。<br />
<br />
<br />
<br />
我构建的密码规则：<br />
<br />
</p><pre><code>%username% = 用户名<br />
%domain% = 公司域名<br />
<br />
%username%%domain%<br />
%username%1<br />
%username%12<br />
%username%123<br />
%username%1234<br />
%username%12345<br />
%username%123456<br />
%username%@123<br />
%username%@123.com<br />
%username%@163<br />
%username%@163.com<br />
%username%163<br />
%username%8<br />
%username%88<br />
%username%888<br />
%username%999<br />
%username%666<br />
%username%2008<br />
%username%2009<br />
%username%2010<br />
%username%2011<br />
%username%2012<br />
%username%2013<br />
%username%@2008<br />
%username%@2009<br />
%username%@2010<br />
%username%@2011<br />
%username%@2012<br />
%username%@2013<br />
%username%!@#</code></pre><p class='detail'><br />
<br />
<br />
<br />
#5 成功Fuzz出某个用户的密码，再结合Exchange的通讯录功能，导出所有用户名列表<br />
<br />
<br />
<br />
! 京东原CFO，首席财务官<br />
<br />
</p><p class="detail"><a href="../images/26193234cd1307efbd403d1ca98fc74522f591d4.jpg" target="_blank"><img src="../images/26193234cd1307efbd403d1ca98fc74522f591d4.jpg" alt="360buy.com_CFO.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
! 若干人员<br />
<br />
</p><p class="detail"><a href="../images/26193312dde96769719ce5a2158a1c7a2ad039a3.jpg" target="_blank"><img src="../images/26193312dde96769719ce5a2158a1c7a2ad039a3.jpg" alt="360buy.com_address.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
推荐一个自动导出所有Exchange联系人的工具：Exchange-Spigot<br />
<br />
http://exchangespigot.codeplex.com/<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/261934169d7a7a38e109a080eb34bcafba098576.png" target="_blank"><img src="../images/261934169d7a7a38e109a080eb34bcafba098576.png" alt="20110831-NodeXL-Exchange-Spigot.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
#6 是的，现阶段，你已经拥有了所以京东员工的联系信息列表<br />
<br />
重复使用#4提到的FUZZ规则，弱口令用户一堆一堆的，然后你就可以进入那些人的邮箱里面找猛料了，这里只是测试，没办法提供相关结果信息。<br />
<br />
<br />
<br />
测试后回显成功找到了2865名员工的密码，均为弱口令！<br />
<br />
<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">#7 漏洞证明,找到你们的安全部门、数据库部门<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/2619384256db35709bbe11da4f4639fc2d279b68.png" target="_blank"><img src="../images/2619384256db35709bbe11da4f4639fc2d279b68.png" alt=".png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/26193905d796fb71e45a040f7a341f222a0169d1.png" target="_blank"><img src="../images/26193905d796fb71e45a040f7a341f222a0169d1.png" alt=".png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
#8 整理获取到的信息间接进行测试，最终证明可重置京东任意用户密码<br />
<br />
<br />
<br />
http://safe.jd.com/findPwd/index.action，填入用户的邮箱，系统将会使用customer_service@jd.com用户发送重置密码链接，去邮件服务器搜索到就行了。<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/261943154d95116ebc1e69edef8da3aca340daed.jpg" target="_blank"><img src="../images/261943154d95116ebc1e69edef8da3aca340daed.jpg" alt="jd_findpwd.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/261939400cb3dcd37c1c4a53eca5ff6782298f67.jpg" target="_blank"><img src="../images/261939400cb3dcd37c1c4a53eca5ff6782298f67.jpg" alt="jd.com_custome_service.jpg" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">#1 安全意识培训到每个人<br />
<br />
#2 加入TOKEN校验机制，或者验证码<br />
<br />
#3 第三条，你们在互联网上表现得比谁都专业，自己想办法吧 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/猪猪侠" title="猪猪侠">猪猪侠</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-041105" title="大公司诟病系列#1 重置京东任意用户密码">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-10-30 13:55</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">逻辑很清晰，感谢支持</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="41105";
var bugRating="2";
var myRating="";
var ratingCount="8";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
