<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		TV189-天翼视讯零付费享受付费会员内容  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		TV189-天翼视讯零付费享受付费会员内容  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/MarkGUN">MarkGUN</a> 
</li><li>提交时间：		2014-03-26 11:32</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-03-26：	细节已通知厂商并且等待厂商处理中<br/>
									2014-03-30：	厂商已经确认，细节仅向厂商公开<br/>
									2014-04-09：	细节向核心白帽子及相关领域专家公开<br/>
									2014-04-19：	细节向普通白帽子公开<br/>
									2014-04-29：	细节向实习白帽子公开<br/>
									2014-05-10：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">根据TV189-天翼视讯官方线上点播平台，提供定时5分钟影片试看，借助外力工具，可以得出网站后台的电影文件地址（stream address）,并利用相关软件根据下载任何画质的视频源文件。针对站点所有节目内容。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"></p><pre><code>首先，本次提交www.tv189.com网站权限绕过或是设计逻辑缺陷，导致影像资源可以未经任何授权而获得。</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/25203551e2b4bbce9239d233c3a4931d67bce77e.jpg" target="_blank"><img src="../images/25203551e2b4bbce9239d233c3a4931d67bce77e.jpg" alt="V.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
破解思路：任何电影视频文件→记录电影文件总体时间→后台流媒体链接获取（通过浏览器）→计算电影视频文件秒钟数（calc计算器）→替换后台媒体链接的5分钟预览时段300s（更新为影片总体长度）→ 利用下载工具 IDM 软件复制下载链接 得到付费电影文件。可以分别选取视频质量，并刷新浏览器取得各自对应码流的源视频文件。 <br />
<br />
<br />
<br />
分步骤：<br />
<br />
第一步：选择片源 本例《青春荷尔蒙2躁动时代》下载观看，选择播放方式3种 标清 高清 超清 ，并记录影片总时间01:29:54相关信息.<br />
<br />
</p><p class="detail"><a href="../images/25204658d0514c092a8813b520583611a1c68f37.jpg" target="_blank"><img src="../images/25204658d0514c092a8813b520583611a1c68f37.jpg" alt="tv1.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
第二步：利用google chrome浏览器 拆分寻找视频流地址，并复制到记事本记录并修改总时间。<br />
<br />
</p><p class="detail"><a href="../images/25210847565f5f6e245ff6d3195f6ba81ffbfd18.jpg" target="_blank"><img src="../images/25210847565f5f6e245ff6d3195f6ba81ffbfd18.jpg" alt="s2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/252107582270123746c08c42edd9a7d67fb9e0e1.jpg" target="_blank"><img src="../images/252107582270123746c08c42edd9a7d67fb9e0e1.jpg" alt="s3.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/252109370959d0343a36fa4711c9ff0c190f6f76.jpg" target="_blank"><img src="../images/252109370959d0343a36fa4711c9ff0c190f6f76.jpg" alt="s4.jpg" width="600"/></a></p><p class="detail"><br />
<br />
第三步：用calc命令打开计算器，计算总体影片时间。并替换浏览器中得到的地址end=300,修改300为你算出的最终时间。<br />
<br />
</p><p class="detail"><a href="../images/25211143dc76f713ffbfe15f704ba3663323d57c.jpg" target="_blank"><img src="../images/25211143dc76f713ffbfe15f704ba3663323d57c.jpg" alt="s5.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/25211208f12e10d755262ec1f93b817763d218b4.jpg" target="_blank"><img src="../images/25211208f12e10d755262ec1f93b817763d218b4.jpg" alt="s6.jpg" width="600"/></a></p><p class="detail"><br />
<br />
第四步：复制最后修改时间的地址拷贝至Internet Download Manger (IDM)中进行下载，并选择相应路径，得到的是.flv格式文件。<br />
<br />
</p><p class="detail"><a href="../images/252114346ad9596134133e4471c42190db3a77a7.jpg" target="_blank"><img src="../images/252114346ad9596134133e4471c42190db3a77a7.jpg" alt="s7.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/2521144917be4d37b78da5cd1485716d9495c3b5.jpg" target="_blank"><img src="../images/2521144917be4d37b78da5cd1485716d9495c3b5.jpg" alt="s8.jpg" width="600"/></a></p><p class="detail"><br />
<br />
第五步：等待视频下载完成。达到免费享受正版影视的体验。（三种规格的文件可以刷新浏览器后取得相应的品质源文件），这里不做过多分析。<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>经过约10分钟的下载，标清版本的视频完整下到电脑上面。</code></pre><p class='detail'><br />
<br />
</p><p class="detail"><a href="../images/25212343421380aee50e0f11f6f00af9d56b1689.jpg" target="_blank"><img src="../images/25212343421380aee50e0f11f6f00af9d56b1689.jpg" alt=".jpg" width="600"/></a></p><p class="detail"><br />
<br />
所有的下载可以多线程下载，对视频服务器的带宽有一定的影响。<br />
<br />
</p><p class="detail"><a href="../images/2521235614954b46d67315284df03f8a5d2396bd.jpg" target="_blank"><img src="../images/2521235614954b46d67315284df03f8a5d2396bd.jpg" alt="22.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/25212407330940c6cef22e5871400c82ac73861e.jpg" target="_blank"><img src="../images/25212407330940c6cef22e5871400c82ac73861e.jpg" alt="ok完成.jpg" width="600"/></a></p><p class="detail"><br />
<br />
所有工作完毕，漏洞可以全站利用。<br />
<br />
<br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">这里只能给予网站平台考虑更新体验观看策略，或者给视频分段处理、或者是视频加上时间会话限制等条件，以改善本漏洞的扩大。<br />
<br />
谢谢！ </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/MarkGUN" title="MarkGUN">MarkGUN</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-054587" title="TV189-天翼视讯零付费享受付费会员内容">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：12 </p>
													<p class="detail">确认时间：2014-03-30 23:02</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">已经转由CNCERT通报给中国电信集团公司处置。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="54587";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
