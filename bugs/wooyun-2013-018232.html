<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		国政通公民身份证信息查询系统漏洞导致公民信息泄漏  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		国政通公民身份证信息查询系统漏洞导致公民信息泄漏  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/O.o">O.o</a> 
</li><li>提交时间：		2013-02-01 14:04</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-02-01：	细节已通知厂商并且等待厂商处理中<br/>
									2013-02-05：	厂商已经确认，细节仅向厂商公开<br/>
									2013-02-15：	细节向核心白帽子及相关领域专家公开<br/>
									2013-02-25：	细节向普通白帽子公开<br/>
									2013-03-07：	细节向实习白帽子公开<br/>
									2013-03-18：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">社工必备，能骗过各种上传身份证扫描件的人工审核。或者三次元做代办事务~</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">今天在对百合网进行挖洞的时候，发现了这个。<br />
<br />
百合网和国政通合作的。实名认证<br />
<br />
<br />
<br />
分析数据包。发现实名认证成功的页面返回了这个。<br />
<br />
接口页面：http://118.145.4.82:3010/baihe/3<br />
<br />
</p><p class="detail"><a href="../images/01131634670c8a9a8872339950fea608cb5f966f.png" target="_blank"><img src="../images/01131634670c8a9a8872339950fea608cb5f966f.png" alt=".png" width="600"/></a></p><p class="detail"><br />
<br />
</p><pre><code>&lt;em&gt;身份通认证系统 V1.0&lt;/em&gt;<br />
            &lt;/div&gt;<br />
        &lt;/div&gt;<br />
        &lt;div class=&quot;nav_down&quot;&gt;&lt;/div&gt;   &lt;div class=&quot;sub_main&quot;&gt;<br />
        	&lt;div class=&quot;frameNav&quot;&gt;<br />
            	&lt;h1&gt;03&lt;/h1&gt;<br />
                &lt;span class=&quot;new&quot;&gt;&lt;a&gt;完成认证&lt;/a&gt;&lt;/span&gt;<br />
                &lt;em&gt;验证结果&lt;/em&gt;<br />
            &lt;/div&gt;<br />
  &lt;div class=&quot;sub_c&quot;&gt;<br />
            	&lt;h1&gt;****@mobile.baihe.com恭喜！&lt;/h1&gt;<br />
                &lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;您已经成功通过身份通的认证，为了更好的预防您的身份信息被冒用，请登录身份通网站，修改密码<br />
并设置密码保护答案！&lt;/p&gt;<br />
				&lt;div class=&quot;userinfo&quot;&gt;<br />
                    &lt;div class=&quot;userinfo_l&quot;&gt;<br />
                            &lt;span&gt;&lt;em&gt;*&lt;/em&gt;身份通号：15****&lt;/span&gt;<br />
                                                        	&lt;span&gt;&lt;em&gt;*&lt;/em&gt;密码：:*****&lt;/span&gt;<br />
                                                        &lt;span&gt;&lt;em&gt;请妥善保管您的身份通帐号、密码&lt;/em&gt;&lt;/span&gt;<br />
                 &lt;/div&gt;<br />
                     &lt;div  class=&quot;userinfo_r&quot;&gt;<br />
                            &lt;a href=&quot;http://www.idtag.cn/userAction.do?method=toUpdateUserInfo&amp;typeint=1&quot; target=&quot;_blank&quot;&gt;&lt;/a&gt;<br />
                    &lt;/div&gt;<br />
            	&lt;/div&gt;<br />
			&lt;form name=&quot;form1&quot; method=&quot;POST&quot; action=&quot;http://auth.baihe.com/id5/authedId5.action&quot;&gt;<br />
				            		&lt;input type=&#039;hidden&#039; name=&quot;gender&quot; value=&quot;*****&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;mobile&quot; value=&quot;*****&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;addr&quot; value=&quot;%E7%B1%B3%E6%B3%89%E5%8E%BF&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;photo&quot; value=&quot;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDACweISchHCwnJCcyLyw1Qm9IQj09QohhZlBvoY2ppp6Nm5ixx//Ysbzxv5ib3v/g8f//////rNX/////////////2wBDAS8yMkI6QoJISIL/t5u3////////////////////////////////////////////////////////////////////wAARCADcALIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDXooooAKKKKACiiigAooqOWZYhkgn2AoAkoqo93tB+aM47A1VN7KeQ+Oc8AUAatFZP2uY9X+mKRbqQDHmMQRjGf19aANeiscXEq5IZskd2J/nU8d6y/eDt9cZ/pQBo0VFFOkgBBye+OcflUtABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABTJJFjxkgZ4HvSSMQPlGO5Y9BWZLIsjkgcE5y3WgCxNdkYx0I4GeQfQ4/xqo0jDJJ3A8HJJ/nTDgnn8aRju4yOMUAG/dwPypDu9f0poUgcc05WxgYANMAH4UcdxwB1zRnucYNGfQUAA74GCTSg9utN46A0DIWkBIG5ABIx6HpWjbXYfCPw314NZnTHanrwD0w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&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;name&quot; value=&quot;***%A6%E6%80%9D&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;birthday&quot; value=&quot;19990530&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;result&quot; value=&quot;1&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;key_code&quot; value=&quot;56c5ea4cc63****3f5f2863&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;user_id&quot; value=&quot;781*****&quot;&gt;<br />
            	            		&lt;input type=&#039;hidden&#039; name=&quot;stid&quot; value=&quot;15**435*****&quot;&gt;<br />
            					&lt;span class=&quot;cbtn&quot;&gt;<br />
                	&lt;input id=&quot;endBtn&quot; class=&quot;end&quot; type=&quot;submit&quot; value=&quot;完成&quot; /&gt;<br />
                &lt;/span&gt;<br />
			&lt;/form&gt;</code></pre><p class='detail'><br />
<br />
<br />
<br />
部分字段人工打码了。<br />
<br />
<br />
<br />
解释下：<br />
<br />
gender性别<br />
<br />
mobile手机号<br />
<br />
addr地址<br />
<br />
photo照片 <br />
<br />
name姓名<br />
<br />
birthday生日<br />
<br />
result返回结果<br />
<br />
key_code某些验证字符串吧<br />
<br />
user_id用户ID<br />
<br />
stid国政通帐号ID<br />
<br />
<br />
<br />
<br />
<br />
照片让我觉得很好奇。。看到最后的等号，果断base64解码。给个传送门http://www.vgot.net/test/image2base64.php<br />
<br />
<br />
<br />
[解码后的图片]<br />
<br />
</p><p class="detail"><a href="../images/01131452bb1c24a0ac02f511a1e4a72775205a92.png" target="_blank"><img src="../images/01131452bb1c24a0ac02f511a1e4a72775205a92.png" alt=".png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
获取这个页面的条件需要知道名字、身份证号，这个相信不难，通过这个漏洞可以获取到身份证上其他的信息甚至照片！用于网络上的例如支付宝认证啥的，很好用哦，因为照片和公安那边的公民信息是符合的。这也是一向以来最难伪造的哦~ </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><p class="detail"><a href="../images/01131658bbbd75bc57a86d8cca4acfb85ae85caa.png" target="_blank"><img src="../images/01131658bbbd75bc57a86d8cca4acfb85ae85caa.png" alt=".png" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/01131705a4c54ec2f25082ab10912db7ab17faf1.png" target="_blank"><img src="../images/01131705a4c54ec2f25082ab10912db7ab17faf1.png" alt=".png" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">你们比我懂 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/O.o" title="O.o">O.o</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-018232" title="国政通公民身份证信息查询系统漏洞导致公民信息泄漏">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：中</p>
						<p class="detail">漏洞Rank：7 </p>
													<p class="detail">确认时间：2013-02-05 22:33</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD未直接复现漏洞情况，至4日，仍未测试复现。暂挂在处置队列中，待复现后协调处置。<br />
<br />
rank 7</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="18232";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
