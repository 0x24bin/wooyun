<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		海尔检测信息平台webdav漏洞和目录遍历  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		海尔检测信息平台webdav漏洞和目录遍历  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/YY-2012">YY-2012</a> 
</li><li>提交时间：		2013-08-05 15:50</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-08-05：	细节已通知厂商并且等待厂商处理中<br/>
									2013-08-06：	厂商已经确认，细节仅向厂商公开<br/>
									2013-08-16：	细节向核心白帽子及相关领域专家公开<br/>
									2013-08-26：	细节向普通白帽子公开<br/>
									2013-09-05：	细节向实习白帽子公开<br/>
									2013-09-19：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">存在webdav漏洞，可以查看网站文件与数据，且有写权限，可以上传webshell等操作，从而控制整台服务器。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">青岛海尔检测信息平台<br />
<br />
http://218.58.70.220/<br />
<br />
<br />
<br />
http://218.58.70.220/sl.asp;.txt  一句话密码：1pass<br />
<br />
http://218.58.70.220/wooyun.txt<br />
<br />
<br />
<br />
目录遍历例子：<br />
<br />
http://218.58.70.220/WJ_MarketNew/<br />
<br />
http://218.58.70.220/WJ_Market/<br />
<br />
http://218.58.70.220/WasterDayWork/<br />
<br />
http://218.58.70.220/SupplyAudit/<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
智能电子外检管理系统<br />
<br />
http://218.58.70.220/wj_zndz/<br />
<br />
<br />
<br />
海尔检测公司信息管理平台<br />
<br />
http://218.58.70.220/Protype/<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"> </p><pre><code>驱动器 E 中的卷没有标签。<br />
 卷的序列号是 0EA5-B8B3<br />
<br />
 E:\webroot\Jiance17_191 的目录<br />
<br />
2013-08-05  14:55    &lt;DIR&gt;          .<br />
2013-08-05  14:55    &lt;DIR&gt;          ..<br />
2005-11-18  18:32                41 1.asp<br />
2013-08-05  08:14           167,244 11.asp<br />
2013-05-15  09:10    &lt;DIR&gt;          aspnet_client<br />
2013-05-15  09:10    &lt;DIR&gt;          BaseInformation<br />
2006-11-17  16:02             2,074 chai1117.html<br />
2003-05-16  14:12               941 content.asp<br />
2013-05-15  09:10    &lt;DIR&gt;          ContentPage<br />
2003-02-26  17:06             2,674 contentPage_Left.htm<br />
2003-04-15  13:10             2,693 contentPage_Main.htm<br />
2012-05-14  18:40             1,561 contentPage_top.asp<br />
2003-04-15  13:10             3,006 contentPage_Top.htm<br />
2003-09-24  11:47             1,662 contentPage_top1.asp<br />
2003-04-15  13:10               581 content_bottom.asp<br />
2013-05-15  09:10    &lt;DIR&gt;          content_images<br />
2006-11-17  15:31             5,874 content_left.asp<br />
2003-04-15  13:10               918 content_middle.htm<br />
2013-05-15  09:10    &lt;DIR&gt;          Department<br />
2006-10-23  11:00            16,384 detail.xls<br />
2006-10-24  16:28            38,400 detail24.xls<br />
2013-05-15  09:09    &lt;DIR&gt;          dyypms<br />
2013-05-15  09:09    &lt;DIR&gt;          Employee<br />
2004-01-16  12:34               285 err.htm<br />
2013-05-15  09:09    &lt;DIR&gt;          ForZndz<br />
2006-06-21  16:31            30,208 fubiao.xls<br />
2004-12-06  14:23             3,640 ggSupply.htm<br />
2013-05-15  09:09    &lt;DIR&gt;          Gist<br />
2013-05-15  09:09    &lt;DIR&gt;          gmds<br />
2011-04-18  18:57           620,386 gongfangjy.doc.docx<br />
2006-06-01  14:10            25,088 gysdj.doc<br />
2006-06-10  13:14            26,112 gysdytz.doc<br />
2006-08-04  10:38           126,976 haierRoHSfirst.xls<br />
2006-08-04  10:38           126,976 haierRoHSfirst1.xls<br />
2006-06-21  17:21            83,968 haierRoHSfirst2.xls<br />
2013-05-15  09:09    &lt;DIR&gt;          Headship<br />
2005-08-12  10:48         1,682,944 help.ppt<br />
2008-02-25  14:25         3,679,694 hrzzs.pdf<br />
2013-07-29  17:38    &lt;DIR&gt;          images<br />
2013-05-15  09:09    &lt;DIR&gt;          images192<br />
2013-05-15  09:09    &lt;DIR&gt;          imagestop<br />
2013-05-15  09:09    &lt;DIR&gt;          imagestop1<br />
2013-05-15  15:09    &lt;DIR&gt;          includes<br />
2013-02-19  09:38             8,810 index.asp<br />
2005-01-03  18:52                48 index.html<br />
2003-09-14  12:42             5,840 index1.asp<br />
2013-05-15  09:09    &lt;DIR&gt;          index2_images<br />
2013-05-15  09:09    &lt;DIR&gt;          index_images<br />
2005-05-21  13:14             1,317 index_维护.asp<br />
2007-12-28  11:36             1,488 index公告.asp<br />
2006-10-24  15:02             1,247 info.asp<br />
2006-08-29  17:05             3,949 info1.asp<br />
2013-05-15  09:09    &lt;DIR&gt;          inform<br />
2013-05-16  06:39             3,053 infox.asp<br />
2006-11-14  14:05             1,457 info_pay_tg.htm<br />
2006-09-20  15:28             6,350 info_pay_tg1.htm<br />
2006-10-24  16:28             1,908 info_pay_tg2.htm<br />
2005-05-26  04:42             8,106 iuident.cab<br />
2006-06-28  12:14           284,160 jiupian.doc<br />
2005-01-03  18:07             2,044 loadingbar.asp<br />
2012-05-24  14:15             4,398 login.asp<br />
2003-09-14  12:43             1,317 login1.asp<br />
2004-11-16  15:44               196 logoff.asp<br />
2011-12-21  13:35            22,534 main.asp<br />
2003-04-17  09:35               116 main.css<br />
2003-05-16  00:00           106,796 main.jpg<br />
2005-04-30  14:29             4,141 main0501.asp<br />
2005-09-05  13:32             6,422 main050915.asp<br />
2006-08-09  16:57            11,658 main1.asp<br />
2006-08-18  15:46            11,903 main11.asp<br />
2013-05-16  06:39            15,965 main20041224.htm<br />
2005-09-29  17:37             7,075 main20051008.asp<br />
2007-07-19  09:50            50,819 main_1.asp<br />
2005-09-05  11:01             6,026 main_供应商培训.asp<br />
2005-08-19  13:53             5,916 main_系统升级.asp<br />
2005-05-21  10:17             5,400 main_维护.asp<br />
2013-05-15  09:09    &lt;DIR&gt;          News<br />
2013-05-15  09:09    &lt;DIR&gt;          News1<br />
2007-12-17  09:59            24,576 PayType.doc<br />
2006-03-14  14:01            26,112 PayType1.doc<br />
2006-08-19  17:04         2,870,533 pic.rar<br />
2005-03-01  11:23             1,664 Pinshen.htm<br />
2006-08-31  15:50           295,424 print.exe<br />
2006-07-27  17:17            81,408 productdeclaration.xls<br />
2006-06-30  16:53            51,200 productdeclaration1.xls<br />
2006-07-12  20:12            81,920 productdeclaration2.xls<br />
2006-07-17  12:06            81,408 productdeclaration3.xls<br />
2006-07-18  09:32            75,776 productdeclaration4.xls<br />
2013-05-15  09:09    &lt;DIR&gt;          Protype<br />
2005-01-26  10:41            21,091 PX2.asp<br />
2004-12-13  10:50             1,271 QuitAwoke.asp<br />
2010-02-02  15:40         2,059,776 REACH.doc<br />
2013-05-16  06:44               980 redirectpage.asp<br />
2013-05-15  09:09    &lt;DIR&gt;          Rohs<br />
2006-03-27  10:58            15,872 ROHS.xls<br />
2006-07-10  12:03           239,104 ROHS1.xls<br />
2009-10-14  09:18         1,011,712 ROHS2.doc<br />
2006-06-21  17:20            39,424 RoHSCARREPORT.xls<br />
2006-11-14  13:25            40,960 RoHSdeclare.doc<br />
2006-08-29  17:24           498,688 ROHS宣告表上传操作步骤说明.doc<br />
2006-08-29  19:06           344,983 ROHS宣告表上传操作步骤说明.rar<br />
2006-08-04  15:56           232,448 RoHS宣告表管理流程.doc<br />
2006-06-29  18:51            39,424 RoHS改善计划书.doc<br />
2006-06-21  17:04            28,672 Rohs有害物质清单及限制.doc<br />
2006-08-28  13:41            19,968 rosedeclaration.doc<br />
2005-01-28  12:57            24,576 s2.doc<br />
2005-07-07  15:42             7,807 selectViewFunction.js<br />
2006-06-08  17:09             1,297 sendsms.asp<br />
2013-08-04  14:38                27 sl.asp;.txt<br />
2013-05-15  09:06    &lt;DIR&gt;          SocietyFeedBack<br />
2010-04-21  09:22             1,023 style.css<br />
2004-12-06  12:16            24,576 supply.doc<br />
2013-05-15  09:06    &lt;DIR&gt;          SupplyAppeal<br />
2013-05-15  09:06    &lt;DIR&gt;          SupplyAssessManage<br />
2004-06-05  13:48           137,665 SupplyAssessManageSupplyAppraise.xls<br />
2013-05-15  09:06    &lt;DIR&gt;          SupplyAudit<br />
2006-11-14  13:25           172,032 Supplydeclare.doc<br />
2013-05-15  09:05    &lt;DIR&gt;          SupplyPort<br />
2007-11-07  15:16         4,528,636 supplySys.pdf<br />
2010-12-31  09:13         1,256,448 Supply_9S.doc<br />
2013-05-15  09:05    &lt;DIR&gt;          TestWork<br />
2006-03-27  10:51            25,600 tongzhi.doc<br />
2008-02-25  14:27             1,870 tongzhi.html<br />
2007-12-24  11:33            57,856 tongzhi1.doc<br />
2007-12-27  11:10            54,784 tongzhi2.doc<br />
2003-06-23  10:42        34,411,520 UM-Guide.doc<br />
2013-05-15  09:05    &lt;DIR&gt;          uploadfiles<br />
2003-11-18  10:34            24,576 urlsend.dll<br />
2006-06-13  13:23            24,576 urlsend1.dll<br />
2013-05-15  09:05    &lt;DIR&gt;          UserMgr<br />
2013-05-15  09:05    &lt;DIR&gt;          WasterDayWork<br />
2013-05-15  09:04    &lt;DIR&gt;          WJ_Market<br />
2013-05-15  09:04    &lt;DIR&gt;          WJ_MarketNew<br />
2013-05-15  09:04    &lt;DIR&gt;          WJ_ZNDZ<br />
2013-08-05  14:55                 8 wooyun.txt<br />
2006-08-14  09:51                 0 WUTRACK.BIN<br />
2006-08-18  15:46            15,872 xinpindeclare.xls<br />
2013-05-15  09:04    &lt;DIR&gt;          XLS<br />
2003-07-18  10:45               111 XLSCareerFeedBack.xls<br />
2003-07-17  16:55               173 XLSCareerWaster.xls<br />
2004-05-11  13:03            18,739 XLSFeedBack.xls<br />
2004-06-07  11:11           910,553 XLSJiuPian.xls<br />
2003-10-30  08:58               724 XLSSQM.xls<br />
2004-06-11  20:24           298,326 XLSSupply.xls<br />
2004-04-15  16:12            10,968 XLSUnusualInfo.xls<br />
2004-06-17  09:01            24,066 XLSWaster.xls<br />
2007-03-14  14:33           880,640 xunjian.doc<br />
2006-06-01  14:26            25,088 xxttz.doc<br />
2006-04-17  12:54            24,064 zhakou.doc<br />
2013-05-15  09:04    &lt;DIR&gt;          _vti_pvt<br />
2005-09-19  09:26            18,944 供应商评价办法0902.xls<br />
2006-07-10  14:58            19,456 好消息.doc<br />
2006-08-28  13:27            19,456 好消息2.doc<br />
2006-08-28  13:37            19,968 审核通告2.doc<br />
2006-09-01  09:34           240,128 宣告表打印操作说明.doc<br />
2006-11-17  15:59         1,038,336 家用空调入立体库明细及与检验员对应表.xls<br />
2011-12-20  16:43           924,501 市场反馈9S模块操作手册-供应商.pdf<br />
2006-08-31  18:56           256,858 打印必备安装程序.rar<br />
2006-06-08  17:17                 0 新建 文本文档 (2).txt<br />
2006-03-03  15:23               257 新建 文本文档.txt<br />
2006-06-10  13:14            26,112 检测公司打假通告.doc<br />
2006-11-17  15:59           347,648 洗衣机立体库采购组及检验员分配（新）.xls<br />
2006-08-28  13:32            19,968 海尔供应商RoHS审核通告2.doc<br />
2006-08-28  13:35            19,968 海尔供应商审核通告2.doc<br />
2006-11-17  15:59           269,312 海梅入立体库统计（按采购组）及检验员分配.xls<br />
2006-02-09  15:13            16,384 用户密码更改申请单.xls<br />
             127 个文件     61,626,680 字节<br />
              39 个目录 111,696,314,368 可用字节</code></pre><p class='detail'><br />
<br />
<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/051506582dcf7ab0f9fd4ded592ce40d835cbc54.jpg" target="_blank"><img src="../images/051506582dcf7ab0f9fd4ded592ce40d835cbc54.jpg" alt="1.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/0515071956b452239cd27bd20906aa6d9e2579ed.jpg" target="_blank"><img src="../images/0515071956b452239cd27bd20906aa6d9e2579ed.jpg" alt="2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/05150735d3a14dae60a503c8bbe1210ce9635b17.jpg" target="_blank"><img src="../images/05150735d3a14dae60a503c8bbe1210ce9635b17.jpg" alt="3.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/05150749b6042e1793a5fb683a178375af16a854.jpg" target="_blank"><img src="../images/05150749b6042e1793a5fb683a178375af16a854.jpg" alt="4.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/0515081564c90d3f71c54c2e8e9e868321a3eca3.jpg" target="_blank"><img src="../images/0515081564c90d3f71c54c2e8e9e868321a3eca3.jpg" alt="5.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/0515083386b98158724d3994277d94ace770fa6e.jpg" target="_blank"><img src="../images/0515083386b98158724d3994277d94ace770fa6e.jpg" alt="6.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/051510534123c53db819fe693eba8351cc8df1c3.jpg" target="_blank"><img src="../images/051510534123c53db819fe693eba8351cc8df1c3.jpg" alt="7.jpg" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/05151211fd13662f88d96a8e6ebd8712daa65492.jpg" target="_blank"><img src="../images/05151211fd13662f88d96a8e6ebd8712daa65492.jpg" alt="8.jpg" width="600"/></a></p><p class="detail"><br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">可以禁用WebDAV<br />
<br />
修改平台登录密码 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/YY-2012" title="YY-2012">YY-2012</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-033527" title="海尔检测信息平台webdav漏洞和目录遍历">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：15 </p>
													<p class="detail">确认时间：2013-08-06 08:54</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">感谢 @YY-2012 的工作，已根据白帽子披露整改如下：<br />
对服务器虚拟目录权限、IIS webdav组件进行分析和程序排查，2013-08-06凌晨对服务器IIS webdav组件和服务器虚拟目录权限进行修改服务器配置参数，浏览服务器虚拟目录权限取消，IIS webdav组件已禁用。<br />
请白帽子们继续友好监督海尔信息安全工作，非常感谢。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

																	<p class="detail">2013-08-14：业务单位的最新答复为：经过这段时间的整顿，已经完成了方案中的整改并对防sql注入进行了完善，接下来我们将进一步跟踪平台的系统安全性。
也请各位白帽子持续友好监督海尔信息安全工作，非常感谢。</p>
											

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="33527";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
