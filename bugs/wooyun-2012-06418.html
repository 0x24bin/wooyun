<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		非vip也能用世纪佳缘的一个vip功能  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		非vip也能用世纪佳缘的一个vip功能  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/taylortai">taylortai</a> 
</li><li>提交时间：		2012-04-26 19:06</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2012-04-26：	细节已通知厂商并且等待厂商处理中<br/>
									2012-05-01：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail"></p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">在北京很无聊啊，这个周末扁桃体发炎，找工作有一个征婚网站，自己还是单身啊，就到世纪家园的网站研究下，看看最近哪些妹子看过我，看过我的妹子有好看的啊，但是不能点击啊，然后就开始研究如何进入妹的主页，去看妹子的信息。<br />
<br />
</p><p class="detail"><a href="../images/26184938b27cab9f878df3621e383ab6eaa69118.png" target="_blank"><img src="../images/26184938b27cab9f878df3621e383ab6eaa69118.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/261850023acc35c3d14b5cb65ff1bcc7a72ab18b.png" target="_blank"><img src="../images/261850023acc35c3d14b5cb65ff1bcc7a72ab18b.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
我们先看妹子照片的连接<br />
<br />
</p><p class="detail"><a href="../images/26185011d27abaa27c415c47c712f3640ae75bce.png" target="_blank"><img src="../images/26185011d27abaa27c415c47c712f3640ae75bce.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
    &lt;a onmousedown=”if(typeof(send_jy_pv2)==’function’){send_jy_pv2(‘Usercpn_skgwdj’);}” target=”_blank” href=”http://www.jiayuan.com/vipcenter/?src_key=myjy_lookedme&amp;amp;from=vipcenter-1″&gt;&lt;img width=”74px” height=”90px” src=”http://photos7.jiayuan.com/a8/ed/a72f543c8127e155728a0330609f/avatar_p.jpg”&gt;&lt;/a&gt;<br />
<br />
<br />
<br />
http://photos7.jiayuan.com/a8/ed/a72f543c8127e155728a0330609f/avatar_p.jpg<br />
<br />
<br />
<br />
我们要的就是这个，你从 &lt;a&gt;&lt;/a&gt;里面是看不到任何妹子的信息的。<br />
<br />
<br />
<br />
通过图片可以得知，家园的网站的用户的图片是放在不同的服务器的上的，通过二级域名来负载均衡了<br />
<br />
<br />
<br />
一般来说图片跟用户的信息都是有关联的，注意看后边的连接，查一下个数<br />
<br />
<br />
<br />
a72f543c8127e155728a0330609f 这个是28位，你第一个想到什么，md5，对了，有30位的的md5加密数据，但是我估计不会用，反解这个东西太累，而且只有28位该补什么好呢？注意看到a72f543c8127e155728a0330609f前面还有a8/ed这两个字母，凑起来是32位，这才是标准的md5么。<br />
<br />
<br />
<br />
但是顺序组合起来，放到md5反解网站上，明显不对，好，我自己也注册了一个世纪佳缘，把我自己的id md5 了一下，乐了，原来世纪家园的程序员懒了，将id md5后，用以下的格式来放照片了<br />
<br />
<br />
<br />
    前两位/后两位/中间的字母/avatar_p.jpg<br />
<br />
<br />
<br />
找到规律了，我们就用http://profile.jiayuan.com/反解出来的Id来进入妹子空间。<br />
<br />
<br />
<br />
等等，怎么是一个爷们？拿到找的规律不对？不对，到首页随便点了两个妹子的主页，拿到数据跟头像对比，用excel算了一下，原来如此。<br />
<br />
ori 	MD5 	<br />
<br />
45894109 	44894109 	1000000<br />
<br />
69850195 	68850195 	1000000<br />
<br />
69647082 	68647082 	1000000<br />
<br />
<br />
<br />
原始的uid 在MD5前都被减了100W<br />
<br />
<br />
<br />
是这样啊，taylortai猜想，世纪佳缘应该是之前的图片命名有问题，或者排序是从100W开始的，所以要减去100W，这个数据<br />
<br />
<br />
<br />
好了，我们给反解出来的uid加上1000000 ，然后通过 http://profile.jiayuan.com/反解出来的UId即可 进入妹子的主页了。<br />
<br />
<br />
<br />
顺手写了个 脚本页面<br />
<br />
<br />
<br />
http://pztai.com/jiayuan/index.php?key=taylortai  你可以点击这个来实验成果~<br />
<br />
</p><p class="detail"><a href="../images/26185041ede13f1504ad927efa768a1bae53b485.png" target="_blank"><img src="../images/26185041ede13f1504ad927efa768a1bae53b485.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/26185051a53c5c7829fc81348c56035af99148ee.png" target="_blank"><img src="../images/26185051a53c5c7829fc81348c56035af99148ee.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/261851005cc904de8c1fba1b538d61213f512f3f.png" target="_blank"><img src="../images/261851005cc904de8c1fba1b538d61213f512f3f.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/2618510836f9a25617d6a976ff557d12b8255e8e.png" target="_blank"><img src="../images/2618510836f9a25617d6a976ff557d12b8255e8e.png" alt="" width="600"/></a></p><p class="detail"> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">http://pztai.com/jiayuan/index.php?key=taylortai  你可以点击这个来实验成果~ </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">健壮图片路径算法 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/taylortai" title="taylortai">taylortai</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-06418" title="非vip也能用世纪佳缘的一个vip功能">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：无影响厂商忽略</p>
													<p class="detail">忽略时间：2012-04-26 19:06</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail"></p>
											

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="6418";
var bugRating="-3";
var myRating="";
var ratingCount="2";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
