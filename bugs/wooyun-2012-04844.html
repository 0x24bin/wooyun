<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		手机QQ浏览器严重漏洞-（HTTP明文协议）  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		手机QQ浏览器严重漏洞-（HTTP明文协议）  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/小威">小威</a> 
</li><li>提交时间：		2012-02-26 23:08</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2012-02-26：	细节已通知厂商并且等待厂商处理中<br/>
									2012-02-27：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">虚拟软AP捕获数据抓包协议提取QQ邮箱（QQ）密码账户  具体你懂的！</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">1：利用802.11A类型无线网卡架设虚拟软AP  （注：win7家庭版以上版本）<br />
<br />
（1）首先准备802.11a类型的无线网卡  （这里准备的是.11A类型的，它的搜索及覆盖面积是很广泛的，所以我选择它）<br />
<br />
（2）驱动.就绪  <br />
<br />
（3）运行以下命令启用虚拟无线网卡<br />
<br />
         复制到txt文档中把后缀名改为BAT 批处理文件<br />
<br />
 <br />
<br />
 　    netsh wlan set hostednetwork mode=allow<br />
<br />
 <br />
<br />
       netsh wlan set hostednetwork ssid=Enjoyor-xiao<br />
<br />
 <br />
<br />
       netsh wlan set hostednetwork key=enjoyor110 keyusage=persistent<br />
<br />
<br />
<br />
<br />
<br />
ssid= “无线网络名称”<br />
<br />
 Keyusage=“无线网络密码”<br />
<br />
<br />
<br />
（4）开启无线网络，允许以下CMD 命令<br />
<br />
netsh wlan start hostednetwork<br />
<br />
<br />
<br />
《提示：既然是钓鱼。这里架设的虚拟AP 我们选择简单的密码或者无密码，或者干脆把网络名称改为“mima12345” 选择wep模式（64bits），然后密码就设置为“12345” 等待别人蹭你的网》<br />
<br />
<br />
<br />
2：钓鱼准备<br />
<br />
（1） 修改SSID 网络名称 <br />
<br />
</p><p class="detail"><a href="../images/26230221fb729f610f4c86b5a2a5dae0e1faa29e.png" target="_blank"><img src="../images/26230221fb729f610f4c86b5a2a5dae0e1faa29e.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/26230253d9607fbee459ac18727db45daa68f234.png" target="_blank"><img src="../images/26230253d9607fbee459ac18727db45daa68f234.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
（2）修改连接安全密匙<br />
<br />
</p><p class="detail"><a href="../images/26230322e88f9190b751f35b7518e45668a69202.png" target="_blank"><img src="../images/26230322e88f9190b751f35b7518e45668a69202.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
（3）手机端登录测试<br />
<br />
</p><p class="detail"><a href="../images/2623034613e45913c0d6f4219a82d6cdaa76c48a.png" target="_blank"><img src="../images/2623034613e45913c0d6f4219a82d6cdaa76c48a.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
在这里，一个虚拟软AP钓鱼就制作成功了，下面我们需要的是等待被蹭网，同时做好数据包的抓取及分析工作<br />
<br />
这里我们利用的是QQ浏览器<br />
<br />
（1） 选择捕包工具（这里选择Wireshark  国外的一款，汉化版）<br />
<br />
 <br />
<br />
选择你的无线网卡 <br />
<br />
</p><p class="detail"><a href="../images/262304300048094717cfa9fd30fcea0e6a060d72.png" target="_blank"><img src="../images/262304300048094717cfa9fd30fcea0e6a060d72.png" alt="" width="600"/></a></p><p class="detail"><br />
<br />
第二步AP被接入后点击开始捕获数据包<br />
<br />
第三部等待个N久，收到N多个数据包后 开始分析协议<br />
<br />
这里提供一些比较常见的，都是本人亲测的哦，亲...包邮 ！<br />
<br />
<br />
<br />
选择过滤到（HTTP）<br />
<br />
<br />
<br />
3g_lastLoginQq=      &quot;wap手机QQ的QQ登录帐号&quot;<br />
<br />
mqzone_lastLoginQq=   &quot;wap手机QQ登录密码&quot;<br />
<br />
sid=8mBXNulHFPu/IAa22v0PfQ==  &quot;关键KEY&quot; <br />
<br />
“&amp;clientkey=”到“=9&amp;u1=http://imgcache.qq.com” 前面则为权限代码<br />
<br />
<br />
<br />
clientuin=  &quot;QQwap手机页面 微博帐号&quot;<br />
<br />
<br />
<br />
@uin=     “邮箱帐号”<br />
<br />
@pwd=    “邮箱密码”  </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">这个需要证明吗？ </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">你懂的@！ </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/小威" title="小威">小威</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-04844" title="手机QQ浏览器严重漏洞-（HTTP明文协议）">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：无影响厂商忽略</p>
													<p class="detail">忽略时间：2012-02-27 10:23</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">经评估，我们认为你的描述并非“手机QQ浏览器严重漏洞”，这是HTTP协议的问题。钓鱼WiFi是个安全风险，业务需要通过其他手段来规避此问题</p>
											

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="4844";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
