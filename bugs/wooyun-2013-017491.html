<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		空中网分站可直接获取webshell  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		空中网分站可直接获取webshell  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/BlAck.Eagle">BlAck.Eagle</a> 
</li><li>提交时间：		2013-01-18 14:59</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-01-18：	积极联系厂商并且等待厂商认领中，细节不对外公开<br/>
									2013-03-04：	厂商已经主动忽略漏洞，细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">由于网站列目录，并且存在FCK，可以直接获取webshell,并可渗透同段主机</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail"> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">shell地址：<br />
<br />
</p><p class="detail"><a href="../images/18143909367bc3ec0c5a466b8e855b7e98190743.jpg" target="_blank"><img src="../images/18143909367bc3ec0c5a466b8e855b7e98190743.jpg" alt="1.JPG" width="600"/></a></p><p class="detail"><br />
<br />
<br />
<br />
config.php:<br />
<br />
</p><pre><code>&lt;?php<br />
// database type<br />
$db_type   = &quot;mysql&quot;;<br />
<br />
// database host<br />
$db_host   = &quot;localhost&quot;;<br />
<br />
// database name<br />
$db_name   = &quot;kongzhong_shequ&quot;;<br />
<br />
// database username<br />
$db_user   = &quot;root&quot;;<br />
<br />
// database password<br />
$db_pass   = &#039;pwd@mysql@root&#039;;<br />
<br />
$timezone    = &quot;Asia/Chongqing&quot;;<br />
<br />
$cookie_path    = &quot;/&quot;;<br />
<br />
$cookie_domain    = &quot;&quot;;<br />
<br />
$session = &quot;1440&quot;;<br />
<br />
$upload_pic_dir=&quot;upload/temppic&quot;;<br />
<br />
$html_dir	= &quot;html&quot;;<br />
<br />
$data_dir	= &quot;data&quot;;<br />
<br />
$if_html	= 1;<br />
<br />
$shtml_cache_time =&quot;2&quot;;<br />
<br />
$config[&#039;BASE_URL&#039;]=&quot;http://shequ.kongzhong.com&quot;;<br />
$config[&#039;now_time&#039;]		=time();<br />
$config[&#039;cookie_path&#039;]	=&quot;/&quot;;<br />
$config[&#039;cookie_domain&#039;]=&quot;&quot;;<br />
$config[&#039;atturl&#039;]=&#039;/ATTACHMENT/fck/&#039;;<br />
$config[&#039;attdir&#039;]=$_SERVER[&#039;DOCUMENT_ROOT&#039;].$config[&#039;atturl&#039;];<br />
$config[&#039;cacheurl&#039;]=&#039;/data/cache/&#039;;<br />
$config[&#039;cachedir&#039;]=$_SERVER[&#039;DOCUMENT_ROOT&#039;].$config[&#039;cacheurl&#039;];<br />
// table prefix<br />
$prefix    = &quot;w3c_&quot;;<br />
<br />
$table_admin	=$prefix.&quot;admin&quot;;<br />
$table_ads	=$prefix.&quot;ads&quot;;<br />
$table_ads_position	=$prefix.&quot;ads_position&quot;;<br />
$table_activity	=$prefix.&quot;activity&quot;;<br />
$table_activity_mm	=$prefix.&quot;activity_mm&quot;;<br />
$table_mmm_pic	=$prefix.&quot;mmm_pic&quot;;<br />
<br />
$table_comment	=$prefix.&quot;comment&quot;;<br />
$table_config	=$prefix.&quot;config&quot;;<br />
$table_icate	=$prefix.&quot;icate&quot;;<br />
$table_goods	=$prefix.&quot;goods&quot;;<br />
$table_goods_pic	=$prefix.&quot;goods_pic&quot;;<br />
$table_city		=$prefix.&quot;city&quot;;<br />
$table_area		=$prefix.&quot;area&quot;;<br />
$table_website	=$prefix.&quot;website&quot;;<br />
$table_rating	=$prefix.&quot;rating&quot;;<br />
$table_article	=$prefix.&quot;article&quot;;<br />
$table_articles	=$prefix.&quot;articles&quot;;<br />
$table_article_poll	=$prefix.&quot;article_poll&quot;;<br />
$table_category	=$prefix.&quot;category&quot;;<br />
$table_weblinks	=$prefix.&quot;weblinks&quot;;<br />
$table_member	=$prefix.&quot;member&quot;;<br />
$table_netshop	=$prefix.&quot;netshop&quot;;<br />
$table_video	=$prefix.&quot;video&quot;;<br />
$table_dl	=$prefix.&quot;dl&quot;;<br />
$table_dl_attachment	=$prefix.&quot;dl_attachment&quot;;<br />
$table_brand	=$prefix.&quot;brand&quot;;<br />
$table_case	=$prefix.&quot;case&quot;;<br />
$table_knowledge	=$prefix.&quot;knowledge&quot;;<br />
$table_special	=$prefix.&quot;special&quot;;<br />
$table_designer	=$prefix.&quot;designer&quot;;<br />
$table_tower=$prefix.&quot;tower&quot;;<br />
$table_tower_home=$prefix.&quot;tower_home&quot;;<br />
$table_tower_pic=$prefix.&quot;tower_pic&quot;;<br />
$table_shop=$prefix.&quot;shop&quot;;<br />
$table_freeinfo=$prefix.&quot;freeinfo&quot;;<br />
<br />
$table_game=$prefix.&quot;game&quot;;<br />
$table_award=$prefix.&quot;award&quot;;<br />
$table_award_record=$prefix.&quot;award_record&quot;;<br />
$table_award_code=$prefix.&quot;award_code&quot;;<br />
$table_credit_record=$prefix.&quot;credit_record&quot;;<br />
<br />
$table_poll	=$prefix.&quot;poll&quot;;<br />
$table_poll_option	=$prefix.&quot;poll_option&quot;;<br />
$table_gift=$prefix.&quot;gift&quot;;<br />
$table_mmm_gift_record=$prefix.&quot;mmm_gift_record&quot;;<br />
$table_feed=$prefix.&quot;feed&quot;;<br />
$table_login_log=$prefix.&quot;login_log&quot;;<br />
$table_lottery_log=$prefix.&quot;lottery_log&quot;;<br />
$table_faces=$prefix.&quot;faces&quot;;<br />
<br />
<br />
<br />
//print_r($arr_gcolor);<br />
<br />
//奖项分类<br />
$arr_award_category=array(<br />
	1=&gt;array(&#039;id&#039;=&gt;&#039;1&#039;,&#039;name&#039;=&gt;&#039;实物奖品&#039;),<br />
	2=&gt;array(&#039;id&#039;=&gt;&#039;2&#039;,&#039;name&#039;=&gt;&#039;虚拟奖品&#039;)<br />
);<br />
//兑奖来源<br />
$arr_awardfrom=array(<br />
	1=&gt;array(&#039;id&#039;=&gt;&#039;1&#039;,&#039;name&#039;=&gt;&#039;奖品兑换&#039;),<br />
	2=&gt;array(&#039;id&#039;=&gt;&#039;2&#039;,&#039;name&#039;=&gt;&#039;积分抽奖&#039;)<br />
);<br />
//积分记录方式<br />
$arr_creditMethod=array(<br />
	11=&gt;array(&#039;id&#039;=&gt;&#039;11&#039;,&#039;name&#039;=&gt;&#039;登录奖励积分&#039;),<br />
	12=&gt;array(&#039;id&#039;=&gt;&#039;12&#039;,&#039;name&#039;=&gt;&#039;小游戏奖励积分&#039;),<br />
	13=&gt;array(&#039;id&#039;=&gt;&#039;13&#039;,&#039;name&#039;=&gt;&#039;留言奖励积分&#039;),<br />
	21=&gt;array(&#039;id&#039;=&gt;&#039;21&#039;,&#039;name&#039;=&gt;&#039;兑奖扣除积分&#039;),<br />
	22=&gt;array(&#039;id&#039;=&gt;&#039;22&#039;,&#039;name&#039;=&gt;&#039;抽奖扣除积分&#039;),<br />
);<br />
?&gt;</code></pre><p class='detail'> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">1、禁止列目录<br />
<br />
2、修复FCK </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/BlAck.Eagle" title="BlAck.Eagle">BlAck.Eagle</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-017491" title="空中网分站可直接获取webshell">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
									<h3 class="detailTitle">厂商回应：</h3>
										<p class="detail">未能联系到厂商或者厂商积极拒绝</p>
																	
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="17491";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
