<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		网中网会计实训系统全版本通杀命令执行及目录遍历  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		网中网会计实训系统全版本通杀命令执行及目录遍历  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/nauscript">nauscript</a> 
</li><li>提交时间：		2013-12-19 10:53</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2013-12-19：	细节已通知厂商并且等待厂商处理中<br/>
									2013-12-23：	厂商已经确认，细节仅向厂商公开<br/>
									2013-12-26：	细节向第三方安全合作伙伴开放<br/>
									2014-01-02：	细节向核心白帽子及相关领域专家公开<br/>
									2014-01-12：	细节向普通白帽子公开<br/>
									2014-02-01：	细节向实习白帽子公开<br/>
									2014-03-19：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">网中网会计实训系统全版本因某服务器平台配置不当导致命令执行并且存在目录遍历，部分版本还可越权登入后台、部分功能可越权操作<br />
官网试用系统也存在<br />
</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">典型客户包含了众多财经高校http://www.netinnet.cn/case.asp?sid=656 （不完全），波及用户较广，目前在用的v4.0到v6.0版本都存在以上安全隐患<br />
<br />
还是jboss惹的祸，登入没有权限验证，网中网的各版本各个财会系统均需要jboss的支持<br />
<br />
关于这方面的详解wooyun上已经有很多了，危害和利用不多说<br />
<br />
详细可参见drops女神瞌睡龙的http://drops.wooyun.org/papers/178<br />
<br />
和我亲爱滴基友园长mm在drops的一些文章和发的洞<br />
<br />
如何修复这样的问题，乌云众基友在历次的挖洞中已经很详细了，就不啰嗦了<br />
<br />
可参考http://www.wooyun.org/searchbug.php?q=jboss<br />
<br />
<br />
<br />
因为官方提供较为完善的售后，据说有网中网的技术人员去安装和维护，因此可能是维护人员的习惯，官方存在的这些问题就变成了通用，涉及到的学校几乎涵盖了大部分财经院校<br />
<br />
<br />
<br />
搜索有漏洞的系统其实挺简单，因为该系统的目录名称较为特殊<br />
<br />
只要Google或者百度：/netinnet_ 这样的文件夹就好，如果要特定搜集某一版本某一系统就netinnet_系统名缩写_版本号，例如使用较多而且版本较新的有：<br />
<br />
</p><pre><code>/netinnet_cnsw_v52/ （v5.2版的出纳实训平台）<br />
                     /netinnet_jckj_v52/ （v5.2版的会计基础平台）<br />
                     /netinnet_cbkj_v52/ （v5.2版的成本会计系统）<br />
                     /netinnet_swkj_v52/ （v5.2版的税务会计系统）<br />
                     /netinnet_zjkj_v52/ （v5.2版的中级会计系统单项版）<br />
                     /netinnet_zjkj2_v52/ （v5.2版的中级会计系统综合版）<br />
                    /netinnet_cwfx_v52/   （v5.2版的财务分析平台）<br />
                    /netinnet_cwgl_v52/   （v5.2版的财务管理平台）<br />
                   /netinnet_zhsx_V3/      （v3版的综合实习平台）<br />
                   /netinnet_sjdx_v52/     （v5.2版的审计系统）<br />
                   /netinnet_zhsx/       （v4版的综合实习平台）</code></pre><p class='detail'><br />
<br />
<br />
<br />
随手一搜就是一堆学校：（以下为验证过的，当然还有很多，不做验证）<br />
<br />
</p><pre><code>http://202.116.95.7/web-console/ 中山大学新华学院<br />
http://219.219.35.4:8080/web-console/中国矿业大学管理学院会计系 <br />
http://219.223.10.16:8080/web-console/ 深圳市福田区华强职业技术学校财会综合实习平台<br />
http://59.77.47.248:8080/web-console/  福建省漳州市某高校<br />
http://218.104.52.218:8080/web-console/无锡商业职业技术学院会计金融学院会计实习中心 <br />
http://113.204.166.67:8080/web-console/重庆城市管理职业学院会计与贸易系会计实习系统<br />
http://121.251.255.44:8080/web-console/ 中国石油大学青岛校区会计实训系统<br />
http://222.133.182.253:8080/web-console/ 日照职业技术学院财政学院会计实习中心<br />
http://58.244.94.49:8080/web-console/ 吉林工程技术师范学院会计综合实训<br />
http://202.100.91.165/web-console/ 兰州大学网络教育学院财会综合实习平台会计实习中心 <br />
http://121.10.160.138:8080/web-console/ 广东省高州农业学校会计实习中心 <br />
http://210.42.124.251:8080/web-console/武汉大学经济与管理学院基础会计实训教学平台V4.0 <br />
http://gxyxoa.com:8080/web-console/广西银行学校综合实习平台<br />
http://wzw.hznu.edu.cn:8080/web-console/杭州师范大学钱江学院经济管理分院<br />
http://cksx.gxibvc.net:8080/web-console/广西国际商务职业技术学院财会金融系<br />
http://121.10.160.138:8080/web-console/ 广东省高州农业学校会计实习中心 <br />
http://210.42.224.96:8080/web-console/<br />
http://218.29.67.248:8080/web-console/河南财政税务高等专科学校会计系成本会计实训教学平台V6.0<br />
http://211.66.88.4:8080/web-console/广东农工商职业技术学院会计实训教学平台V6.0<br />
http://218.64.220.6:8080/web-console/ 江西理工大学应用科学学院会计实训教学平台<br />
http://125.221.35.114:8080/web-console/武汉软件工程职业学院商学院会计实训教学平台V6.0<br />
http://119.6.103.5:8080/web-console/ 成都某高校<br />
http://219.217.240.65:8080/web-console/ 哈尔滨工业大学会计实训平台<br />
http://120.42.37.3:8080/web-console/ 福建厦门某高校</code></pre><p class='detail'><br />
<br />
<br />
<br />
网中网官网几个演示站也存在：<br />
<br />
http://demo.netinnet.cn/web-console/<br />
<br />
http://sk.netinnet.cn/web-console/ <br />
<br />
<br />
<br />
2#特定文件夹目录遍历：#<br />
<br />
</p><pre><code>/news/<br />
/manage/<br />
/test/<br />
/userfiles/<br />
/check/<br />
/data/<br />
/help/<br />
/images/<br />
/js/<br />
/css/</code></pre><p class='detail'><br />
<br />
等等目录，各版本均会遍历，官方的使用系统也存在这个问题，以v5.2的财务分析平台的help文件夹为例 <br />
<br />
http://demo.netinnet.cn/netinnet_cwfx_v52/help/<br />
<br />
其他目录也均可实现<br />
<br />
<br />
<br />
3、#部分二次开发和部署不到位的版本还可以直接登入后台#<br />
<br />
/netinnet_zhsx/admin.jsp<br />
<br />
还有部分可以插入通知、查看凭证数据（作业答案提前知道！），只是危害不大，而且能够实现的站点并不多<br />
<br />
</p><p class="detail"><a href="../images/19001016001d65b441ca43c4846ed80abda6ed80.jpg" target="_blank"><img src="../images/19001016001d65b441ca43c4846ed80abda6ed80.jpg" alt="1.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/190010307133cf9a9dbf645b9d73111196c702d9.jpg" target="_blank"><img src="../images/190010307133cf9a9dbf645b9d73111196c702d9.jpg" alt="2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/19001046eef4417e71a3af53bfaff6096355e1e6.jpg" target="_blank"><img src="../images/19001046eef4417e71a3af53bfaff6096355e1e6.jpg" alt=".jpg" width="600"/></a></p><p class="detail"> </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail">官方网站的：<br />
<br />
</p><p class="detail"><a href="../images/19001302f41b69dfac6c042ff23a02dd02ae9535.jpg" target="_blank"><img src="../images/19001302f41b69dfac6c042ff23a02dd02ae9535.jpg" alt="2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
上面提到的部分学校的：<br />
<br />
</p><p class="detail"><a href="../images/19001208a088bd408115a0a1c74e18effad97189.jpg" target="_blank"><img src="../images/19001208a088bd408115a0a1c74e18effad97189.jpg" alt="29.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/190012203c871772488998c6a931f051601182a1.jpg" target="_blank"><img src="../images/190012203c871772488998c6a931f051601182a1.jpg" alt="28.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/19001233e9e4891eb5678add4ae656298c19ac41.jpg" target="_blank"><img src="../images/19001233e9e4891eb5678add4ae656298c19ac41.jpg" alt="27.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/19001338cb272c72a12c3952201279e8b861bcbe.jpg" target="_blank"><img src="../images/19001338cb272c72a12c3952201279e8b861bcbe.jpg" alt="24.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/190013514edeb8f9ab6ba12daaae80ffe705a6e9.jpg" target="_blank"><img src="../images/190013514edeb8f9ab6ba12daaae80ffe705a6e9.jpg" alt="20.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/1900140216b69960eee77bc9d297b6776be0a59b.jpg" target="_blank"><img src="../images/1900140216b69960eee77bc9d297b6776be0a59b.jpg" alt="21.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/19001430f71cd2d1b18e5df6b296b3daca86ec80.jpg" target="_blank"><img src="../images/19001430f71cd2d1b18e5df6b296b3daca86ec80.jpg" alt="16.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/19001438c42bc7258c74ad53b7b4bf2ab5702ad1.jpg" target="_blank"><img src="../images/19001438c42bc7258c74ad53b7b4bf2ab5702ad1.jpg" alt="10.jpg" width="600"/></a></p><p class="detail"><br />
<br />
</p><p class="detail"><a href="../images/190014496dfd9d0b92457f68e58cd5b92e41a96a.jpg" target="_blank"><img src="../images/190014496dfd9d0b92457f68e58cd5b92e41a96a.jpg" alt="2.jpg" width="600"/></a></p><p class="detail"><br />
<br />
太多了，不一一上传了 </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">该系统其实完全可以不要外网登陆，当然内网也要做好防范<br />
<br />
南京信息工程大学经济管理实验教学中心http://172.16.80.221:8080/web-console/ <br />
<br />
南京审计学院会计学院爱博平台http://211.65.228.65/netinnet_zyks_v13/ <br />
<br />
（http://211.65.228.65/web-console/） <br />
<br />
这两所高校就只允许内网访问，正好有这两所学校的vpn，测试也均存在上述问题<br />
<br />
修复的方案上面也提到了 乌云上很多，看看吧<br />
<br />
估计这个问题涉及学校多还是会交给cncert来处理，今天汇文的通用洞下午xss就打到了CCERT来自上海交大的ip来验证的 给20rank吧 亲 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/nauscript" title="nauscript">nauscript</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-046400" title="网中网会计实训系统全版本通杀命令执行及目录遍历">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：20 </p>
													<p class="detail">确认时间：2013-12-23 21:33</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail"> </p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="46400";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
