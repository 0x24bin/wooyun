<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		中国工商银行账户可批量猜测导致信息泄露（无法转账）  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		中国工商银行账户可批量猜测导致信息泄露（无法转账）  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/小r00to1">小r00to1</a> 
</li><li>提交时间：		2014-03-09 15:54</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-03-09：	细节已通知厂商并且等待厂商处理中<br/>
									2014-03-14：	厂商已经确认，细节仅向厂商公开<br/>
									2014-03-24：	细节向核心白帽子及相关领域专家公开<br/>
									2014-04-03：	细节向普通白帽子公开<br/>
									2014-04-13：	细节向实习白帽子公开<br/>
									2014-04-23：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">中国工商银行账户批量猜测，导致信息泄露，工商银行登录方式可以自己设置用户名，如果让不法分子利用，则可能出现暴力破解登录，从而造成账户信息的泄露。</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">1.开通正常网银，登录，点击：客户服务-个性化定制-个性化定制：然后抓包验证第二种登录方式中的登录用户名的合法性：如图：</p><p class="detail"><a href="../images/082204516f0fdc899b0820debf3a7e9ba8a0b4a0.png" target="_blank"><img src="../images/082204516f0fdc899b0820debf3a7e9ba8a0b4a0.png" alt="0.png" width="600"/></a></p><p class="detail"><br />
<br />
这里有两种情况：<br />
<br />
一：用户名可以通过，这就证明这个名字还没有被使用，没有利用价值。<br />
<br />
二：用户名提示叉号，则证明这个名字已经被使用了，可以利用一下下，当然凭运气了。<br />
<br />
这里我使用了好多名字进行验证，像：史珍香（shizhenxiang），王伟（wangwei）等常用名字，然后将用户名作为密码登录：如图提示：</p><p class="detail"><a href="../images/08221023e0c56f2458dfe77e1e815b8a667b1a0d.png" target="_blank"><img src="../images/08221023e0c56f2458dfe77e1e815b8a667b1a0d.png" alt=".png" width="600"/></a></p><p class="detail">账号冻结，我可是仅仅尝试了一次，就是这个信息，证明有人登陆次数过多，才冻结的。之后利用少于6个字符的尝试猜解出现如图所示：</p><p class="detail"><a href="../images/08221205d151ca62180ae72311da20ef582ad442.png" target="_blank"><img src="../images/08221205d151ca62180ae72311da20ef582ad442.png" alt="4.png" width="600"/></a></p><p class="detail"><br />
<br />
大粪（dafen），这种短的名称给了贵宾用户，其实这是安全的，一会会说。<br />
<br />
2.开始抓包，跑字典，猜解已经使用过的用户名：<br />
<br />
一：先使用httpwatch：如图：</p><p class="detail"><a href="../images/08221449c48ca5e67eeba6f1f5c5af20a224b60d.png" target="_blank"><img src="../images/08221449c48ca5e67eeba6f1f5c5af20a224b60d.png" alt="0.png" width="600"/></a></p><p class="detail">使用：nidaye 抓包截图：</p><p class="detail"><a href="../images/08221539219573efda21cb930458763992365bf0.png" target="_blank"><img src="../images/08221539219573efda21cb930458763992365bf0.png" alt="6.png" width="600"/></a></p><p class="detail">注意返回信息。再用：wodayede抓包截图：</p><p class="detail"><a href="../images/082216588654fee0ee8c66ffda73862bd2a04c36.png" target="_blank"><img src="../images/082216588654fee0ee8c66ffda73862bd2a04c36.png" alt="7.png" width="600"/></a></p><p class="detail">再次注意返回信息。都明白。。。。<br />
<br />
3.利用burp抓包，批量测试:<br />
<br />
如图：</p><p class="detail"><a href="../images/08221831580b9d2e12da27294e698a8251245bf7.png" target="_blank"><img src="../images/08221831580b9d2e12da27294e698a8251245bf7.png" alt="23.png" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/08221936632696bfb51828564424362c672250a7.png" target="_blank"><img src="../images/08221936632696bfb51828564424362c672250a7.png" alt="54.png" width="600"/></a></p><p class="detail">发送到攻击模块</p><p class="detail"><a href="../images/08221852cf5d15ac41a92c87e18144698da68736.png" target="_blank"><img src="../images/08221852cf5d15ac41a92c87e18144698da68736.png" alt="24.png" width="600"/></a></p><p class="detail">把：shuoshenme作为变量，执行字典，这里测试举了几个极端例子，如图：</p><p class="detail"><a href="../images/082222543811e4d73808720b6571e8fb596b683f.png" target="_blank"><img src="../images/082222543811e4d73808720b6571e8fb596b683f.png" alt="234.png" width="600"/></a></p><p class="detail">看返回长度就清楚，像wangyi、wangwei，这样的名字应该已经被注册了，再看看burp的返回值：注意两张图的对比：</p><p class="detail"><a href="../images/08222340edf3c9edeb8acfdbcd779d56067c7f2c.png" target="_blank"><img src="../images/08222340edf3c9edeb8acfdbcd779d56067c7f2c.png" alt="123.png" width="600"/></a></p><p class="detail"></p><p class="detail"><a href="../images/08222351a340d02c10105128a46396a3c3fd41e6.png" target="_blank"><img src="../images/08222351a340d02c10105128a46396a3c3fd41e6.png" alt="565.png" width="600"/></a></p><p class="detail">返回值不同。<br />
<br />
4.只后利用猜解到的账号，将账号作为密码，到前台登录页面进行验证，这里要说明一点，先看图：</p><p class="detail"><a href="../images/08222607de7e32f45662c918f416bf6a2d59cc2d.png" target="_blank"><img src="../images/08222607de7e32f45662c918f416bf6a2d59cc2d.png" alt="2.png" width="600"/></a></p><p class="detail">这里是登陆密码的修改，“必须为数字和字母的组合，且要长于六位”，所以在跑字典猜解用户名的时候就要使用字母和数字作为用户名，因为你要使用用户名作为登录密码，而密码是有限制的。在说说上面那种少于六位的用户名，其实这种用户名是安全的，因为密码的长度导致了，这种短的用户名不可能作为密码登录。<br />
<br />
5.登录成功后，就可以查看你要的信息了，至于转账，似乎没有可能，因为需要U盾。<br />
<br />
<br />
<br />
<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">1.严格账户控制体系。<br />
<br />
2.登录密码不能和用户名相同。 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/小r00to1" title="小r00to1">小r00to1</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-053150" title="中国工商银行账户可批量猜测导致信息泄露（无法转账）">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：高</p>
						<p class="detail">漏洞Rank：11 </p>
													<p class="detail">确认时间：2014-03-14 21:29</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">CNVD确认所述情况，已经转由CNCERT直接转报给网站管理单位信息化主管部门，根据其反馈，已经在第一时间制定修复方案。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="53150";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
